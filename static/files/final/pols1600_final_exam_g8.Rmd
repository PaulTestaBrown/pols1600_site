---
title: "POLS 1600 Take Home Final"
author: "Group 8: Starrchild Jackson"
date: 'DUE 11:59 pm, May 12, 2023 on Canvas'
output:
  html_document:
    theme: journal
    toc: TRUE
    toc_float: TRUE
    toc_depth: 2
    number_sections: TRUE
---

# Overview {-}

This document provides your final exam for POLS 1600.

The exam consists of five parts corresponding to core concepts and skills from POLS 1600:

- Statistical Programming (10 points)
- Casual Inference (20 Points)
- Interpreting Linear Models (20 points)
- Quantifying Uncertainty through Statistical Inference (20 points)
- Conducting applied empirical analysis (30 points)

Each section contains a series of conceptual questions and/or coding tasks for your to accomplish.

You will write your answers to these questions and tasks in this Rmd file.

You will **submit the html file** produced by this .Rmd file on **[on Canvas by May 12, 11:59 pm.](https://canvas.brown.edu/courses/1091286/assignments/7925703/)**
  - I've pushed the date back since I'm sending you the final somewhat late on Sunday. You're welcome to turn it in sooner
  - You may request an extension through the weekend to turn the exam in on Monday May 15 by emailing me before May 12.

Exams submitted after their due date will automatically lose 10 points for each late day.

If you submit the `Rmd` file instead of the `html` file you will lose 5 points from your exam grade.

If you like, I will meet with you by Zoom for 30 minutes to answer general questions about material from the course. I will not answer specific questions from the exam.

This exam is designed to test **your knowledge and understanding** of concepts and skills from the course. You can and should make use of material from lectures and labs, but if I find evidence of plagiarism (copying and pasting answers verbatim from Google), I will initiate plagiarism procedures described in Brown's [Academic Code](https://college.brown.edu/sites/g/files/dprerj916/files/2022-04/Academic-Code.pdf)

# Statistical Programming

## Write the name of a function that accomplishes each task (5 points)

- Transform a dataframe by adding new columns: `answer`

- Pipe the output of one function into another function: `answer`

- Estimate a linear regression model `answer`

- Load an installed package into your working environment `answer`

- Subset a dataframe based on set of logical statements `answer`

*Note:* There are multiple correct answers for some questions (i.e. multiple functions to accomplish a given task)



## To produce a graphic in R using the package `ggplot2` you need at least three components, what are they? (5 points)

- Please write your answer in complete sentences and write some [pseudo code](https://en.wikipedia.org/wiki/Pseudocode) to illustrate your explanation

```{r, eval = F}
# Write pseudo code 

# Component 1

# Component 2

# Component 3


```



# Causal Inference (20 points)

## What is the fundamental problem of causal inference? (3 points)

-   Please frame your answer in terms of potential outcomes and counterfactual comparisons. 

## How does random assignment help solve this fundamental problem? (3 points)

-   Please discuss the concepts of statistical independence and average treatment effects.

## What's the difference between an observational and experimental design? (2 points)

-   Who or what determines the presence of some causal factor

-   What are the strengths and weaknesses of each design

## Explain the concept of collider bias. How can we avoid introducing collider bias into our analyses (2 points)

## What are three common designs for making credible causal claims with observational data? (10 points)

For each design, please:

-   Describe the basic logic of the design

-   Explain the key identifying assumptions of the design

-   Discuss some testable implications of these assumptions

# Linear Models (20 points)

## What is a linear regression and why is it useful? (5 points)

In your answer, please discuss:

-   The basic goals and intuitions that motivate linear regression

-   The mechanics of ordinary least squares regression

-   The relationship between linear regression and the Conditional Expectation Function

## What does it mean to control for a variable in a multiple regression? (5 points)

In your answer, please explain:

-   Why would  we want to control for covariates?

-   How linear regression accomplishes this

-   What covariates we want to control for

-   What covariates we shouldn't control for

## Interpreting regression models (10 points)

Suppose we are interested in understanding partisan differences in vaccination rates

Our outcome is a binary indicator which takes a value of 1 if someone was vaccinated, and 0 otherwise.

Our key predictor of interest is people's self-reported partisanship, measured with a 7-point scale where (1 = Strong Democrat, 2 = Democrat, 3 Independent who leans Democratic, 4 = Independent who leans Republican, 5 = Republican, and 7 = Strong Republican)

Please answer the following:

1.  Suppose we expect Democrats are more likely to be vaccinated.

-   Specify a bivariate model predicting vaccination status with partisanship, measured by a 7-point scale to test this expectation (ie fill in the ??? in the equation below):

$$\text{???} = \beta_0 + \beta_1 \times \text{???} + \epsilon$$

-    If your expectations are correct, what is the expected sign and significance of the coefficient on $\beta_1$

> Write your answer here


-   How should we interpret $\beta_0$ in this model?

> Write your answer here


2.  Suppose we find the expected relationship in our bivariate model. A skeptic sees your results and says:

    "You claim differences in vaccination rates are a function of partisanship, I think this is really just a matter of geography. Democrats are more likely to live in urban areas. Vaccines were more available in urban areas and the pandemic was more severe so people were more incentived to get the vaccine."

To address the skeptics concerns, you estimate a second model "controlling for geography" with a binary indicator of whether someone lives in a urban setting (`urban` = 1) or not (`urban` = 0)

-   Specify a multiple regression model predicting vaccination status with partisanship and an indicator of whether someone lives in a rural setting.

$$\text{???} = \beta_0 + \beta_1 \times \text{???} + \beta_2 \times \text{???} + \epsilon$$

-   Assuming there is some truth behind the skeptic claims, what is the expected sign and significance of the coefficient on urban status in this model?

> Write your answer here


-   If the skeptic is right, and differences in vaccination rates are entirely a function of geography, what should happen to the sign and significance of the coefficient on partisanship in this model compared to the bivariate model?

> Write your answer here


-   If the skeptic is only partly right, and only part of the relationship between partisanship and vaccination is actually a function of geographic differences, what should happen to the sign and significance of the coefficient on partisanship in this model compared to the bivariate model?

> Write your answer here


-   If the skeptic is completely wrong, and geography has no relationship to vaccination rates, what should we expect in terms of the size and significance of the coefficient on rural status? How will the coefficient on partisanship in this model change?

> Write your answer here


# Statistical Inference (20 points)

## What is a confidence interval? (10 points)

Please provide a one-two paragraph explanation of what a confidence interval is, how we construct confidence intervals, and how confidence intervals can be used to conduct statistical inference.

In your answer, please be sure to discuss and explain the following concepts:

-   Populations and samples
-   Sampling distributions
-   Standard errors
-   Significance thresholds and critical values
-   For a 95% confidence interval, what are we 95% percent confident about?

## What is a hypothesis test? (10 points)

Please provide a one-two paragraph explanation of what a hypothesis test is, how we conduct hypothesis tests, and how hypothesis tests can be used to conduct statistical inference.

In your answer, please be sure to explain the following:

-   What is a null hypothesis?
-   What is a test stastitic?
-   What is a distribution of a test statistic under the null?
-   What is a p-value?
-   What's the difference between a Type I and Type II error?

# Applied Empirical Analysis (30 points)

Finally lets demonstrate some of the empirical skills you've learned in POLS 1600.

Run the code below to load a small subset of data from the 2020 National Elections Time Series.

```{r data}

# Load any needed libraries here
library(tidyverse)


# Load data
load(url("https://pols1600.paultesta.org/files/data/g8/df_g8.rda"))

```

The code loads a small dataframe from the American National Election Studies 2020 Time Series Study.

The data contain the following variables:

- **`state`** the state where the respondent was interviewed
- **`state_registered`** the state the respondent was registered to vote in
- **`region`** the Census region of the respondent
- **`V201507x`** PRE: SUMMARY: Respondent age
- **`V201511x`** PRE: SUMMARY: Respondent 5 Category level of education
- **`V202468x`** PRE-POST: SUMMARY: Total (family) income
- **`V201600`** PRE: What is your (R) sex? [revised]
- **`V201601`** PRE: SEXUAL ORIENTATION OF R [REVISED]
- **`V201534x`** PRE: SUMMARY: R OCCUPATION STATUS 1 DIGIT
- **`V201549x`** PRE: SUMMARY: R self-identified race/ethnicity
- **`V201558x`** PRE: SUMMARY: HISPANIC SUMMARY
- **`V201231x`** PRE: SUMMARY: Party ID
- **`V201200`** PRE: 7pt scale liberal-conservative self-placement
- **`V202068x`** POST: SUMMARY: POST VOTE STATUS FOR REGISTERED RESPONDENTS
- **`V202073`** POST: FOR WHOM DID R VOTE FOR PRESIDENT
- **`V201233`** PRE: HOW OFTEN TRUST GOVERNMENT IN WASHINGTON TO DO WHAT IS RIGHT

Please download the [codebook](https://electionstudies.org/anes_timeseries_2020_userguidecodebook_20220210/) for further information on how these variables are coded.

The primary outcome for your analyses comes from the following variable: 

- **`V201411x`** Should transgender people - that is, people who identify themselves as the sex or gender different from the one they were born as - have to use the bathrooms of the gender they were born as, or should they be allowed to use the bathrooms of their identified gender?^[There were limited questions on the NES to choose from for this topic]

**Your task in this section is to explore variation in support for transgender rights** using the data available to you. 

Additionally, your dataset contains the following variables:

- **`V202172`** POST: FEELING THERMOMETER: TRANSGENDER PEOPLE
- **`V202473`** POST: R HAS FAMILY/NEIGHBORS/COWORKERS/FRIENDS WHO ARE TRANSGENDER

Which may or may not be relevant for your analysis.

What specific factors you focus on are up to you. You might focus on partisan or generational differences in support/opposition. You might focus specifically on contact with individuals who are transgender and then try to adjust for factors that would predict both contact and support/opposition. It's up to you!

To accomplish you will need to:

- Develop a set of questions and expectations to explore in the data (5 points)

- Look at and recode the data (5 points)

- Produce a table of descriptive statistics (5 points)

- Estimate at least two models testing your expectations (5 points)

- Present and interpret the substantive and statistical significance of these models using a regression table and at least one plot of predicted values (10 points)

## Formalize your question and expectations (5 points)

What do you think explains variation in support or opposition to transgender rights?

> Write your answer here


Don't worry about coming up with the perfect explanation (you have limited data). But try to develop a question and set of expectations (and alternatives) that you think would be substantively interesting to explore.


## Look at and recode the data (5 points)

First write some code to give yourself a high level overview the data.

```{r hlo}
# High Level Overview of the Data
```

- **Code Advice** 
  - I would use some combination `glimpse()`, `table()` and `summary()` to accomplish this
  - Knit your document often and clean up your code accordingly


Now recode the data to use in your analysis. At a minimum you will need to create new variables from the raw variables listed above for:

  - Your key outcome of interest (aka your dependent variable)
  - Your key predictor (the thing you think explains variation in your outcome)
  - Additional covariates that:
    - might influence both your outcome and key predictor (Omitted variable bias/Alternative explanations)
    - might moderate the effect of your key predictor on the outcome (Heterogenous/conditional effects)

A few more suggestions:

  - **Look out for negative values** These should probably be recoded as `NA`
  - Transform categorical variables into binary indicators 
    - E.g. convert things like race or gender into new variables that take a value of 1 when a respondent possesses that identity, and 0 otherwise
  - If you want, you may feel free to bring in additional data/information, but you need not to.
    - For example, you could look back at earlier labs to see how we coded whether someone lived in a "Red" state or a "Blue" State.
  

```{r recode}
# Recode data
```


## Produce a table of descriptive statistics (5 points)

Please calculate the following descriptive statistics for the variables you will use in your analyses

- Minimum
- 25th percentile
- Median
- Mean 
- 75th percentile
- Maximum
- Number of Missing Observations

Ideally, present this information like we did in class as a table of descriptive statistics. Use this information to describe the distributions of your data. This [template](https://pols1600.paultesta.org/files/assignments/pols1600_paper_template) has lots of code that might be useful for you. 



```{r descriptives}
# Calculate Summary Statistics

```


```{r sumtab, results="asis"}
# Table of Descriptive Statistics
```



## Estimtate at least two models (5 points)

Please estimate at least two models:

1. A simple bivariate model testing your main expectation

2. A multiple regression model including:
  - Controls for relevant covariates and/or
  - Interactions to test for conditional effects

You're free to estimate more, but try to keep your analysis and interpretations focused on one main question.


```{r models}
# Estimate models
```




## Present and interperet your results (10 points)

Finally, present and interpret the substantive and statistical signficance of your results.

Please include:

- A regression table containing the coefficients, standard errors, p-values for each model

- A plot of the predicted values from one of your models

- A interpretation of the substantive and statistical significance of your models with clear references to your table and figure.

```{r regtab, results = "asis"}
# Use htmlreg to present your models as a regression table
```


```{r predictions, results = "asis"}
# Create a prediction dataframe and produce predicted values 
# for you interaction model
```

```{r prediction_plot, results = "asis"}
# Plot the predicted values (ideally with confidence intervals)
# using ggplot

```

> Write your interpretation of your results here.

