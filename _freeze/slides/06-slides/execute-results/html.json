{
  "hash": "534dced62a9fd7681c003f000ebb1145",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 06:\"\nsubtitle: \"Linear Regression with Multiple Predictors\"\nauthor: \"Paul Testa\"\nformat: \n  revealjs:\n    theme: [default, brownslides.scss]\n    logo: images/pols1600_hex.png\n    footer: \"POLS 1600\"\n    multiplex: false\n    transition: fade\n    slide-number: c\n    incremental: true\n    center: false\n    menu: true\n    scrollable: true\n    highlight-style: github\n    progress: true\n    code-overflow: wrap\n    # include-after-body: title-slide.html\n    title-slide-attributes:\n      align: left\n      data-background-image: images/pols1600_hex.png\n      data-background-position: 90% 50%\n      data-background-size: 40%\nexecute: \n  echo: true\nfilters:\n  - openlinksinnewpage\n---\n\n\n# Overview\n\n\n\n\n\n\n\n\n\n\n\n## General Plan\n\n-   Group Assignment 2: Data\n-   Setup\n    -   Packages\n    -   Data\n-   Feedback\n-   Review\n    -   Causal Inference in Observational Designs\n    -   Simple Linear Regression\n-   Multiple Regression\n    -   Overview\n    -   Estimating and Interpreting Multiple Regression\n    -   Reading Regression Tables\n\nclass: inverse, center, middle \\# Research Questions\n\n## Assignment 1 Research Questions:\n\n-   Feedback posted to Canvas.\n\n-   General Comments:\n\n    -   Really great questions!\n\n    -   Feedback tries to balance interest/feasibility/data availability\n\n    -   \"Not an experiment\" $\\to$ What would you have to randomize to answer your question\n\n    -   Not every question need to be causal\n\n    -   \"Make your theories elaborate\" - R.A. Fisher to [William Cochran](https://www.jstor.org/stable/2344179)\n\n        -   But keep your models simple - Testa to POLS 1600\n\n## Assignment 2: Data Explorations\n\n-   Prompt posted [here](https://pols1600.paultesta.org/files/assignments/A1_research_questions.docx)\n\n-   Upload to [Canvas](https://canvas.brown.edu/courses/1087979/assignments/7870539) next Sunday March 19\n\n1.  A revised description of your group's research project\n2.  A description of a linear model implied by your question\n3.  R code that loads some potentially relevant data to your question and at least one descriptive summary of that data.\n4.  Some information about your group such as:\n    -   A group name[^1]\n    -   A group color or color scheme\n    -   A group motto, mascot, crest, etc.\n    -   Your group's theme song\n    -   Your group's astrological sign\n    -   Anything else that you think well help you form strong ingroup bounds that facilitate collaboration\n\n[^1]: If you're Group 01 don't change your name to Group 4\n\nclass:inverse, middle, center \\# üí™ \\## Get set up to work\n\n## Packages\n\nHopefully, you were all able to install the following packages\n\n-   `dataverse` (necessary for this week)\n-   `tidycensus` (necessary for this week)\n-   `easystats` (useful later)\n-   `DeclareDesign` (useful later)\n\n## Census API:\n\nAdditionally, I hope you have all followed the steps [here](https://pols1600.paultesta.org/slides/04-packages.html#3_Install_a_Census_API_tidycensus_package):\n\n1.  Install the `tidycensus` package\n2.  Load the installed package\n3.  Request an API key from the Census\n4.  Check your email\n5.  Activate your key\n6.  Install your API key in R\n7.  Check that everything worked\n\nTo install the an API key so we can download data directly from the US Census\n\n## Packages for today\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nthe_packages <- c(\n  ## R Markdown\n  \"kableExtra\",\"DT\",\"texreg\",\n  ## Tidyverse\n  \"tidyverse\", \"lubridate\", \"forcats\", \"haven\", \"labelled\",\n  ## Extensions for ggplot\n  \"ggmap\",\"ggrepel\", \"ggridges\", \"ggthemes\", \"ggpubr\", \n  \"GGally\", \"scales\", \"dagitty\", \"ggdag\", \"ggforce\",\n  # Graphics:\n  \"scatterplot3d\", #<<\n  # Data \n  \"COVID19\",\"maps\",\"mapdata\",\"qss\",\"tidycensus\", \"dataverse\", \n  # Analysis\n  \"DeclareDesign\", \"easystats\", \"zoo\"\n)\n```\n:::\n\n\n## Define a function to load (and if needed install) packages\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nipak <- function(pkg){\n    new.pkg <- pkg[!(pkg %in% installed.packages()[, \"Package\"])]\n    if (length(new.pkg)) \n        install.packages(new.pkg, dependencies = TRUE)\n    sapply(pkg, require, character.only = TRUE)\n}\n```\n:::\n\n\n## Load packages for today\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nipak(the_packages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   kableExtra            DT        texreg     tidyverse     lubridate \n         TRUE          TRUE          TRUE          TRUE          TRUE \n      forcats         haven      labelled         ggmap       ggrepel \n         TRUE          TRUE          TRUE          TRUE          TRUE \n     ggridges      ggthemes        ggpubr        GGally        scales \n         TRUE          TRUE          TRUE          TRUE          TRUE \n      dagitty         ggdag       ggforce scatterplot3d       COVID19 \n         TRUE          TRUE          TRUE          TRUE          TRUE \n         maps       mapdata           qss    tidycensus     dataverse \n         TRUE          TRUE          TRUE          TRUE          TRUE \nDeclareDesign     easystats           zoo \n         TRUE          TRUE          TRUE \n```\n\n\n:::\n:::\n\n\nclass:inverse, center, middle \\# üí™ \\## Load Data for Thursday's Lab\n\n## Load the Covid-19 Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# covid <- COVID19::covid19(\n#   country = \"US\",\n#   level = 2,\n#   verbose = F\n# )\n\nload(url(\"https://pols1600.paultesta.org/files/data/covid.rda\"))\n```\n:::\n\n\n## Filter Covid-19 Data to US States (Now Excluding D.C. as well)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Vector containing of US territories\nterritories <- c(\n  \"American Samoa\",\n  \"Guam\",\n  \"Northern Mariana Islands\",\n  \"Puerto Rico\",\n  \"Virgin Islands\",\n  \"District of Columbia\"\n  )\n\n# Filter out Territories and create state variable\ncovid_us <- covid %>%\n  filter(!administrative_area_level_2 %in% territories)%>%\n  mutate(\n    state = administrative_area_level_2\n  )\n```\n:::\n\n\n## Mutate: Calculate New Deaths Per Capita and Percent Vaccinated\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncovid_us %>%\n  dplyr::group_by(state) %>%\n  mutate(\n    new_deaths = deaths - lag(deaths),\n    new_deaths_pc = new_deaths / population *100000,\n    new_deaths_pc_14da = zoo::rollmean(new_deaths_pc, k = 14, align = \"right\", fill=NA ),\n    percent_vaccinated = people_fully_vaccinated/population*100  \n    ) -> covid_us\n```\n:::\n\n\n## Load Data on Presidential Elections\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Try this code first\nSys.setenv(\"DATAVERSE_SERVER\" = \"dataverse.harvard.edu\")\n\npres_df <- get_dataframe_by_name(\n  \"1976-2020-president.tab\",\n  \"doi:10.7910/DVN/42MVDX\"\n)\n\n# If the code above fails, comment out and uncomment the code below:\n\n# load(url(\"https://pols1600.paultesta.org/files/data/pres_df.rda\"))\n```\n:::\n\n\n## HLO of Presidential Elections Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(pres_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 15\n   year state   state_po state_fips state_cen state_ic office       candidate   \n  <dbl> <chr>   <chr>         <dbl>     <dbl>    <dbl> <chr>        <chr>       \n1  1976 ALABAMA AL                1        63       41 US PRESIDENT \"CARTER, JI‚Ä¶\n2  1976 ALABAMA AL                1        63       41 US PRESIDENT \"FORD, GERA‚Ä¶\n3  1976 ALABAMA AL                1        63       41 US PRESIDENT \"MADDOX, LE‚Ä¶\n4  1976 ALABAMA AL                1        63       41 US PRESIDENT \"BUBAR, BEN‚Ä¶\n5  1976 ALABAMA AL                1        63       41 US PRESIDENT \"HALL, GUS\" \n6  1976 ALABAMA AL                1        63       41 US PRESIDENT \"MACBRIDE, ‚Ä¶\n# ‚Ñπ 7 more variables: party_detailed <chr>, writein <lgl>,\n#   candidatevotes <dbl>, totalvotes <dbl>, version <dbl>, notes <lgl>,\n#   party_simplified <chr>\n```\n\n\n:::\n:::\n\n\n## Transform Data to get just 2020 Election\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npres_df %>%\n  mutate(\n    year_election = year,\n    state = str_to_title(state),\n    # Fix DC\n    state = ifelse(state == \"District Of Columbia\", \"District of Columbia\", state)\n  ) %>%\n  filter(party_simplified %in% c(\"DEMOCRAT\",\"REPUBLICAN\"))%>%\n  filter(year == 2020) %>%\n  select(state, state_po, year_election, party_simplified, candidatevotes, totalvotes\n         ) %>%\n  pivot_wider(names_from = party_simplified,\n              values_from = candidatevotes) %>%\n  mutate(\n    dem_voteshare = DEMOCRAT/totalvotes *100,\n    rep_voteshare = REPUBLICAN/totalvotes*100,\n    winner = forcats::fct_rev(factor(ifelse(rep_voteshare > dem_voteshare,\"Trump\",\"Biden\")))\n  ) -> pres2020_df\n```\n:::\n\n\n## Transform Data to get just 2020 Election\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(pres2020_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 9\n  state      state_po year_election totalvotes DEMOCRAT REPUBLICAN dem_voteshare\n  <chr>      <chr>            <dbl>      <dbl>    <dbl>      <dbl>         <dbl>\n1 Alabama    AL                2020    2323282   849624    1441170          36.6\n2 Alaska     AK                2020     359530   153778     189951          42.8\n3 Arizona    AZ                2020    3387326  1672143    1661686          49.4\n4 Arkansas   AR                2020    1219069   423932     760647          34.8\n5 California CA                2020   17500881 11110250    6006429          63.5\n6 Colorado   CO                2020    3279980  1804352    1364607          55.0\n# ‚Ñπ 2 more variables: rep_voteshare <dbl>, winner <fct>\n```\n\n\n:::\n:::\n\n\n## Load Data on Median State Income from the Census\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nacs_df <- get_acs(geography = \"state\", \n              variables = c(med_income = \"B19013_001\",\n                            med_age = \"B01002_001\"), \n              year = 2019)\n\n# Uncomment if get_acs() doesn't work:\n# load(url(\"https://pols1600.paultesta.org/files/data/acs_df.rda\"))\n```\n:::\n\n\n## HLO: Census Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(acs_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 5\n  GEOID NAME    variable   estimate    moe\n  <chr> <chr>   <chr>         <dbl>  <dbl>\n1 01    Alabama med_age        39      0.2\n2 01    Alabama med_income  50536    304  \n3 02    Alaska  med_age        34.3    0.1\n4 02    Alaska  med_income  77640   1015  \n5 04    Arizona med_age        37.7    0.2\n6 04    Arizona med_income  58945    266  \n```\n\n\n:::\n:::\n\n\n## Tidy Census Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nacs_df %>%\n  mutate(\n    state = NAME,\n  ) %>%\n  select(state, variable, estimate) %>%\n  pivot_wider(names_from = variable,\n              values_from = estimate) -> acs_df\n```\n:::\n\n\n## Tidy Census Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(acs_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 3\n  state      med_age med_income\n  <chr>        <dbl>      <dbl>\n1 Alabama       39        50536\n2 Alaska        34.3      77640\n3 Arizona       37.7      58945\n4 Arkansas      38.1      47597\n5 California    36.5      75235\n6 Colorado      36.7      72331\n```\n\n\n:::\n:::\n\n\n## Merge election data into Covid data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Always check dimensions before and after merging\ndim(covid_us)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 52646    52\n```\n\n\n:::\n\n```{.r .cell-code}\ndim(pres2020_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 51  9\n```\n\n\n:::\n\n```{.r .cell-code}\n# Merge covid_us with pres2020_df and save as tmp file\ntmp <- covid_us %>% left_join(\n  pres2020_df,\n  by = c(\"state\" = \"state\")\n)\ndim(tmp) # Same number of rows as covid_us w/ 8 additional columns\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 52646    60\n```\n\n\n:::\n:::\n\n\n## Merge Census data into Covid data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndim(tmp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 52646    60\n```\n\n\n:::\n\n```{.r .cell-code}\ndim(acs_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 52  3\n```\n\n\n:::\n\n```{.r .cell-code}\n# Merge tmp with acs_df and save as final covid_df file\ncovid_df <- tmp %>% left_join(\n  acs_df,\n  by = c(\"state\" = \"state\")\n)\ndim(covid_df)  # Same number of rows as tmp w/ 2 additional columns\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 52646    62\n```\n\n\n:::\n:::\n\n\n## Subset Merged data to include only the variables and observations we want\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nthe_vars <- c(\n  # Covid variables\n  \"state\",\"state_po\",\"date\",\"new_deaths_pc_14da\", \"percent_vaccinated\",\n  # Election variables\n  \"winner\",\"rep_voteshare\",\n  # Demographic variables\n  \"med_age\",\"med_income\",\"population\")\n\n\ncovid_lab <- covid_df %>%\n  filter( date == \"2021-09-23\")%>%\n  select(all_of(the_vars))%>%\n  ungroup()\n\nlength(the_vars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 10\n```\n\n\n:::\n\n```{.r .cell-code}\ndim(covid_lab)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 50 10\n```\n\n\n:::\n:::\n\n\n## A Preview of Where We're Headed:\n\nConsider the following **multiple regression** (which we will on Thursday):\n\n$$\\text{New Covid Deaths} = \\beta_0 +\\beta_1 \\text{Rep. Vote Share} +\\beta_2 \\text{Median Age} +\\beta_3 \\text{Median Income} + \\epsilon$$ - The tell us how the outcome, *New Covid Deaths*, is expected to change with a **unit change** in a given predictor, controlling for/holding constant the other predictors in the model (more on \"controlling for\" shortly). - In the model above, $\\beta_2$ tells us how *New Covid Deaths* is predicted to change, if the *Median Age* of a state increased by one year (i.e. a unit change). - Similarly, $\\beta_3$ tells us how *New Covid Deaths* is predicted to change, if the *Median Income* of a state increased by one dollar (i.e. a unit change).\\\n- Since vote share, median income and age are measured on very different scales, interpreting these coefficients in the same model can be cumbersome.\n\n## Standardizing variables.\n\n-   When variables are measured in different units multiple regression coefficients can be hard to interpret\n\n    -   Coefficients, $\\beta$, tell us about the predicted change in $y$ for a unit change in $x$ or $z$\n    -   For example $\\beta_{age}$\n\n-   *z-scores* standardize variables so that their unit of measurement no longer matters (QSS p. 103).\n\n-   To calculate the *z-score* of a variable $x$, we simply, substract off the mean and divide by the standard deviaton\n\n$$z\\text{-score of x} = \\frac{x_i - \\mu_{x}}{\\sigma_x}$$\n\n-   The *z-score* of Age is\n\n$$z\\text{-score of Age} = \\frac{\\text{Age}_i - \\mu_{Age}}{\\sigma_{Age}}$$\n\n## Standardizing Predictors in R\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncovid_lab %>%\n  mutate(\n    rep_voteshare_std = (rep_voteshare - mean(rep_voteshare))/sd(rep_voteshare),\n    med_age_std = ( med_age - mean( med_age))/sd( med_age),\n    med_income_std = (med_income - mean(med_income))/sd(med_income),\n    percent_vaccinated_std = (percent_vaccinated - mean(percent_vaccinated))/sd(percent_vaccinated)\n  ) -> covid_lab\n```\n:::\n\n\n## Multiple Regression with Standardized Predictors\n\nIf we were to estimate a model with standardized predictors:\n\n$$\\text{New Covid Deaths} = \\beta_0 +\\beta_1 \\text{Rep. Vote Share}_{std} +\\beta_2 \\text{Median Age}_{std} +\\beta_3 \\text{Median Income}_{std} + \\epsilon$$ The coefficients still tell us predicted change in New Covid Deaths for a unit change in a predictor, but now a unit change corresponds to a 1-standard deviation increase of each predictor:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncovid_lab %>%\n  summarise(\n    sd_rep_vote = sd(rep_voteshare),\n    sd_med_age = sd(med_age),\n    sd_med_income = sd(med_income),\n    sd_rep_vote_std = sd(rep_voteshare_std),\n    sd_med_age_std = sd(med_age_std),\n    sd_med_income_std = sd(med_income_std)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 √ó 6\n  sd_rep_vote sd_med_age sd_med_income sd_rep_vote_std sd_med_age_std\n        <dbl>      <dbl>         <dbl>           <dbl>          <dbl>\n1        10.4       2.36        10288.               1              1\n# ‚Ñπ 1 more variable: sd_med_income_std <dbl>\n```\n\n\n:::\n:::\n\n\n## Saving Data\n\nFinally, I'll save the data for Thursday's lab\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Don't run this code\nsave(covid_lab, file = \"../files/data/06_lab.rda\")\n```\n:::\n\n\nAnd on Thursday, we'll be able to load the `covid_lab` just by running:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nload(url(\"https://pols1600.paultesta.org/files/data/06_lab.rda\"))\n```\n:::\n\n\nclass:inverse, middle, center \\# üîç \\## Review\n\n## Review\n\n-   Casual Inference in Observational Designs\n    -   Difference-in-Differences\n    -   Regression Discontinuity Design\n    -   Instrumental Variables\n-   Simple Linear Regression\n\n## Review\n\n-   Casual Inference in Observational Designs\n    -   **Difference-in-Differences**\n    -   Regression Discontinuity Design\n    -   Instrumental Variables\n-   Simple Linear Regression\n\nclass:inverse, middle, center \\# üîç \\## Casual Inference in Observational Designs\n\n## Review: Casual Inference in Observational Designs\n\n-   Observational designs that try to estimate causal effects need to justify assumptions about conditional independence:\n\n$$\nY_i(1),Y_i(0), Y_i, U_i \\perp D_i |X_i\n$$\n\n--\n\n-   This assumption goes by many, jargony names: Selection on Observables, Conditional Independence, No unmeasured confounders.\n\n--\n\n-   Credibility of this assumption depends less on having a lot of data, and more on how your data were generated.\n\n--\n\n-   $Y_i(1),Y_i(0) \\perp D_i \\mid X_i$ doesn't mean that D has no effect on $Y$\n\n-   Instead it means, that what we can estimate $E[Y_i|D_i=1,X_i]$ and treat this as a good (unbiased) estimate of $E[Y_i(1)]$ and similarly $E[Y_i|D_i=0,X_i]$ is a good estimate of $E[Y_i(0)]$\n\n## Observational Designs for Causal Inference\n\n-   Three common research designs:\n\n    -   Difference in Difference Design\n\n    -   Regression Discontinuity Designs\n\n    -   Instrumental Variable Designs\n\nclass: inverse, center, middle \\# üí° Difference in Differences\n\nclass: inverse, center, middle background-image:url(https://www.finebooksmagazine.com/sites/default/files/styles/gallery_item/public/media-images/2020-11/map-lead-4.jpg?h=2ded5a3f&itok=Mn-K5rQc) background-size: cover \\## London in the Time of Cholera\n\n## Motivating Example: What causes Cholera?\n\n-   In the 1800s, cholera was thought to be transmitted through the air.\n\n-   John Snow (the physician, not the snack), to explore the origins eventunally concluding that cholera was transmitted through living organisms in water.\n\n-   Leveraged a **natural experiment** in which one water company in London moved its pipes further upstream (reducing contamination for Lambeth), while other companies kept their pumps serving Southwark and Vauxhall in the same location.\n\n## Notation\n\nLet's adopt a little notation to help us think about the logic of Snow's design:\n\n-   $D$: treatment indicator, 1 for treated neighborhoods (Lambeth), 0 for control neighborhoods (Southwark and Vauxhall)\n\n-   $T$: period indicator, 1 if post treatment (1854), 0 if pre-treatment (1849).\n\n-   $Y_{di}(t)$ the potential outcome of unit $i$\n\n    -   $Y_{1i}(t)$ the potential outcome of unit $i$ when treated between the two periods\n\n    -   $Y_{0i}(t)$ the potential outcome of unit $i$ when control between the two periods\n\n## Causal Effects\n\nThe individual causal effect for unit i at time t is:\n\n$$\\tau_{it} = Y_{1i}(t) ‚àí Y_{0i}(t)$$\n\nWhat we observe is\n\n$$Y_i(t) = Y_{0i}(t)\\cdot(1 ‚àí D_i(t)) + Y_{1i}(t)\\cdot D_i(t)$$\n\n$D$ only equals 1, when $T$ equals 1, so we never observe $Y_0i(1)$ for the treated units.\n\nIn words, we don't know what Lambeth's outcome would have been in the second period, had they not been treated.\n\n## Average Treatment on Treated\n\nOur goal is to estimate the average effect of treatment on treated (ATT):\n\n$$\\tau_{ATT} = E[Y_{1i}(1) -  Y_{0i}(1)|D=1]$$\n\nThat is, what would have happened in Lambeth, had their water company not moved their pipes\n\n## Average Treatment on Treated\n\nOur goal is to estimate the average effect of treatment on treated (ATT):\n\nWe we can observe is:\n\n|               \\| Post-Period (T=1) \\| Pre-Period (T=0) \\|\n\n\\|\\|--\\|-\\| \\| Treated $D_{i}=1$ \\| $E[Y_{1i}(1)\\vert D_i = 1]$ \\| $E[Y_{0i}(0)\\vert D_i = 1]$ \\| \\| Control $D_i=0$ \\| $E[Y_{0i}(1)\\vert D_i = 0]$ \\| $E[Y_{0i}(0)\\vert D_i = 0]$ \\|\n\n## Data\n\nBecause potential outcomes notation is abstract, let's consider a modified description of the Snow's cholera death data from [Scott Cunningham](https://mixtape.scunning.com/difference-in-differences.html):\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|Company                     | 1854 (T=1)| 1849 (T=0)|\n|:---------------------------|----------:|----------:|\n|Lambeth (D=1)               |         19|         85|\n|Southwark and Vauxhall (D=0 |        147|        135|\n\n\n:::\n:::\n\n\n## How can we estimate the effect of moving pumps upstream?\n\nRecall, our goal is to estimate the effect of the the treatment on the treated:\n\n$$\\tau_{ATT} = E[Y_{1i}(1) -  Y_{0i}(1)|D=1]$$\n\nLet's conisder some strategies Snow could take to estimate this quantity:\n\n## Before vs after comparisons:\n\n-   Snow could have compared Labmeth in 1854 $(E[Y_i(1)|D_i = 1] = 19)$ to Lambeth in 1849 $(E[Y_i(0)|D_i = 1]=85)$, and claimed that moving the pumps upstream led to 66 fewer cholera deaths.\n\n-   This comparison assumes Lambeth's pre-treatment outcomes in 1849 are a good proxy for what its outcomes would have been in 1954 if the pumps hadn't moved $(E[Y_{0i}(1)|D_i = 1])$.\n\n-   A skeptic might argue that Lambeth in 1849 $\\neq$ Lambeth in 1854\n\n## Treatment-Control comparisons in the Post Period.\n\n-   Snow could have compared outcomes between Lambeth and S&V in 1954 ($E[Yi(1)|Di = 1] ‚àí E[Yi(1)|Di = 0]$), concluding that the change in pump locations led to 128 fewer deaths.\n\n-   Here the assumption is that the outcomes in S&V and in 1854 provide a good proxy for what would have happened in Lambeth in 1954 had the pumps not been moved $(E[Y_{0i}(1)|D_i = 1])$\n\n-   Again, our skeptic could argue Lambeth $\\neq$ S&V\n\n## Difference in Differences\n\nTo address these concerns, Snow employed what we now call a difference-in-differences design,\n\nThere are two, equivalent ways to view this design.\n\n$$\\underbrace{\\{E[Y_{i}(1)|D_{i} = 1] ‚àí E[Y_{i}(1)|D_{i} = 0]\\}}_{\\text{1. Treat-Control |Post }}‚àí \\overbrace{\\{E[Y_{i}(0)|D_{i} = 1] ‚àí E[Y_{i}(0)|D_{i}=0 ]\\}}^{\\text{Treated-Control|Pre}}$$\n\n-   Difference 1: Average change between Treated and Control in Post Period\n-   Difference 2: Average change between Treated and Control in Pre Period\n\nWhich is equivalent to:\n\n$$\\underbrace{\\{E[Y_{i}(1)|D_{i} = 1] ‚àí E[Y_{i}(0)|D_{i} = 1]\\}}_{\\text{Post - Pre |Treated }}‚àí \\overbrace{\\{E[Y_{i}(1)|D_{i} = 0] ‚àí E[Y_{i}(0)|D_{i}=0 ]\\}}^{\\text{Post-Pre|Control}}$$\n\n-   Difference 1: Average change between Treated over time\n-   Difference 2: Average change between Control over time\n\n## Difference in Differences\n\nYou'll see the DiD design represented both ways, but they produce the same result:\n\n$$\n\\tau_{ATT} = (19-147) - (85-135) = -78\n$$\n\n$$\n\\tau_{ATT} = (19-85) - (147-135) = -78\n$$\n\n## Identifying Assumption of a Difference in Differences Design\n\nThe key assumption in this design is what's known as the parallel trends assumption: $E[Y_{0i}(1) ‚àí Y_{0i}(0)|D_i = 1] = E[Y_{0i}(1) ‚àí Y_{0i}(0)|D_i = 0]$\n\n-   In words: If Lambeth hadn't moved its pumps, it would have followed a similar path as S&V\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slides_files/figure-revealjs/paralleltrends-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\nWhere:\n\n1.  $E[Y_{i}(1)|D_{i} = 1] ‚àí E[Y_{i}(1)|D_{i} = 0]$\n2.  $E[Y_{i}(0)|D_{i} = 1] ‚àí E[Y_{i}(0)|D_{i}\\} = 0]$\n3.  $E[Y_{1i}(1) ‚àí Y_{0i}(1)|D_{i} = 1]$\n\n## Summary\n\n-   A Difference in Differences (DiD, or diff-in-diff) design combines a pre-post comparison, with a treated-control comparison\n\n    -   Taking the pre-post difference removes any fixed differences between the units\n\n    -   Then taking the difference between treated and control differences removes any common differences over time\n\n-   The key identifying assumption of a DiD design is the \"assumption of parallel trends\"\n\n    -   Absent treatment, treated and control groups would see the same changes over time.\n    -   Hard to prove, possible to test\n\n## Extensions and limitations\n\n-   DiD easy to estimate with linear regression\n-   Generalizes to multiple periods and treatment interventions\n    -   More pre-treatment periods allow you assess \"parallel trends\" assumption\n-   Alternative methods\n    -   Synthetic control\n    -   Event Study Designs\n-   What if you have multiple treatments or treatments that come and go?\n    -   Panel Matching\n    -   Generalized Synthetic control\n\n## Applications\n\n-   [Card and Krueger (1994)](https://www.nber.org/papers/w4509) What effect did raising the minimum wage in NJ have on employment\n\n-   [Abadie, Diamond, & Hainmueller (2014)](https://onlinelibrary.wiley.com/doi/full/10.1111/ajps.12116?casa_token=_ceCu4SwzTEAAAAA%3AP9aeaZpT_Zh1VdWKXx_tEmzaJTtMJ1n0eG7EaYlvJZYN000re33cfMAI2O8N8htFJjOsln2GyVeQql4) What effect did German Unification have on economic development in West Germany\n\n-   [Malesky, Nguyen and Tran (2014)](https://www.cambridge.org/core/journals/american-political-science-review/article/impact-of-recentralization-on-public-services-a-differenceindifferences-analysis-of-the-abolition-of-elected-councils-in-vietnam/3477854BAAFE152DC93C594169D64F58) How does decentralization influence public services?\n\nclass:inverse, middle, center \\# üîç \\# Simple Linear Regression \\### Linear regression provides a linear estimate of the CEF\n\n## Review: Simple Linear Regression\n\n-   **Conceptual**\n    -   Simple linear regression estimates a line of best fit that summarizes relationships between two variables\n\n$$\ny_i = \\beta_0 + \\beta_1x_i + \\epsilon_i\n$$\n\n-   **Practical**\n    -   We estimate linear models in R using the `lm()` function\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlm(y ~ x, data = df)\n```\n:::\n\n\n-   *Technical/Definitional*\n    -   Linear regression chooses $\\beta_0$ and $\\beta_1$ to minimize the Sum of Squared Residuals (SSR):\n\n$$\\textrm{Find }\\hat{\\beta_0},\\,\\hat{\\beta_1} \\text{ arg min}_{\\beta_0, \\beta_1} \\sum (y_i-(\\beta_0+\\beta_1x_i))^2$$\n\n-   *Theoretical*\n    -   Linear regression provides a **linear** estimate of the conditional expectation function (CEF): $E[Y|X]$\n\n## Linear Regression and the CEF\n\nRecall the first model we fit in last week's lab\n\n$$\\text{new_deaths} = \\beta_0 + \\beta_1 \\text{winner} + \\epsilon$$\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm1 <- lm(new_deaths ~ winner, covid_df)\nm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = new_deaths ~ winner, data = covid_df)\n\nCoefficients:\n(Intercept)  winnerBiden  \n     19.349        3.519  \n```\n\n\n:::\n:::\n\n\n`m1` is the equation for a very simple line defined by two points:\n\n-   $\\beta_0$ = E\\[new_deaths\\|winner = Trump\\]\n-   $\\beta_0 + \\beta_1$ = E\\[new_deaths\\|winner = Biden\\]\n\n## Linear Regression and the CEF\n\nIt's helpful to take a look at what's going on under the hood in `lm()`\n\nWe gave it the following data:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(m1$model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   new_deaths winner\n67          0  Biden\n68          0  Biden\n69          0  Biden\n70          0  Biden\n71          0  Biden\n72          0  Biden\n```\n\n\n:::\n:::\n\n\n## Linear Regression and the CEF\n\n-   R doesn't know how to calculate the mean of `Biden` (or any character or factor data).\n-   Instead it creates an indicator variable `winnerBiden` which equals 1 when `winner` equals `Biden` and 0 otherwise.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(model.matrix(m1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   (Intercept) winnerBiden\n67           1           1\n68           1           1\n69           1           1\n70           1           1\n71           1           1\n72           1           1\n```\n\n\n:::\n:::\n\n\n## Linear Regression and the CEF\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntable(m1$model$winner)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nTrump Biden \n25738 25988 \n```\n\n\n:::\n\n```{.r .cell-code}\ntable(model.matrix(m1)[,2])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n    0     1 \n25738 25988 \n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncovid_df%>%\n  mutate(\n    winner01 = ifelse(winner==\"Biden\",1,0)\n  )%>%\n  ggplot(aes(winner01, new_deaths))+\n  geom_point()+\n  stat_summary(geom=\"point\",fun=mean,col= \"red\",size=2)+\n  geom_segment(aes(x=0,xend =1, \n                   y=coef(m1)[1],\n                   yend = coef(m1)[1]+coef(m1)[2]*1\n                   ),\n               col= \"red\")\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slides_files/figure-revealjs/unnamed-chunk-34-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Linear Regression and the CEF\n\n-   When the CEF function is linear, `lm()` provides you coefficients that give you conditional means like in `m1`\n    -   The CEF is linear for *saturated models* in like `m1` where the coefficients define every possible category of comparison.\n-   For continuous variables, like `m3` from the lab below, `lm()` provides a linear approximation to the CEF\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm3 <- lm(new_deaths_pc_14da ~ percent_vaccinated, covid_df,\n         subset = date == \"2021-09-23\")\nm3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = new_deaths_pc_14da ~ percent_vaccinated, data = covid_df, \n    subset = date == \"2021-09-23\")\n\nCoefficients:\n       (Intercept)  percent_vaccinated  \n           2.41522            -0.03292  \n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncovid_df %>%\n  filter(date == \"2021-09-23\") %>%\n  ggplot(aes(percent_vaccinated, new_deaths_pc_14da))+\n  geom_point(size=.5,alpha=.5)+\n  stat_summary_bin(fun = \"mean\", \n                   geom = \"point\", \n                   col=\"red\",\n                   bins =10\n                   )+\n  geom_smooth(method =\"lm\")\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slides_files/figure-revealjs/unnamed-chunk-37-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\nclass: inverse, middle, center \\# üí° \\## Multiple Regression\n\n## Overiew: Multiple Regression\n\n-   **Conceptual**\n    -   Multiple linear regression generalizes simple regression to models with multiple predictors\n\n$$y_i = \\beta_0 + \\beta_1x_{1,i} +\\beta_2x_{2,i} + \\epsilon_i$$\n\n$$y_i = X\\beta + \\epsilon_i$$\n\n-   **Practical**\n    -   We estimate linear models in R using the `lm()` function using the `+` to add predictors\n    -   We use the `*` to include the main effects $(\\beta_1 x, \\beta_2z)$ and interactions $(\\beta_3 (x\\cdot z))$of two predictors\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlm(y ~ x + z, data = df)\nlm(y ~ x*z, data = df) # Is a shortcut for:\nlm(y ~ x + z + x:z, data = df)\n```\n:::\n\n\n## Overiew: Multiple Regression\n\n-   *Technical/Definitional*\n    -   Simple linear regression chooses a $\\hat{\\beta_0}$ and $\\hat{\\beta_1}$ to minimize the Sum of Squared Residuals (SSR):\n\n$$\\textrm{Find }\\hat{\\beta_0},\\,\\hat{\\beta_1} \\text{ arg min}_{\\beta_0, \\beta_1} \\sum (y_i-(\\hat{\\beta_0}+\\hat{\\beta_1}x_i))^2$$ - Multiple linear regression chooses a vector of coefficients $\\hat{\\beta}$ to minimize the Sum of Squared Residuals (SSR):\n\n$$\\textrm{Find }\\widehat{\\beta} \\text{ argmin }_{\\widehat{\\beta}} \\sum \\epsilon^2=\\epsilon^\\prime\\epsilon=(Y-X\\widehat{\\beta})^\\prime(Y-X\\widehat{\\beta})$$\n\n-   *Theoretical*\n    -   Multiple Linear regression provides a **linear** estimate of the conditional expectation function (CEF): $E[Y|X]$ where $Y$ is now a function of multiple predictors, $X$\n\nclass: inverse, middle, center \\# üí° \\## Estimating and Interpreting Multiple Regression Regression Models\n\n## Political Interest and Partisan Evaluations\n\nLet's load some data from the [2016 NES](https://electionstudies.org/data-center/2016-time-series-study/) and explore the relationship between political interest and evaluations of presidential candidates:\n\n-   Political Interest: \"How interested are you in in politics?\n    -   Very Interested\n    -   Somewhat interested\n    -   Not very Interested\n    -   Not at all Interested\n-   Feeling Thermometer: \"... On the feeling thermometer scale of 0 to 100, how would you rate\"\n    -   Donald Trump\n    -   Hillary Clinton\n\n## Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nload(url(\"https://pols1600.paultesta.org/files/data/nes.rda\"))\n# Look at data\ndim(nes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1200   14\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(nes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  caseid    state age gender educ faminc pid7 ideo5 pol_interest church_atd\n1    745  Alabama  19      2    3     97    5     3            1          2\n2   1115  Alabama  46      1    3      3    1     1            3          6\n3    258  Alabama  59      2    2      6    2     3            2          1\n4    126  Alabama  55      2    4      6    1     2            3          5\n5    414  Alabama  66      1    3      8    7     4            3          3\n6    523  Alabama  61      1    2     97    1     2            3          6\n  bornagain01 ft_trump ft_hrc vote_choice\n1           0        3     19       Other\n2           0        0     36         HRC\n3           1       22      2        <NA>\n4           0        1     80         HRC\n5           1      100      3        <NA>\n6           1        0    100        <NA>\n```\n\n\n:::\n:::\n\n\n## Data: HLO\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntable(nes$pol_interest)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  0   1   2   3 \n 78 178 348 568 \n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(nes$ft_trump)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   0.00    2.00   30.00   38.38   72.00  100.00       3 \n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(nes$ft_hrc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   0.00    3.00   44.00   42.99   76.00  100.00       1 \n```\n\n\n:::\n:::\n\n\n## Data Wrangling/Recoding\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnes %>%\n  mutate(\n    income = ifelse(faminc > 16, NA, faminc),\n    interested = ifelse(pol_interest==3,T,F),\n    pol_interest_f = factor(case_when(\n      pol_interest == 0 ~ \"Not at all Interested\",\n      pol_interest == 1 ~ \"Not very Interested\",\n      pol_interest == 2 ~ \"Somewhat Interested\",\n      pol_interest == 3 ~ \"Very Interested\"\n    )),\n    tc_diff = abs(ft_trump - ft_hrc)\n  ) -> nes\n```\n:::\n\n\n## Roadmap\n\nLet's estimate the following series of models, predicting the absolute value of the difference in feeling thermometer ratings between Trump and Clinton (`tc_diff`)\n\n$$\\text{tc_diff} = \\beta_0$$ $$\\text{tc_diff} = \\beta_0 + \\beta_1\\text{interested}$$ $$\\text{tc_diff} = \\beta_0 + \\beta_1\\text{pol_interest_f}$$ $$\\text{tc_diff} = \\beta_0 + \\beta_1\\text{pol_interest}$$ $$\\text{tc_diff} = \\beta_0 + \\beta_1\\text{interested} + \\beta_2\\text{age}$$ $$\\text{tc_diff} = \\beta_0 + \\beta_1\\text{interested} + \\beta_2\\text{age} + \\beta_3\\text{interested} \\times \\text{age}$$ $$\\text{tc_diff} = \\beta_0 + \\beta_1\\text{age} + \\beta_2\\text{income}$$\n\n## `m0`: \"The Empty Model\"\n\nA linear model with just an intercept returns the mean of `tc_diff`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm0 <- lm(tc_diff ~ 1, nes)\nm0\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tc_diff ~ 1, data = nes)\n\nCoefficients:\n(Intercept)  \n      53.58  \n```\n\n\n:::\n\n```{.r .cell-code}\nmean(nes$tc_diff, na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 53.57776\n```\n\n\n:::\n\n```{.r .cell-code}\n# Save Sum of Squared Residuals\nssr0 <- sum(m0$residuals^2)\n```\n:::\n\n\n#### `m1` A model with a single dichotomous predictor\n\nNow let's model `tc_diff` as function of whether respondents are very interested in politics (`interested` = T) or not (`interested` = F)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm1 <- lm(tc_diff ~ interested, nes)\ncoef(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   (Intercept) interestedTRUE \n      47.84500       12.74655 \n```\n\n\n:::\n\n```{.r .cell-code}\nmean(nes$tc_diff[nes$interested == F],na.rm = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 47.845\n```\n\n\n:::\n\n```{.r .cell-code}\ncoef(m1)[1] + coef(m1)[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n   60.59155 \n```\n\n\n:::\n\n```{.r .cell-code}\nmean(nes$tc_diff[nes$interested == T],na.rm = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 60.59155\n```\n\n\n:::\n:::\n\n\n#### `m1` A model with a single dichotomous predictor\n\n-   If we tell R not to include an intercept, it returns those conditional means exactly.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm1_alt <- lm(tc_diff ~ -1+ interested, nes)\ncoef(m1_alt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ninterestedFALSE  interestedTRUE \n       47.84500        60.59155 \n```\n\n\n:::\n\n```{.r .cell-code}\ntapply(nes$tc_diff, nes$interested, mean,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   FALSE     TRUE \n47.84500 60.59155 \n```\n\n\n:::\n:::\n\n\n#### `m1` A model with a single dichotomous predictor\n\n-   When we compare the SSR from `m1` we see that it has decreased from `m0` reflecting the fact some of the total variation in `tc_diff` is being explained by the variation in `interested`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Save Sum of Squared Residuals\nssr1 <- sum(m1$residuals^2)\nssr1 < ssr0\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\n#### `m2` A model with a single categoical predictor\n\nNow let's model `tc_diff` as function of the categorical predictor `pol_interest_f`, which is a factor variable of the four unique levels of political interest\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm2 <- lm(tc_diff ~ pol_interest_f, nes)\nm2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tc_diff ~ pol_interest_f, data = nes)\n\nCoefficients:\n                      (Intercept)  pol_interest_fNot very Interested  \n                           46.104                              1.727  \npol_interest_fSomewhat Interested      pol_interest_fVery Interested  \n                            2.136                             14.488  \n```\n\n\n:::\n:::\n\n\n-   Woah, why did R turn a single variable into model with four coefficients?\n\nWhen we give `lm()` factor or character data,\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(m2$model)[1:4,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  tc_diff      pol_interest_f\n1      16 Not very Interested\n2      36     Very Interested\n3      20 Somewhat Interested\n4      79     Very Interested\n```\n\n\n:::\n:::\n\n\nIt converts this data in separate binary indicators for each level excluding the first (\"Not at all interested\"), that take a value of 1 when `pol_interest_f` equals that level and 0 otherwise\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(model.matrix(m2))[1:4,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) pol_interest_fNot very Interested\n1           1                                 1\n2           1                                 0\n3           1                                 0\n4           1                                 0\n  pol_interest_fSomewhat Interested pol_interest_fVery Interested\n1                                 0                             0\n2                                 0                             1\n3                                 1                             0\n4                                 0                             1\n```\n\n\n:::\n:::\n\n\n## `m2` A model with a single categoical predictor\n\nThe coefficients in `m2` tell us how the conditional mean of `tc_diff` for someone with a given level of interest is likely to very from the conditional mean of `tc_diff` for someone that is not at all interested in politics.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntapply(nes$tc_diff, nes$pol_interest_f, mean,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNot at all Interested   Not very Interested   Somewhat Interested \n             46.10390              47.83051              48.23988 \n      Very Interested \n             60.59155 \n```\n\n\n:::\n:::\n\n\n-   `Not at all interested` is the *reference* or *excluded* category, described by the intercept coefficient in `m2`\n\n## `m2` A model with a single categoical predictor\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Compare to\n# Not at all\ncoef(m2)[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n    46.1039 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Not very\ncoef(m2)[1] + coef(m2)[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n   47.83051 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Somewhat\ncoef(m2)[1] + coef(m2)[3]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n   48.23988 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Very\ncoef(m2)[1] + coef(m2)[4]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n   60.59155 \n```\n\n\n:::\n:::\n\n\n## `m2` A model with a single categorical predictor\n\n-   Again if we excluded the intercept `lm()` returns the conditional means\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm2_alt <- lm(tc_diff ~ -1+ pol_interest_f, nes)\ncoef(m2_alt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\npol_interest_fNot at all Interested   pol_interest_fNot very Interested \n                           46.10390                            47.83051 \n  pol_interest_fSomewhat Interested       pol_interest_fVery Interested \n                           48.23988                            60.59155 \n```\n\n\n:::\n\n```{.r .cell-code}\ntapply(nes$tc_diff, nes$pol_interest_f, mean,na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNot at all Interested   Not very Interested   Somewhat Interested \n             46.10390              47.83051              48.23988 \n      Very Interested \n             60.59155 \n```\n\n\n:::\n:::\n\n\n## `m2` A model with a single categorical predictor\n\n-   Finally, note that the SSR for `m2` is lower than that of `m1`. Including more information about varying levels of political interest helped us explain more variation in our outcome\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Save Sum of Squared Residuals\nssr2 <- sum(m2$residuals^2)\nssr2 < ssr1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\n## `m3` A model with a single numeric predictor\n\nWhat if we had instead modeled `tc_diff` as a function of `pol_interest`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm3 <- lm(tc_diff ~ pol_interest, nes)\nm3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tc_diff ~ pol_interest, data = nes)\n\nCoefficients:\n (Intercept)  pol_interest  \n      40.799         6.012  \n```\n\n\n:::\n:::\n\n\n`lm()` returns a single coefficient, because `pol_interest` is a numeric variable.\n\n## Comparing `m2` to `m3`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnes %>%\n  ggplot(aes(pol_interest,tc_diff))+\n  geom_jitter(size=.5, alpha=.5)+\n  geom_smooth(method =\"lm\", aes(col = \"m3\"),se=F)+\n  stat_summary(geom =\"point\",\n               fun = mean,\n               aes(col = \"m2\")\n               )+\n  labs(col = \"Model\")\n```\n:::\n\n\n#### Comparing `m2` to `m3`\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slides_files/figure-revealjs/unnamed-chunk-55-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### `m4`: A model with both a dichtomous and continuous predictor\n\nNow let's estimate a multiple regression model \"controlling\" for age\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm4 <- lm(tc_diff ~ interested + age, nes)\ncoef(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   (Intercept) interestedTRUE            age \n    32.1757944      9.7739375      0.3533876 \n```\n\n\n:::\n:::\n\n\nNote the size of the coefficient on `interested` has decreased, compared to `m1`. Part of the variation `tc_diff` explained by `interested` reflected variation explained by `age`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncoef(m1)[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n     47.845 \n```\n\n\n:::\n\n```{.r .cell-code}\ncoef(m4)[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ninterestedTRUE \n      9.773938 \n```\n\n\n:::\n:::\n\n\n-   Mechanically, we sometimes say the coefficient on `interested` shifts the intercept of the line describing the relationship between `tc_diff` and age.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slides_files/figure-revealjs/unnamed-chunk-58-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### `m5`: A model with an interaction between a dichtomous and continuous predictor\n\nWhat if we think the relationship between `age` and `tc_diff` varies depending on a person's level of political interest?\n\nWe could fit an interacton model:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm5 <- lm(tc_diff ~ interested*age, nes)\ncoef(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       (Intercept)     interestedTRUE                age interestedTRUE:age \n        39.7626421         -6.7040163          0.1822814          0.3396523 \n```\n\n\n:::\n:::\n\n\nMechanically, R takes the data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(m5$model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  tc_diff interested age\n1      16      FALSE  19\n2      36       TRUE  46\n3      20      FALSE  59\n4      79       TRUE  55\n5      97       TRUE  66\n6     100       TRUE  61\n```\n\n\n:::\n:::\n\n\nAnd creates a model matrix:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(model.matrix(m5))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) interestedTRUE age interestedTRUE:age\n1           1              0  19                  0\n2           1              1  46                 46\n3           1              0  59                  0\n4           1              1  55                 55\n5           1              1  66                 66\n6           1              1  61                 61\n```\n\n\n:::\n:::\n\n\n#### `m5`: A model with an interaction between a dichtomous and continuous predictor\n\nThis interaction model essentially estimates separate models describing the relationship between `tc_diff` and `age` for the uninterested...\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm5_uninterested <- lm(tc_diff ~ age, nes,\n                    subset = interested == F)\ncoef(m5_uninterested)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)         age \n 39.7626421   0.1822814 \n```\n\n\n:::\n\n```{.r .cell-code}\ncoef(m5)[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n   39.76264 \n```\n\n\n:::\n\n```{.r .cell-code}\ncoef(m5)[3]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      age \n0.1822814 \n```\n\n\n:::\n:::\n\n\n#### `m5`: A model with an interaction between a dichtomous and continuous predictor\n\nAnd interested\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm5_interested <- lm(tc_diff ~ age, nes,\n                    subset = interested == T)\ncoef(m5_interested)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)         age \n 33.0586258   0.5219337 \n```\n\n\n:::\n\n```{.r .cell-code}\ncoef(m5)[1] +coef(m5)[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n   33.05863 \n```\n\n\n:::\n\n```{.r .cell-code}\ncoef(m5)[3] +coef(m5)[4]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      age \n0.5219337 \n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnes %>%\n  filter(!is.na(interested))%>%\n  ggplot(aes(age, tc_diff, col = interested))+\n  geom_point(size = .5, alpha = .5)+\n  geom_smooth(method =\"lm\")\n```\n\n::: {.cell-output-display}\n![](06-slides_files/figure-revealjs/unnamed-chunk-64-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### `m6`: A model with an two continuous predictors\n\nNow lets model `tc_diff` as a function of two predictors: `age` and `income`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm6 <- lm(tc_diff ~ age + income, nes)\nm6\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tc_diff ~ age + income, data = nes)\n\nCoefficients:\n(Intercept)          age       income  \n    33.1994       0.4003       0.1573  \n```\n\n\n:::\n:::\n\n\nWe interpret this model as saying:\n\n-   Controlling for `income`, as `age` increases by 1 we can expect the predicted difference in `tc_diff` to increase by 0.40\n-   Controlling for `age`, as `income` increases by 1 we can expect the predicted difference in `tc_diff` to increase by 0.16\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slides_files/figure-revealjs/unnamed-chunk-66-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Multiplicative interactions with a continuous moderator\n\nSuppose we wanted to fit an interaction between two continuous variables like `age` and `income`.\n\nThe general form of this model is\n\n$$\nY= \\beta_0 + \\beta_1X + \\beta_2 +\\beta_3X\\times Z + \\epsilon\n$$\n\n-   The marginal effect of X on Y, now depends on the value of Z at which you evaluate the relationship\n\n$$\n\\frac{\\partial Y}{\\partial X}=\\beta_1+\\beta_3Z\n$$\n\nEasier to show this with some simulated data:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slides_files/figure-revealjs/unnamed-chunk-67-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slides_files/figure-revealjs/unnamed-chunk-68-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\nclass: inverse, middle, center \\# üí° \\## Reading Regression Tables\n\n## Regression Tables\n\n-   Academic articles are littered with regression tables.\n\n-   Below we'll see how to produce regression tables in R\n\n-   Learn some heuristics for how to interpret regression tables\n\n    -   We'll cover the theory behind these heuristics in the coming weeks\n\n## Making Regression Tables in R\n\nWe can make a very simple regression table using the `htmlreg` function from the `texreg` package\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntexreg::htmlreg(\n  list(m0,m1,m3,m4,m5,m6)\n)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n\n```\n<table class=\"texreg\" style=\"margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;\">\n<caption>Statistical models</caption>\n<thead>\n<tr>\n<th style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 1</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 2</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 3</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 4</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 5</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 6</th>\n</tr>\n</thead>\n<tbody>\n<tr style=\"border-top: 1px solid #000000;\">\n<td style=\"padding-left: 5px;padding-right: 5px;\">(Intercept)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">53.58<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">47.84<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">40.80<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">32.18<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">39.76<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">33.20<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.92)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(1.26)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(2.35)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(2.71)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(3.62)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(3.35)</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">interestedTRUE</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">12.75<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">9.77<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">-6.70</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(1.81)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(1.84)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(5.55)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">pol_interest</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">6.01<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.98)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">age</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.35<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.18<sup>&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.40<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.05)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.08)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.06)</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">interestedTRUE:age</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.34<sup>&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.11)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">income</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.16</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.29)</td>\n</tr>\n<tr style=\"border-top: 1px solid #000000;\">\n<td style=\"padding-left: 5px;padding-right: 5px;\">R<sup>2</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.00</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.04</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.03</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.07</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.08</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.04</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">Adj. R<sup>2</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.00</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.04</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.03</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.07</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.08</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.04</td>\n</tr>\n<tr style=\"border-bottom: 2px solid #000000;\">\n<td style=\"padding-left: 5px;padding-right: 5px;\">Num. obs.</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1196</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1168</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1168</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1168</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1168</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1049</td>\n</tr>\n</tbody>\n<tfoot>\n<tr>\n<td style=\"font-size: 0.8em;\" colspan=\"7\"><sup>&#42;&#42;&#42;</sup>p &lt; 0.001; <sup>&#42;&#42;</sup>p &lt; 0.01; <sup>&#42;</sup>p &lt; 0.05</td>\n</tr>\n</tfoot>\n</table>\n```\n\n\n:::\n:::\n\n\nYuck, we need to set a argument in the chunk header to results=\"asis\"\n\n````         \n\n```{r echo=F, results = \"asis\"}`r`''`\ntexreg::htmlreg(\n  list(m0,m1,m3,m4,m5,m6)\n)\n\n```\n````\n\n\n::: {.cell layout-align=\"center\"}\n<table class=\"texreg\" style=\"margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;\">\n<caption>Statistical models</caption>\n<thead>\n<tr>\n<th style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 1</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 2</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 3</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 4</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 5</th>\n<th style=\"padding-left: 5px;padding-right: 5px;\">Model 6</th>\n</tr>\n</thead>\n<tbody>\n<tr style=\"border-top: 1px solid #000000;\">\n<td style=\"padding-left: 5px;padding-right: 5px;\">(Intercept)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">53.58<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">47.84<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">40.80<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">32.18<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">39.76<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">33.20<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.92)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(1.26)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(2.35)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(2.71)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(3.62)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(3.35)</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">interestedTRUE</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">12.75<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">9.77<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">-6.70</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(1.81)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(1.84)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(5.55)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">pol_interest</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">6.01<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.98)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">age</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.35<sup>&#42;&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.18<sup>&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.40<sup>&#42;&#42;&#42;</sup></td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.05)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.08)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.06)</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">interestedTRUE:age</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.34<sup>&#42;&#42;</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.11)</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">income</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.16</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">&nbsp;</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">(0.29)</td>\n</tr>\n<tr style=\"border-top: 1px solid #000000;\">\n<td style=\"padding-left: 5px;padding-right: 5px;\">R<sup>2</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.00</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.04</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.03</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.07</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.08</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.04</td>\n</tr>\n<tr>\n<td style=\"padding-left: 5px;padding-right: 5px;\">Adj. R<sup>2</sup></td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.00</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.04</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.03</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.07</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.08</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">0.04</td>\n</tr>\n<tr style=\"border-bottom: 2px solid #000000;\">\n<td style=\"padding-left: 5px;padding-right: 5px;\">Num. obs.</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1196</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1168</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1168</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1168</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1168</td>\n<td style=\"padding-left: 5px;padding-right: 5px;\">1049</td>\n</tr>\n</tbody>\n<tfoot>\n<tr>\n<td style=\"font-size: 0.8em;\" colspan=\"7\"><sup>&#42;&#42;&#42;</sup>p &lt; 0.001; <sup>&#42;&#42;</sup>p &lt; 0.01; <sup>&#42;</sup>p &lt; 0.05</td>\n</tr>\n</tfoot>\n</table>\n:::\n\n\n## Interpreting Regression Tables (Stargazing)\n\n-   Each column is a model\n-   Each row is a coefficient from that model with its **standard error** (more to come) in parantheses below\n-   The bottom of the table shows summary stastitics of the model ( $R^2$ = proportion of variance explained)\n-   Coefficients with asterisks `*` are **statistically significant**\n    -   It is unlikely that we would see a coefficient this big or bigger if the true coefficient were 0\n-   Rule of thumb:\n\n$$\\text{If }\\frac{\\beta}{se} > 2 \\to \\text{Statistically Significant}$$\n\nclass: inverse, middle, center \\# üí° \\## Summary\n\n## Summary\n\nToday we estimated and interpreted a series of multiple regression models\n\n-   The coefficients in these models still describe slopes (partial derivatives), now for planes (and hyper planes)\n\n-   Controlling for variables is easy in `lm()`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm1 <- lm(y ~ x, data=df)\nm2 <- lm(y ~ x + z, data=df)\n```\n:::\n\n\nIn the lab and next week, we will start to explore\n\n-   What it means to \"control for x\"\n-   How can we compare different models\n-   How can we interpret predictions from multiple regression\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}