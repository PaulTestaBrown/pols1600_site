{
  "hash": "5710460cbb70b24fe6e07d5813fb5124",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"POLS 1600\"\nsubtitle: \"Causal Inference in<br>Experimental Designs\"\ndate: last-modified\ndate-format: \"[Updated ]MMM D, YYYY\"\nbibliography: ../files/paperpile.bib\nformat: \n  revealjs:\n    theme: brownslides.scss\n    logo: images/pols1600_hex.png\n    footer: \"POLS 1600\"\n    multiplex: false\n    transition: fade\n    slide-number: c\n    incremental: true\n    center: false\n    menu: true\n    scrollable: true\n    highlight-style: github\n    progress: true\n    code-overflow: wrap\n    html-math-method: mathjax\n    # include-after-body: title-slide.html\n    title-slide-attributes:\n      align: left\n      data-background-image: images/pols1600_hex.png\n      data-background-position: 90% 50%\n      data-background-size: 40%\nfilters:\n    - openlinksinnewpage\n\n    # title-slide-attributes:\n    #   data-background-image: ../../assets/stat20-hex-bg.png\n    #   data-background-size = contain\n---\n\n::: {.cell}\n\n:::\n\n\n\n# {{< fa map-location>}} Overview {.inverse}\n\n## Class Plan {.smaller}\n\n-   Announcements\n-   Feedback\n-   Review\n-   Class plan\n    -   Causal Inference\n    -   Notation for Causal Inference\n    -   Causal Identification\n    -   Causal Identification in Experiments\n    -   `resume` data from QSS (Skipping, but their for your reference)\n    -   Explore Broockman and Kalla (2016)\n\n## Annoucements\n\n- We start taking attendance this week\n\n- Readings for this week:\n\n  - QSS Chapter 2: pp. 38--65\n  - [@Broockman2016-pi](https://pols1600.paultesta.org/files/readings/broockman_kalla_2016.pdf)\n\n- No class next Tuesdays\n\n- No lab next Thursday\n\n- Meet your groups!\n\n## Group Assignments {.smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-8729941803ebf0f2bb48\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8729941803ebf0f2bb48\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\"],[\"Group 1\",\"Group 2\",\"Group 3\",\"Group 4\",\"Group 5\",\"Group 6\",\"Group 7\"],[\"Gurpartap Singh\",\"Sylvie Watts\",\"Joshua Okwaning\",\"Jacqueline Zhang\",\"Talib Reddick\",\"Tess\\tNaquet-Radiguet\",\"Ben Buka\"],[\"Niyah Whitten\",\"Amani Diallo\",\"Eiffel Sunga\",\"Charlie Jeffers\",\"Zoe Kaufman\",\" Anisha Kumar\",\"Ianthe Ince\"],[\"Marisa Coghlin\",\"Sinclair Harris\",\"Jenna Hercher\",\"Meleah Neely\",\"Jenna Lowry\",\"Nash Riebe\",\"Riya Srinivasan\"],[\"Aidan Choi\",\"Peter Zucker\",\"Ella Hendelman\",\"Nene Mokonchu\",\"Harry Laferriere\",\"Sophia Wotman\",\"Kaelah Kimura\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Group<\\/th>\\n      <th>1<\\/th>\\n      <th>2<\\/th>\\n      <th>3<\\/th>\\n      <th>4<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Group\",\"targets\":1},{\"name\":\"1\",\"targets\":2},{\"name\":\"2\",\"targets\":3},{\"name\":\"3\",\"targets\":4},{\"name\":\"4\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n# Feedback\n\n\n\n::: {.cell}\n\n:::\n\n\n\n## What did we like {.smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-618dc1c00185f12c4649\" style=\"width:100%;height:90%;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-618dc1c00185f12c4649\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"fillContainer\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\"],[\"I liked the visualization of the graphs.\",\"I liked learning about how to make the graphs, and I thought the lecture on Tuesday was easy for me to follow along, which made me happy!\",\"I liked being able to learn how to create visualizations.\",\"I enjoyed feeling like it was encouraged to play around and mess things up rather than watch you do it all.\",\"I thought it was interesting to really dive into the covid data and manipulate it as a class. \\n\",\"I really liked last week's class. I liked slowing down and understanding concepts line by line. I also am SO appreciative of Professor Testa answering questions when we have errors in R. I find it's so much more helpful than calling over the TA because so many people have the same issues and also the student will the error misses lecture/class discussion and gets even more off track.\",\"That you took the time to go back and reexplain the topics when a lot of the class was confused. This was helpful because it allowed me to catch up and get on the same page as opposed to falling behind.\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Likes<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":5,\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Likes\",\"targets\":1}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[5,10,25,50,100]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n## What did we dislike {.smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-98a5846d2b711482cc66\" style=\"width:100%;height:90%;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-98a5846d2b711482cc66\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"fillContainer\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\"],[\"I don't think I fully know how to write my own graphs and what all the parameters are for ggplot\",\"I think I am still struggling with conceptually understanding everythingâ€” I can get the results, but I think with all of the various terms and features, it is a bit hard to follow. Even in our readings, I feel it is a lot of learning and I'm having a hard time remembering it all.\",\"I think it would be more helpful to break down each code line by line and code together, instead of having a big code chunk to copy and paste and then break it down when it already worked. I think having a big code chunk creates dependencies and it doesn't show the functions of each line.\",\"At some point I missed the instructions for the tutorials and was surprised to see I had missed a due date.\",\"I found a few of the mutate functions a big hard to understand what they were doing. \\n\",\"I think class, in general, moves super fast. I always like when things are slowed down. Perhaps we don't need to review every single slide if there is a limited time frame.\",\"I just found it frustrating that my computer was going slow. I don't think it is used to this type of pressure haha.\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Dislikes<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":4,\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Dislikes\",\"targets\":1}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[4,10,25,50,100]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n## Setup\n\nEvery time you work in R\n\n-   Save your file to your course or project folder\n\n-   Set your working directory to where your file is saved\n\n-   Load, and if needed, install packages\n\n-   Maybe change some global options in your .Qmd file\n\n## Setting your working directory when working \"Live\"\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](https://statisticsglobe.com/wp-content/uploads/2020/03/figure-2-set-working-directory-to-source-file-location-manually.png)\n:::\n:::\n\n\n\n## Packages for today\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Pacakges for today\nthe_packages <- c(\n  ## R Markdown\n  \"kableExtra\",\"DT\",\n  \n  ## Tidyverse\n  \"tidyverse\", \"lubridate\", \"forcats\", \n  \"haven\", \"labelled\",\n  \n  ## Extensions for ggplot\n  \"ggmap\",\"ggrepel\", \"ggridges\", \n  \"ggthemes\", \"ggpubr\", \"GGally\",\n  \"scales\", \"dagitty\", \"ggdag\", #<<\n  \n  # Data \n  \"COVID19\",\"maps\",\"mapdata\",\n  \"qss\" #<<\n)\n\n## Define a function to load (and if needed install) packages\n\nipak <- function(pkg){\n    new.pkg <- pkg[!(pkg %in% installed.packages()[, \"Package\"])]\n    if (length(new.pkg)) \n        install.packages(new.pkg, dependencies = TRUE)\n    sapply(pkg, require, character.only = TRUE)\n}\n\n## Install (if needed) and load libraries in the_packages\nipak(the_packages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nkableExtra         DT  tidyverse  lubridate    forcats      haven   labelled \n      TRUE       TRUE       TRUE       TRUE       TRUE       TRUE       TRUE \n     ggmap    ggrepel   ggridges   ggthemes     ggpubr     GGally     scales \n      TRUE       TRUE       TRUE       TRUE       TRUE       TRUE       TRUE \n   dagitty      ggdag    COVID19       maps    mapdata        qss \n      TRUE       TRUE       TRUE       TRUE       TRUE       TRUE \n```\n\n\n:::\n:::\n\n\n\n# {{< fa magnifying-glass>}} Review {.inverse}\n\n## Review: Data wrangling\n\n## Data transformations {.smaller}\n\n::: columns\n::: {.column width=\"30%\"}\nYou want to:\n\n-   Load some data\n\n-   Combine multiple functions\n\n-   Look at your data\n\n-   Recode your data\n\n-   Transform your data\n:::\n\n::: {.column width=\"70%\"}\n::: fragment\nYou could use\n\n-   `read_*` functions\n\n-   `%>%` the \"pipe\" operator\n\n-   `glimpse()` `head()`, `filter()`, `select()`, `arrange()`\n\n-   `mutate()`, `case_when()`, `ifelse()`\n\n-   `summarize()`, `group_by()`\n:::\n:::\n:::\n\n## Data Visualization {.smaller}\n\n-   The grammar of graphics\n\n-   At minimum you need:\n\n    -   `data`\n    -   `aesthetic` mappings\n    -   `geometries`\n\n-   Hey Jude, take a sad plot and make it better by:\n\n    -   `labels`\n    -   `themes`\n    -   `statistics`\n    -   `cooridnates`\n    -   `facets`\n    -   transforming your data before plotting\n\n## Practice {.smaller}\n\n\n\n- Create two variables `x` and `y`\n  - `x` should be a random variable with 100 observations from a random normal (`rnorm`) distribution  with mean 0 and standard deviation 1\n  - `y` should be a function of x plus the square of a random normal distribution with mean 0 and standard deviation 1\n- Combine  `x` and `y` into a `data.frame` called `df` \n- `summarize` the `mean`, `median`, standard deviation (`sd`), 16th and 84th percentile (`quantile`) of `x` and `y` and save this to an object called `df_sum`\n- Plot the distributions of `x` and `y`, separately, using a density plot (`geom_density`)\n  - Add a rug to each density plot\n  - Add vertical lines for the mean and median of each variable\n  - A vertical lines at the 16th and and 84th percentile of each plot\n    - Hint use your object `df_sum` as the data for these geometries\n\n\n## Practice {.smaller}\n\n:::: panel-tabset\n\n## Tasks\n\n:::{.nonincremental}\n\n- Create two variables `x` and `y`\n  - `x` should be a random variable with 100 observations from a random normal (`rnorm`) distribution  with mean 0 and standard deviation 1\n  - `y` should be a function of x plus the square of a random normal distribution with mean 0 and standard deviation 1\n- Combine  `x` and `y` into a `data.frame` called `df` \n- `summarize` the `mean`, `median`, standard deviation (`sd`), 16th and 84th percentile (`quantile`) of `x` and `y` and save this to an object called `df_sum`\n- Plot the distributions of `x` and `y`, separately, using a density plot (`geom_density`)\n  - Add a rug to each density plot\n  - Add vertical lines for the mean and median of each variable\n  - A vertical lines at the 16th and and 84th percentile of each plot\n    - Hint: use your object `df_sum` as the data for these geometries\n\n:::\n\n## {{<fa code>}}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load libraries\nlibrary(tidyverse)\n\n# Set seed for reproducibility\nset.seed(123)\n\n# Number of observations\nn <- 1000\n\n# Generate data\nx <- rnorm(n, mean = 0, sd = 1)\ny <- x + (rnorm(n, mean = 0, sd = 1))^2\n\n# Create dataframe\ndf <- data.frame(x = x, y = y)\n\n# Calculate summary statistics\n\ndf_sum <- df %>% \n  dplyr::summarise(\n    x_mean = mean(x),\n    x_median = median(x),\n    x_sd = sd(x),\n    x_16th = quantile(x, probs = .16),\n    x_84th = quantile(x, probs = .84),\n    y_mean = mean(y),\n    y_median = median(y),\n    y_sd = sd(y),\n    y_16th = quantile(y, probs = .16),\n    y_84th = quantile(y, probs = .84)\n  )\n\ndf_sum\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      x_mean    x_median     x_sd   x_16th    x_84th   y_mean  y_median\n1 0.01612787 0.009209639 0.991695 -1.01607 0.9869428 1.036354 0.7302196\n      y_sd     y_16th   y_84th\n1 1.738673 -0.3879478 2.390059\n```\n\n\n:::\n\n```{.r .cell-code}\nfig_x <- df %>% \n  ggplot(aes(x))+\n  geom_density()+\n  geom_rug()+\n  geom_vline(\n    data = df_sum,\n    aes(xintercept = x_mean, col=\"Mean\"))+\n  geom_vline(\n    data = df_sum,\n    aes(xintercept = x_median, col=\"Median\"),\n    linetype = \"dashed\")+\n  geom_vline(\n    data = df_sum,\n    aes(xintercept = x_16th, col=\"16th percentile\"))+\n  geom_vline(\n    data = df_sum,\n    aes(xintercept = x_84th, col=\"84th percentile\"))+\n  geom_segment(\n    aes(y=.45, yend=.45,\n        x = df_sum$x_mean - df_sum$x_sd,\n        xend = df_sum$x_mean + df_sum$x_sd)\n  )+\n  ylim(0,.5)+\n  labs(\n    col = \"Statistic\"\n  )\n\nfig_y <- df %>% \n  ggplot(aes(y))+\n  geom_density()+\n  geom_rug()+\n  geom_vline(\n    data = df_sum,\n    aes(xintercept = y_mean, col=\"Mean\"))+\n  geom_vline(\n    data = df_sum,\n    aes(xintercept = y_median, col=\"Median\"),\n    linetype = \"dashed\")+\n  geom_vline(\n    data = df_sum,\n    aes(xintercept = y_16th, col=\"16th percentile\"))+\n  geom_vline(\n    data = df_sum,\n    aes(xintercept = y_84th, col=\"84th percentile\"))+\n  geom_segment(\n    aes(y=.45, yend=.45,\n        x = df_sum$y_mean - df_sum$y_sd,\n        xend = df_sum$y_mean + df_sum$y_sd)\n  )+\n  ylim(0,.5)+\n  labs(\n    col = \"Statistic\"\n  )\n\ncor(df$x, df$y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.5779469\n```\n\n\n:::\n\n```{.r .cell-code}\nfig_xy <- df %>% \n  ggplot(aes(x,y))+\n  geom_point()+\n  geom_smooth(method=\"lm\")\n```\n:::\n\n\n\n## Figures\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03-slides_files/figure-revealjs/unnamed-chunk-9-1.png){width=960}\n:::\n\n::: {.cell-output-display}\n![](03-slides_files/figure-revealjs/unnamed-chunk-9-2.png){width=960}\n:::\n\n::: {.cell-output-display}\n![](03-slides_files/figure-revealjs/unnamed-chunk-9-3.png){width=960}\n:::\n:::\n\n\n\n## Summary\n\n- Measures of central tendency describe [what's typical]{.blue}\n\n- Measures of dispersion describe [variation around what's typical]{.blue}\n\n:::\n\n# {{< fa lightbulb >}} Causal Inference {.inverse}\n\n## Causal claims imply counterfactual comparisons\n\n::: columns\n::: {.column width=\"40%\"}\n-   Causal claims imply counterfactual comparisons\n\n-   What would have happened if we were to change some aspect of the world?\n:::\n\n::: {.column width=\"60%\"}\n![](https://media.philly.com/images/20150621-Groundhog-day.jpg){.fragment}\n:::\n:::\n\n## What's the counterfactual for these claims:\n\n-   Foreign aid increases develop\n\n-   Joe Rogan cost Kamala the 2024 election\n\n-   Democracies don't fight wars with other democracies\n\n-   Universal Pre-K improves child development\n\n## Casual claims are all around us\n\n::: columns\n::: {.column width=\"45%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](https://images-na.ssl-images-amazon.com/images/I/A1qhBebbu6L.jpg)\n:::\n:::\n\n\n:::\n\n::: {.column width=\"45%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](https://press.uchicago.edu/.imaging/mte/ucp/medium/dam/ucp/books/jacket/978/02/26/11/9780226112374.jpg/jcr:content/9780226112374.jpg)\n:::\n:::\n\n\n:::\n:::\n\n## Casual claims  are all around us\n\nWhat are some questions that interest you?\n\nWhat are the counterfactual comparisons they imply?\n\n# {{< fa lightbulb >}} Notation for Causal Inference {.inverse}\n\n## How to represent causal claims\n\nIn this course, we will use two forms of notation to describe our causal claims.\n\n-   Directed Acyclic Graphs (DAGs, next lecture)\n\n-   **Potential Outcomes Notation**\n\n## General Notation: Variables {.smaller}\n\n-   `Y` our [outcome]{.blue} of interest\n\n-   `D` an indicator of [treatment]{.blue} status\n\n    -   `D=1` $\\to$ treated\n    -   `D=0` $\\to$ not treated (control)\n\n-   `Z` an of [assignment]{.blue} status\n\n    -   `Z=1` $\\to$ assigned to treatment\n    -   `Z=0` $\\to$ assigned to control\n\n-   `X` a [covariate]{.blue} or [predictor]{.blue} we can measure/observe\n\n-   `U` [unmeasured]{.blue} covariates\n\n## Expected Values\n\n::: nonincremental\n-   The $E[Y]$ reads as \"the expected value of Y\"\n\n-   $E[Y]$ is defined as a probability weighted average based on the unconditional probability of Y ( $f(y)$ )\n\n$$\\operatorname{E}[Y] = \\int_{-\\infty}^\\infty y f(y)\\, dy$$\n:::\n\n## Conditional Expectations\n\n::: nonincremental\n-   The $E[Y|X=x]$ reads as \"the expected value of Y conditional on the value of X\"\n\n-   $E[Y|X=x]$ is defined as a probability weighted average of Y based on the conditional probability of Y given X ( $y f_{Y|X}(y|x)$ )\n\n$$\\operatorname{E}[Y \\vert X=x] = \\int_{-\\infty}^\\infty y f (y\\vert x) \\, dy$$\n:::\n\n## Estimands, Estimators and Estimates {.smaller}\n\n-   [Estimand]{.blue} the thing we want to know.\n\n    -   Sometimes called a [parameter ($\\theta$, \"theta\")]{.blue} or [quantity of interest]{.blue}\n    -   The expected value of heights in POLS 1600 ($\\theta =E[X]$)\n\n-   [Estimator]{.blue} a rule or method for calculating an [estimate]{.blue} of our [estimand]{.blue}\n\n    -   An average of a sample of 10 student's heights in POLS 1600\n    -   $\\hat{\\theta} = \\bar{x} = 1/n*\\sum_1^{n} x_i$\n\n-   [Estimate:]{.blue} a value produced by our estimator for some data\n\n    -   The average of our 10 person sample is `5'10''`\n\n## Error and Bias {.smaller}\n\nFormally, we'll say an estimate, $\\hat{\\theta}$ (\"theta hat\") is an unbiased estimator of a parameter, $\\theta$ (\"theta\") if:\n\n$$\nE[\\hat{\\theta}] = \\theta\n$$\n\nBias or error, $\\epsilon$, is the difference between our estimate and the truth\n\n$$\n\\epsilon = \\hat{\\theta} -\\theta\n$$\n\nAn estimator is unbiased if, on average, the errors equal 0\n\n$$\nE[\\epsilon] = E[\\hat{\\theta} -\\theta] = 0\n$$\n\n## Bias vs. variance\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](https://www.cs.cornell.edu/courses/cs4780/2018fa/lectures/images/bias_variance/bullseye.png)\n:::\n:::\n\n\n\n## The bias-variance tradeoff\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](http://scott.fortmann-roe.com/docs/docs/BiasVariance/biasvariance.png)\n:::\n:::\n\n\n\n## Potential outcomes notation {.smaller}\n\n-   $Y_i(1)$ describes individual $i$'s outcome, $Y_i$ if they [received the treatment]{.blue} $(D_i = 1)$\n    -   Shorthand for $Y_i(D_i=1)$\n    -   Paul's Covid-19 status ($Y_i$) with the vaccine ($D_i = 1$)\n-   $Y_i(0)$ describes individual $i$'s outcome, $Y_i$ if they [did not receive the treatment]{.blue} $(D_i = 0)_i$\n    -   Shorthand for $Y_i(D_i=0)$\n    -   Paul's Covid-19 status ($Y_i$) without the vaccine ($D_i=0$)\n\n. . .\n\nThe [treatment received]{.blue} determines which [potential outcome]{.blue} we actually [observe]{.blue}:\n\n$$\nY_i = (1 - D_i)*Y_i(0) + D_i*Y_i(1)\n$$\n\nPotential outcomes are fixed, but we only observe one (of many) potential outcomes $\\to$ *Fundamental Problem of Causal Inference*\n\n## Fundamental Problem of Causal Inference {.smaller}\n\nThe individual causal effect (ICE), $\\tau_i$, is defined as\n\n$$\n\\tau_i \\equiv Y_i(1) - Y_i(0)\n$$\n\n-   The [fundamental problem of causal inference]{.blue} is that we only ever see one potential outcome for an individual, and so it's [impossible to know]{.blue} the causal effect of some intervention for that individual\n\n-   The ICE is [unidentified]{.blue}\n\n# {{< fa lightbulb >}} Causal Identification {.inverse}\n\n## Identification\n\n-   Identification refers to [what we can learn]{.blue} from the data available\n\n-   A quantity of interest is [identified](https://en.wikipedia.org/wiki/Identifiability) if, with infinite data it can only take one value\n\n-   For example, a coefficient in an equation can be [unidentified]{.blue} if\n\n    -   We have more predictors than observations, or\n\n    -   Some of predictors are linear combinations of other predictors.\n\n## Causal Identification\n\n-   [Casual Identification]{.blue} refers to \"the assumptions needed for statistical estimates to be given a causal interpretation\" [Keele (2015)](http://lukekeele.com/wp-content/uploads/2016/03/causal.pdf)\n\n-   [What's Your Casual Identification Strategy]{.blue} What are the assumptions that make your research design credible?\n\n-   **Identification \\> Estimation**\n\n## Observational vs Experimental Designs\n\n-   [Experimental designs]{.blue} are studies in which a causal variable of interest, the *treatement*, is [manipulated by the researcher]{.blue} to examine its causal effects on some *outcome* of interest\n\n-   [Observational designs]{.blue} are studies in which a causal variable of interest is determined by someone/thing [other than the researcher]{.blue} (nature, governments, people, etc.)\n\n# {{< fa lightbulb >}} Causal Identification in Experimental Designs {.inverse}\n\n## The FPoCI is a problem of missing data {.smaller}\n\nRecall that an individual causal effect $\\tau_i$, is defined as:\n\n$$\n\\tau_i \\equiv Y_i(1) - Y_i(0)\n$$\n\nThe problem is that for any one individual, we only observe $Y_i(1)$ or $Y_i(0)$, but never both.\n\n-   If Paul got the vaccine $(Y_{Paul}(Vaxxed)=\\text{Covid Free})$, then we don't know what Paul's health status would have been, had he not got the vaccine $(Y_{Paul}(Unvaxxed) =???)$\n\n## A statistical solution to the FPoCI {.smaller}\n\nRather than focus individual causal effects:\n\n$$\n\\tau_i \\equiv Y_i(1) - Y_i(0)\n$$\n\nWe focus on average causal effects (Average Treatment Effects \\[ATEs\\]):\n\n$$\nE[\\tau_i] = \\overbrace{E[Y_i(1) - Y_i(0)]}^{\\text{Average of a difference}} = \\overbrace{E[Y_i(1)] - E[Y_i(0)]}^{\\text{Difference of Averages}}\n$$\n\nWhen does the difference of averages provide us with a good estimate of the average difference?\n\nLet's consider a simple example\n\n## Does eating chocolate make you happy?\n\n-   $Y_i$ happiness measured on a 0-10 scale\n\n-   $D_i$ whether a person ate [chocolate]{style=\"color: chocolate\"} $(D=1)$ or [fruit]{style=\"color: purple\"} $(D = 0)$\n\n-   $Y_i(1)$ a person's happiness eating [chocolate]{style=\"color: chocolate\"}\n\n-   $Y_i(0)$ a person's happiness eating [fruit]{style=\"color: purple\"}\n\n-   $X_i$ a person's self-reported preference $(X_i \\in$ {[chocolate]{style=\"color: chocolate\"}, [fruit]{style=\"color:purple\"} })\n\n\n\n::: {.cell}\n\n:::\n\n\n\n##  {.smaller}\n\n::: columns\n::: {.column width=\"45%\"}\n#### Potential Outcomes:\n\n\n\n\n|$Y_i(1)$                                                  |$Y_i(0)$                                                | $\\tau_i$|\n|:---------------------------------------------------------|:-------------------------------------------------------|--------:|\n|<span style=\"     color: chocolate !important;\" >7</span> |<span style=\"     color: purple !important;\" >3</span>  |        4|\n|<span style=\"     color: chocolate !important;\" >8</span> |<span style=\"     color: purple !important;\" >6</span>  |        2|\n|<span style=\"     color: chocolate !important;\" >5</span> |<span style=\"     color: purple !important;\" >4</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >4</span> |<span style=\"     color: purple !important;\" >3</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >6</span> |<span style=\"     color: purple !important;\" >10</span> |       -4|\n|<span style=\"     color: chocolate !important;\" >8</span> |<span style=\"     color: purple !important;\" >9</span>  |       -1|\n|<span style=\"     color: chocolate !important;\" >5</span> |<span style=\"     color: purple !important;\" >4</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >7</span> |<span style=\"     color: purple !important;\" >8</span>  |       -1|\n|<span style=\"     color: chocolate !important;\" >4</span> |<span style=\"     color: purple !important;\" >3</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >6</span> |<span style=\"     color: purple !important;\" >0</span>  |        6|\n\n\n| $E[Y_i(1)]$| $E[Y_i(0)]$| $E[\\tau_i]$|\n|-----------:|-----------:|-----------:|\n|           6|           5|           1|\n\n\n:::\n\n::: {.column width=\"45%\"}\n-   If we could observe everyone's potential outcomes, we could calculate the ICE\n\n-   On average eating chocolate increases happiness by 1 point on our 10-point scale (ATE = 1)\n\n-   Suppose we conducted a study and let folks [select]{.blue} what they wanted to eat.\n:::\n:::\n\n##  {.smaller}\n\n::: columns\n::: {.column width=\"45%\"}\n#### Potential Outcomes:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|$Y_i(1)$                                                  |$Y_i(0)$                                                | $\\tau_i$|\n|:---------------------------------------------------------|:-------------------------------------------------------|--------:|\n|<span style=\"     color: chocolate !important;\" >7</span> |<span style=\"     color: purple !important;\" >3</span>  |        4|\n|<span style=\"     color: chocolate !important;\" >8</span> |<span style=\"     color: purple !important;\" >6</span>  |        2|\n|<span style=\"     color: chocolate !important;\" >5</span> |<span style=\"     color: purple !important;\" >4</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >4</span> |<span style=\"     color: purple !important;\" >3</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >6</span> |<span style=\"     color: purple !important;\" >10</span> |       -4|\n|<span style=\"     color: chocolate !important;\" >8</span> |<span style=\"     color: purple !important;\" >9</span>  |       -1|\n|<span style=\"     color: chocolate !important;\" >5</span> |<span style=\"     color: purple !important;\" >4</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >7</span> |<span style=\"     color: purple !important;\" >8</span>  |       -1|\n|<span style=\"     color: chocolate !important;\" >4</span> |<span style=\"     color: purple !important;\" >3</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >6</span> |<span style=\"     color: purple !important;\" >0</span>  |        6|\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| $E[Y_i(1)]$| $E[Y_i(0)]$| $ATE$|\n|-----------:|-----------:|-----:|\n|           6|           5|     1|\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"45%\"}\n#### Observed Treatment:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|$x_i$                                                             |$d_i$                                                     |$y_i$                                                     |\n|:-----------------------------------------------------------------|:---------------------------------------------------------|:---------------------------------------------------------|\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >7</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >5</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >10</span>   |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >9</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >5</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >8</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >6</span> |\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| $\\bar{y}_{d=1}$| $\\bar{y}_{d=0}$| $\\hat{ATE}$|\n|---------------:|---------------:|-----------:|\n|            5.57|               9|       -3.43|\n\n\n:::\n:::\n\n\n:::\n:::\n\n##  {.smaller}\n\n::: columns\n::: {.column width=\"45%\"}\n#### Observed Treatment:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|$x_i$                                                             |$d_i$                                                     |$y_i$                                                     |\n|:-----------------------------------------------------------------|:---------------------------------------------------------|:---------------------------------------------------------|\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >7</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >5</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >10</span>   |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >9</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >5</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >8</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >6</span> |\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| $\\bar{y}_{d=1}$| $\\bar{y}_{d=0}$| $\\hat{ATE}$|\n|---------------:|---------------:|-----------:|\n|            5.57|               9|       -3.43|\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"45%\"}\n#### Selection Bias\n\n-   Our estimate of the ATE is [biased]{.blue} by the fact that folks who prefer fruit seem to be happier than folks who prefer chocolate in this example\n\n-   In general, [selection bias]{.blue} occurs when folks who receive the treatment differ systematically from folks who don't\n\n-   What if instead of letting people pick and choose, we [randomly assigned]{.blue} half our respondents to [chocolate]{style=\"color: chocolate\"} and half to receive [fruit]{style=\"color: purple\"}\n:::\n:::\n\n##  {.smaller}\n\n\n\n::: {.cell}\n\n:::\n\n\n\n::: columns\n::: {.column width=\"45%\"}\n#### Potential Outcomes:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|$Y_i(1)$                                                  |$Y_i(0)$                                                | $\\tau_i$|\n|:---------------------------------------------------------|:-------------------------------------------------------|--------:|\n|<span style=\"     color: chocolate !important;\" >7</span> |<span style=\"     color: purple !important;\" >3</span>  |        4|\n|<span style=\"     color: chocolate !important;\" >8</span> |<span style=\"     color: purple !important;\" >6</span>  |        2|\n|<span style=\"     color: chocolate !important;\" >5</span> |<span style=\"     color: purple !important;\" >4</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >4</span> |<span style=\"     color: purple !important;\" >3</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >6</span> |<span style=\"     color: purple !important;\" >10</span> |       -4|\n|<span style=\"     color: chocolate !important;\" >8</span> |<span style=\"     color: purple !important;\" >9</span>  |       -1|\n|<span style=\"     color: chocolate !important;\" >5</span> |<span style=\"     color: purple !important;\" >4</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >7</span> |<span style=\"     color: purple !important;\" >8</span>  |       -1|\n|<span style=\"     color: chocolate !important;\" >4</span> |<span style=\"     color: purple !important;\" >3</span>  |        1|\n|<span style=\"     color: chocolate !important;\" >6</span> |<span style=\"     color: purple !important;\" >0</span>  |        6|\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| $E[Y_i(1)]$| $E[Y_i(0)]$| $ATE$|\n|-----------:|-----------:|-----:|\n|           6|           5|     1|\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"45%\"}\n#### Randomly Assigned Treatment:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|$x_i$                                                             |$d_i$                                                     |$y_i$                                                     |\n|:-----------------------------------------------------------------|:---------------------------------------------------------|:---------------------------------------------------------|\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >7</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >4</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >10</span>   |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >4</span>    |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >8</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >0</span>    |\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| $\\bar{y}_{d=1}$| $\\bar{y}_{d=0}$| $\\hat{ATE}$|\n|---------------:|---------------:|-----------:|\n|             6.2|             5.2|           1|\n\n\n:::\n:::\n\n\n:::\n:::\n\n##  {.smaller}\n\n::: columns\n::: {.column width=\"45%\"}\n#### Randomly Assigned Treatment:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|$x_i$                                                             |$d_i$                                                     |$y_i$                                                     |\n|:-----------------------------------------------------------------|:---------------------------------------------------------|:---------------------------------------------------------|\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >7</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >4</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >10</span>   |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >4</span>    |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >8</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >0</span>    |\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| $\\bar{y}_{d=1}$| $\\bar{y}_{d=0}$| $\\hat{ATE}$|\n|---------------:|---------------:|-----------:|\n|             6.2|             5.2|           1|\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"45%\"}\n#### Random Assignment\n\n-   When treatment has been [randomly assigned]{.blue}, a difference in sample means provides an [unbiased]{.blue} estimate of the [ATE]{.blue}\n\n-   The fact that our $\\hat{ATE} = ATE$ in this example is pure coincidence.\n\n-   If we randomly assigned treatment a different way, we'd get a different estimate.\n\n-   In general unbiased estimators will tend to be neither too high nor too low (e.g. $E[\\hat{\\theta} - \\theta] = 0$\\])\n:::\n:::\n\n## Estimating an Average Treatment Effect {.smaller}\n\nIf we treatment has been randomly assigned, we can estimate the ATE by taking the difference of means between treatment and control:\n\n$$\n\\begin{align*}\nE \\left[ \\frac{\\sum_1^m Y_i}{m}-\\frac{\\sum_{m+1}^N Y_i}{N-m}\\right]&=\\overbrace{E \\left[ \\frac{\\sum_1^m Y_i}{m}\\right]}^{\\substack{\\text{Average outcome}\\\\\n\\text{among treated}\\\\ \\text{units}}}\n-\\overbrace{E \\left[\\frac{\\sum_{m+1}^N Y_i}{N-m}\\right]}^{\\substack{\\text{Average outcome}\\\\\n\\text{among control}\\\\ \\text{units}}}\\\\\n&= E [Y_i(1)|D_i=1] -E[Y_i(0)|D_i=0]\n\\end{align*}\n$$\n\nThat is, the ATE is causally identified by the **difference of means** estimator in an experimental design\n\n##  {.smaller}\n\n:::: columns\n::: {.column width=\"30%\"}\n#### Random Assignment 1\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|$x_i$                                                             |$d_i$                                                     |$y_i$                                                     |\n|:-----------------------------------------------------------------|:---------------------------------------------------------|:---------------------------------------------------------|\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >7</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >4</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >10</span>   |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >4</span>    |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >8</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >0</span>    |\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| $\\bar{y}_{d=1}$| $\\bar{y}_{d=0}$| $\\hat{ATE}$|\n|---------------:|---------------:|-----------:|\n|             6.2|             5.2|           1|\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"30%\"}\n#### Random Assignment 2\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|$x_i$                                                             |$d_i$                                                     |$y_i$                                                     |\n|:-----------------------------------------------------------------|:---------------------------------------------------------|:---------------------------------------------------------|\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >3</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >4</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >6</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >8</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >4</span>    |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >7</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >3</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >0</span>    |\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| $\\bar{y}_{d=1}$| $\\bar{y}_{d=0}$| $\\hat{ATE}$|\n|---------------:|---------------:|-----------:|\n|             6.6|             2.8|         3.8|\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"30%\"}\n#### Random Assignment 3\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|$x_i$                                                             |$d_i$                                                     |$y_i$                                                     |\n|:-----------------------------------------------------------------|:---------------------------------------------------------|:---------------------------------------------------------|\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >7</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >6</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >5</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >10</span>   |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >9</span>    |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >4</span>    |\n|<span style=\"     color: purple !important;\" >fruit</span>        |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >7</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: chocolate !important;\" >1</span> |<span style=\"     color: chocolate !important;\" >4</span> |\n|<span style=\"     color: chocolate !important;\" >chocolate</span> |<span style=\"     color: purple !important;\" >0</span>    |<span style=\"     color: purple !important;\" >0</span>    |\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| $\\bar{y}_{d=1}$| $\\bar{y}_{d=0}$| $\\hat{ATE}$|\n|---------------:|---------------:|-----------:|\n|             5.4|             5.8|        -0.4|\n\n\n:::\n:::\n\n\n:::\n::::\n\n## Distribution of Sample ATEs\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03-slides_files/figure-revealjs/unnamed-chunk-36-1.png){width=960}\n:::\n:::\n\n\n\n\n## Why Random Assignment Matters? {.smaller}\n\nFormally, randomly assigning treatments creates [statistical independence]{.blue} $(\\unicode{x2AEB})$ between treatment ( $D$ ) and potential outcomes ( $Y(1),Y(0)$ ) as well as any observed ( $X$ ) or unobserved confounders ( $U$ ):\n\n$$Y_i(1),Y_i(0),\\mathbf{X_i},\\mathbf{U_i} \\unicode{x2AEB} D_i$$\n\nPractically, what this means is that what we can observe ( differences in conditional means for [treated]{.blue} and [control]{.blue} ), provide good ([unbiased]{.blue}) estimates of what we're trying to learn about ([Average Treatment Effects]{.blue})\n\n## Causal Identification with Experimental Designs {.smaller}\n\nCausal identification for experimental designs requires very few assumptions:\n\n-   [Independence]{.blue} (Satisfied by Randomization)\n\n    -   $Y(1), Y(0),X,U, \\perp D$\n\n-   [SUTVA]{.blue} Stable Unit Treatment Value Assumption (Depends on features of the design)\n\n    -   No interference between units $Y_i(d_1, d_2, \\dots, d_N) = Y_i(d_i)$\n    -   No hidden values of the treatment/Variation in the treatment\n\n## Random assignment creates testable implications {.smaller}\n\n-   If treatment has been randomly assigned, we would expect treatment and control groups to [look similar]{.blue} in terms of [pre-treatment covariates]{.blue}\n\n    -   We can show [covariate balance]{.blue} by comparing the means in each treatment group\n\n-   If the treatment had an effect, than we can credibly claim that that effect was due to the presence or absence of the treatment, and not some alternative explanation.\n\n-   This type of clean [apples-to-apples]{.blue} counterfactual comparison is what people mean when they talk about an *experimental ideal*\n\n## No Causation without Manipulation?\n\n-   \"No causation without manipulation\" - [Holland (1986)](https://www.jstor.org/stable/2289064)\n-   Causal effects are well defined when we can imagine manipulating (changing) the value of $D_i$ and only $D_i$\n-   But what about the \"effects\" of things like:\n    -   Race\n    -   Sex\n    -   Democracy\n-   Studying the effects of these factors requires strong theory and clever design [Sen and Wasow (2016)](https://scholar.harvard.edu/files/msen/files/race_causality.pdf)\n\n# {{< fa code>}} Estimating ATEs with the `resume` data {.inverse}\n\n## The Resume Experiment\n\nLet's take a look at the resume experiment from your text book and compare some of Imai's code to its `tidyverse` equivalent\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make sure qss package is loaded\nlibrary(qss)\ndata(\"resume\")\n```\n:::\n\n\n\n## High level Overview (p. 34)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(resume)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4870    4\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(resume)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  firstname    sex  race call\n1   Allison female white    0\n2   Kristen female white    0\n3   Lakisha female black    0\n4   Latonya female black    0\n5    Carrie female white    0\n6       Jay   male white    0\n```\n\n\n:::\n:::\n\n\n\n## High level Overview (p. 34)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(resume)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  firstname             sex                race                call        \n Length:4870        Length:4870        Length:4870        Min.   :0.00000  \n Class :character   Class :character   Class :character   1st Qu.:0.00000  \n Mode  :character   Mode  :character   Mode  :character   Median :0.00000  \n                                                          Mean   :0.08049  \n                                                          3rd Qu.:0.00000  \n                                                          Max.   :1.00000  \n```\n\n\n:::\n:::\n\n\n\n## Crosstabs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrace.call.tab <- table(race = resume$race,\n                       call = resume$call)\nrace.call.tab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       call\nrace       0    1\n  black 2278  157\n  white 2200  235\n```\n\n\n:::\n\n```{.r .cell-code}\naddmargins(race.call.tab)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       call\nrace       0    1  Sum\n  black 2278  157 2435\n  white 2200  235 2435\n  Sum   4478  392 4870\n```\n\n\n:::\n:::\n\n\n\n## Tidy crosstab\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresume %>%\n  group_by(race, call)%>%\n  summarise(\n    n = n()\n  )%>%\n  pivot_wider(names_from = call, values_from = n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 Ã— 3\n# Groups:   race [2]\n  race    `0`   `1`\n  <chr> <int> <int>\n1 black  2278   157\n2 white  2200   235\n```\n\n\n:::\n:::\n\n\n\n## Calculating Call Back Rates\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Overall\nsum(race.call.tab[,2])/nrow(resume)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.08049281\n```\n\n\n:::\n\n```{.r .cell-code}\n# Black names\ncb_bl <- sum(race.call.tab[1,2])/sum(race.call.tab[1,])\n# White Names\ncb_wh <- sum(race.call.tab[2,2])/sum(race.call.tab[2,])\n\n# ATE\ncb_wh - cb_bl\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.03203285\n```\n\n\n:::\n:::\n\n\n\n## Calculating Call Back Rates with group_by()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresume %>%\n  group_by(race)%>%\n  summarise(\n    call_back = mean(call)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 Ã— 2\n  race  call_back\n  <chr>     <dbl>\n1 black    0.0645\n2 white    0.0965\n```\n\n\n:::\n:::\n\n\n\n## Factor variables in Base R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresume$type <- NA\nresume$type[resume$race == \"black\" & resume$sex == \"female\"] <- \"BlackFemale\"\nresume$type[resume$race == \"black\" & resume$sex == \"male\"] <- \"BlackMale\"\nresume$type[resume$race == \"white\" & resume$sex == \"female\"] <- \"WhiteFemale\"\nresume$type[resume$race == \"white\" & resume$sex == \"male\"] <- \"WhiteMale\"\n```\n:::\n\n\n\n## Factor variables in Tidy R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresume %>%\n  mutate(\n    type_tidy = case_when(\n      race == \"black\" & sex == \"female\" ~ \"BlackFemale\",\n      race == \"black\" & sex == \"male\" ~ \"BlackMale\",\n      race == \"white\" & sex == \"female\" ~ \"WhiteFemale\",\n      race == \"white\" & sex == \"male\" ~ \"WhiteMale\"\n    )\n  ) -> resume\n```\n:::\n\n\n\n## Comparing approaches\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(base= resume$type, tidy= resume$type_tidy)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             tidy\nbase          BlackFemale BlackMale WhiteFemale WhiteMale\n  BlackFemale        1886         0           0         0\n  BlackMale             0       549           0         0\n  WhiteFemale           0         0        1860         0\n  WhiteMale             0         0           0       575\n```\n\n\n:::\n:::\n\n\n\n## Visualizing Call Back Rates by Name\n\n::: panel-tabset\n## Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresume %>%\n  group_by(race, sex,firstname)%>%\n  summarize(\n    Y = mean(call),\n    n = n()\n  )%>%\n  arrange(desc(Y)) %>%\n  mutate(\n    firstname = forcats::fct_reorder(firstname,Y)\n  )%>%\n  ggplot(aes(Y, firstname,col=race, size=n))+\n  geom_point() + \n  facet_grid(sex~.,scales = \"free_y\")\n```\n:::\n\n\n\n## Figure\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](03-slides_files/figure-revealjs/unnamed-chunk-48-1.png){width=960}\n:::\n:::\n\n\n:::\n\n# {{< fa code>}} Broockman and Kalla (2016) {.inverse}\n\n## Reading Academic Papers\n\n-   Reading academic papers is a skill and takes practice.\n-   You should aim to answer the following:\n    -   What's the research question?\n    -   What's the theoretical framework?\n    -   What's the empirical design?\n    -   What's are the main results?\n\n## Study Design :A placebo-controlled field experiment\n\n1.  Recruited from voter files to complete a baseline survey\n2.  Among those who complete the survey, half are assigned to receive an intervention and half are assigned to receive a placebo\n3.  Only some are actually home or open the door when the canvassers knock.\n4.  These people are then recruited to participate in a series of surveys 3 days, 3 weeks, 6 weeks, and 3 months after the initial intervention.\n\n## Data for Thursday\n\nLet's load the data from the orginal study\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(url(\"https://pols1600.paultesta.org/files/data/03_lab.rda\"))\n```\n:::\n\n\n\n## Codebook {.smaller}\n\n-   `completed_baseline` whether someone completed the baseline survey (\"Survey\") or not (\"No Survey\")\n-   `treatment_assigned` what intervention someone who completed the baseline survey was assigned two (treatment= \"Trans-Equality\", placebo = \"Recycling\")\n-   `answered_door` whether someone answered the door (\"Yes\") or not (\"No\") when a canvasser came to their door\n-   `treatment_group` the treatment assignments of those who answered the door (treatment= \"Trans-Equality\", placebo = \"Recycling\")\n-   `vf_age` the age of the person in years\n-   `vf_female` the respondent's sex (female = 1, male = 0)\n-   `vf_democrat` whether the person was a registered Democract (Democrat=1, 0 otherwise)\n-   `vf_white` whether the person was white (White=1, 0 otherwise)\n-   `vf_vg_12` whether the person voted in the 2012 general election (voted = 1, 0 otherwise)\n\n## HLO\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 68,378\nColumns: 14\n$ completed_baseline <chr> \"No Survey\", \"No Survey\", \"No Survey\", \"No Survey\",â€¦\n$ treatment_assigned <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦\n$ answered_door      <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦\n$ treatment_group    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦\n$ vf_age             <dbl> 23.00000, 38.00000, 48.00000, 49.20192, 49.20192, 4â€¦\n$ vf_female          <dbl> 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, â€¦\n$ vf_democrat        <dbl> 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, â€¦\n$ vf_white           <dbl> 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, â€¦\n$ vf_vg_12           <dbl> 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, â€¦\n$ therm_trans_t0     <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦\n$ therm_trans_t1     <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦\n$ therm_trans_t2     <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦\n$ therm_trans_t3     <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦\n$ therm_trans_t4     <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦\n```\n\n\n:::\n:::\n\n\n\n## Study Design\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(df$completed_baseline)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nNo Survey    Survey \n    66553      1825 \n```\n\n\n:::\n\n```{.r .cell-code}\ntable(df$treatment_assigned)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     Recycling Trans-Equality \n           913            912 \n```\n\n\n:::\n\n```{.r .cell-code}\ntable(df$answered_door)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  No  Yes \n1324  501 \n```\n\n\n:::\n\n```{.r .cell-code}\ntable(df$treatment_group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     Recycling Trans-Equality \n           255            246 \n```\n\n\n:::\n:::\n\n\n\n## Assessing balance in covariates\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  filter(completed_baseline == \"Survey\") %>%\n  select(treatment_assigned,\n         starts_with(\"vf_\"))%>%\n  group_by(treatment_assigned)%>%\n  summarise(\n    across(starts_with(\"vf_\"), mean)\n    ) -> pretreatment_balance\n```\n:::\n\n\n\n## Assessing balance in covariates\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npretreatment_balance\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 Ã— 6\n  treatment_assigned vf_age vf_female vf_democrat vf_white vf_vg_12\n  <chr>               <dbl>     <dbl>       <dbl>    <dbl>    <dbl>\n1 Recycling            46.3     0.593       0.463    0.209    0.757\n2 Trans-Equality       47.7     0.582       0.488    0.217    0.719\n```\n\n\n:::\n:::\n\n\n\n## Assessing balance in covariates\n\n::: panel-tabset\n## Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Rearrange data\npretreatment_balance %>%\n  # Pivot columns except treatement assigned\n  pivot_longer(names_to = \"covariate\", values_to =  \"value\", -treatment_assigned) %>%\n  # Pivot rows two two columns for treatment and placebo\n  pivot_wider(names_from = treatment_assigned) %>%\n  # Calculate covariate balance\n  mutate(\n    Difference = `Trans-Equality` - Recycling\n  )\n```\n:::\n\n\n\n## Balance\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 Ã— 4\n  covariate   Recycling `Trans-Equality` Difference\n  <chr>           <dbl>            <dbl>      <dbl>\n1 vf_age         46.3             47.7      1.40   \n2 vf_female       0.593            0.582   -0.0103 \n3 vf_democrat     0.463            0.488    0.0246 \n4 vf_white        0.209            0.217    0.00790\n5 vf_vg_12        0.757            0.719   -0.0375 \n```\n\n\n:::\n:::\n\n\n:::\n\n# {{< fa home >}} Summary {.inverse}\n\n## Summary\n\n-   Causal Claims involve [counterfactual comparisons]{.blue}\n\n-   The [fundamental problem of causal inference]{.blue} is that for an individual only observe one of many potential outcomes\n\n-   [Causal identification]{.blue} refers to the assumptions necessary to generate credible causal estimates\n\n-   Identification for experimental designs follows from the [random assignment of treatment]{.blue} which allows us to produce unbiased estimates of the [Average Treatment Effect]{.blue}\n\n## References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}