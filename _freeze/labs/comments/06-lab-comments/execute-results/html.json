{
  "hash": "f8f516159a7834b9771b8e67b9bfe32a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Lab 06 - Examining Alternative Explanations for Red Covid'\nsubtitle: \"How to have an argument with regression\"\nauthor: \"Your Group Members Names Here\"\ndate: \"Last Updated 2024-01-24\"\nformat:\n  html:\n    toc: true\n    toc-location: left\n    toc-float: true\n    toc-depth: 2\n    number-sections: true\n---\n\n\n\n\n# Overview {.unnumbered}\n\nToday we will explore the critiques and alternative explanations for the phenomena of \"Red Covid\" discussed by the *NYT*'s David Leonhardt in articles last fall [here](https://www.nytimes.com/2021/09/27/briefing/covid-red-states-vaccinations.html) and more recently [here](https://www.nytimes.com/2021/09/27/briefing/covid-red-states-vaccinations.html).\n\nRecall the core thesis of Red Covid is something like the following:\n\n> Since Covid-19 vaccines became widely available to the general public in the spring of 2021, Republicans have been less likely to get the vaccine. Lower rates of vaccination among Republicans have in turn led to higher rates of death from Covid-19 in Red States compared to Blue States.\n\nA skeptic of this claim might argue that relationship between electoral and epidemelogical outcomes is *spurious*. There are lots of ways that Red States differ from Blue States --- demographics, economics, geography, culture, and so on -- and it is these differences that explain the phenomena of Red Covid. If we were to control for these *omitted variables* the relationship between a state's partisan leanings and Covid-19 would go away.\n\nIn this lab, we will see how we can explore these claims using **multiple regression** to **control** for competing explanations.\n\nTo accomplish this we will:\n\n1.  Get set up to work (10 minutes)\n\nThen we will estimate and interpret a series of regression models:\n\n2.  A baseline Red Covid model using simple bivariate regression using the `Republican vote share` of states to predict the 14-day average of per capita `Covid-19 deaths` on September 23, 2021 (10 Minutes)\n\n3.  A multiple regression model controlling for `Republican vote share` the `median age` (15 minutes)\n\n4.  A model controlling for `Republican vote share`, the `median age` **and** `median income` (15 minutes)\n\n5.  A model controlling for `Republican vote share`, the `median age` `median income` **and** `vaccination rates` (15 minutes)\n\n6.  A model using `Republican vote share`, the `median age` `median income` to predict `vaccination rates` (15 minutes)\n\nFinally, we'll take the weekly survey which will serve as a mid semester check in.\n\nOne of these 6 tasks (excluding the weekly survey) will be randomly selected as the graded question for the lab.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(3092022)\ngraded_question <- sample(1:10,size = 1)\npaste(\"Question\",graded_question,\"is the graded question for this week\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Question 6 is the graded question for this week\"\n```\n\n\n:::\n:::\n\n\nYou will work in your assigned groups. Only one member of each group needs to submit the html file of lab.\n\nThis lab **must** contain the names of the group members in attendance.\n\nIf you are attending remotely, you will submit your labs individually.\n\nHere are your assigned groups for the semester.\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-ce9f310930966a2c97d4\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ce9f310930966a2c97d4\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\"],[\"Anna Lister\",\"Kate Kuli\",\"Andreas Young\",\"Claudia Spelman\",\"\"],[\"Elizabeth Steeves\",\"Fabian Lopez\",\"Lorenzo Mahoney\",\"Ariana Palomo\",\"\"],[\"Will Lake\",\"Taha Siddiqui\",\"Amanda Page\",\"Noah Soutier\",\"\"],[\"Georgia Kennedy-Bailey\",\"Samuel Levine\",\"Elie Lubin\",\"Bianca Rosen\",\"\"],[\"Theo Simmons\",\"Fengyu Seah\",\"Hunter Keneley\",\"Schuyler Dubitsky\",\"\"],[\"Logan Torres\",\"Jonathan Zhang\",\"Osiris Russell-Delano\",\"Aicha Sama\",\"\"],[\"Natalia Ibarra\",\"Khaled Abdo\",\"Starrchild Jackson\",\"Selene Luna\",\"Yoo Min Lee\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Group 1<\\/th>\\n      <th>Group 2<\\/th>\\n      <th>Group 3<\\/th>\\n      <th>Group 4<\\/th>\\n      <th>Group 5<\\/th>\\n      <th>Group 6<\\/th>\\n      <th>Group 7<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Group 1\",\"targets\":1},{\"name\":\"Group 2\",\"targets\":2},{\"name\":\"Group 3\",\"targets\":3},{\"name\":\"Group 4\",\"targets\":4},{\"name\":\"Group 5\",\"targets\":5},{\"name\":\"Group 6\",\"targets\":6},{\"name\":\"Group 7\",\"targets\":7}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n# Goals {.unnumbered}\n\nThe primary goal of this lab is to give you lots of practice estimating and interpreting multiple regression models.\n\nQuestions 2-6 will all ask you to do some combination of the following:\n\n1.  **Fit** a linear model or models using `lm()`\n2.  **Summarize** the results of this model using `summary()`\n3.  **Present** the results of this model or models in a regression table\n4.  **Interpret** your models substantively for other human beings\n\nQuestion 2 will also give you practice visualizing bivariate relationships\n\nIn general, when we interpret the regression coefficients from a linear model we want to know their:\n\n-   **Sign** is the coefficient positive or negative? As the predictor increases does the outcome tend to increase (positive) or decrease (negative)\n-   **Size** is the change in the predicted value of the outcome **substantively** meaningful?\n    -   To facilitate comparisons between predictors, we will use [standardized measures](https://pols1600.paultesta.org/slides/06-slides.html#29){target=\"_blank\"} of Republican Vote Share, Median Age, and Median Income, and Percent Vaccinated\n-   **Significance** today we'll put the cart before the horse, and say, coefficient that has one or more asterisks `*` next to it is *stastically signficant*\n    -   Over the next several weeks, we'll talk in great detail the logic and theory behind statistical inference\n    -   For today, we'll do a bit of \"star-gazing\" using these asterisks[^1] as heuristics to help us evaluate the claims of Leonhardt and his skeptics.\n\n[^1]: In short, these `*` correspond to $p-values$ below different thresholds. One `*` typically means $p < 0.05$. A p-value is a conditional probability that arises from a hypothesis test summarizing the likelihood of observing a particular test statistic (here a regression coefficient, or more specifically, a t-statistic which is the regression coefficient divided by its standard error) given a paritcular hypothesis (typically, but not allows a *null hypothesis* that the true coefficient is 0). In sum, a p-value assess the likelihood of seeing what we did, if in fact, there was no relationship. If that likelihood is small (p\\<0.05), we reject the claim of no relationship. We remain uncertain about the true value of the coefficient, but we are pretty confident it's not 0.\n\n# Workflow {.unnumbered}\n\n# Please knit this .Rmd file {.unnumbered}\n\nAs with every lab, you should:\n\n-   Download the file\n-   Save it in your course folder\n-   **Update the `author:` section of the YAML header to include the names of your group members in attendance.**\n-   Knit the document\n-   Open the html file in your browser (Easier to read)\n-   Write yourcode in the chunks provided\n-   Comment out or delete any test code you do not need\n-   **Knit the document again after completing a section or chunk** (Error checking)\n-   Upload the final lab to [Canvas](https://canvas.brown.edu/courses/1091286/modules/items/10882045){target=\"_blank\"}.\n\n# Get setup to work\n\n## Load Packages\n\nFirst lets load the libraries we'll need for today.\n\nThere's one new package, `htmltools` which we'll use to display regression tables while we work.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nthe_packages <- c(\n  ## R Markdown\n  \"kableExtra\",\"DT\",\"texreg\",\"htmltools\",\n  ## Tidyverse\n  \"tidyverse\", \"lubridate\", \"forcats\", \"haven\", \"labelled\",\n  ## Extensions for ggplot\n  \"ggmap\",\"ggrepel\", \"ggridges\", \"ggthemes\", \"ggpubr\", \n  \"GGally\", \"scales\", \"dagitty\", \"ggdag\", \"ggforce\",\n  # Data \n  \"COVID19\",\"maps\",\"mapdata\",\"qss\",\"tidycensus\", \"dataverse\",\n  # Analysis\n  \"DeclareDesign\", \"easystats\", \"zoo\"\n)\n\n# Define function to load packages\nipak <- function(pkg){\n    new.pkg <- pkg[!(pkg %in% installed.packages()[, \"Package\"])]\n    if (length(new.pkg)) \n        install.packages(new.pkg, dependencies = TRUE)\n    sapply(pkg, require, character.only = TRUE)\n}\n\nipak(the_packages)\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in contrib.url(repos, \"source\"): trying to use CRAN without setting a mirror\n```\n\n\n:::\n:::\n\n\n## Load the data\n\nNext we'll load the data that we created in class on Tuesday which provides a snapshot of the state of Covid-19 on September 23, 2021 in the U.S.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(url(\"https://pols1600.paultesta.org/files/data/06_lab.rda\"))\n```\n:::\n\n\nAfter running this code, the data frame `covid_lab` should appear in your environment pane in R Studio\n\n## Describe the data\n\nIn the code chunk below, please write some code get an high level overview of the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# High level overview\n# Number of observations and variables\ndim(covid_lab)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 50 14\n```\n\n\n:::\n\n```{.r .cell-code}\n# Names of variables\nnames(covid_lab)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"state\"                  \"state_po\"               \"date\"                  \n [4] \"new_deaths_pc_14da\"     \"percent_vaccinated\"     \"winner\"                \n [7] \"rep_voteshare\"          \"med_age\"                \"med_income\"            \n[10] \"population\"             \"rep_voteshare_std\"      \"med_age_std\"           \n[13] \"med_income_std\"         \"percent_vaccinated_std\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Glimpse of data\nglimpse(covid_lab)\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in glimpse(covid_lab): could not find function \"glimpse\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Summary of data\nsummary(covid_lab)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    state             state_po              date            new_deaths_pc_14da\n Length:50          Length:50          Min.   :2021-09-23   Min.   :0.1342    \n Class :character   Class :character   1st Qu.:2021-09-23   1st Qu.:0.2630    \n Mode  :character   Mode  :character   Median :2021-09-23   Median :0.4089    \n                                       Mean   :2021-09-23   Mean   :0.5753    \n                                       3rd Qu.:2021-09-23   3rd Qu.:0.8733    \n                                       Max.   :2021-09-23   Max.   :1.8151    \n percent_vaccinated   winner   rep_voteshare      med_age        med_income   \n Min.   :43.55      Trump:25   Min.   :30.38   Min.   :30.80   Min.   :45081  \n 1st Qu.:49.38      Biden:25   1st Qu.:41.45   1st Qu.:37.12   1st Qu.:55511  \n Median :54.49                 Median :49.59   Median :38.40   Median :60981  \n Mean   :55.83                 Mean   :50.03   Mean   :38.48   Mean   :62631  \n 3rd Qu.:61.76                 3rd Qu.:58.00   3rd Qu.:39.50   3rd Qu.:70601  \n Max.   :72.20                 Max.   :69.50   Max.   :44.70   Max.   :84805  \n   population       rep_voteshare_std   med_age_std       med_income_std   \n Min.   :  578759   Min.   :-1.89751   Min.   :-3.25163   Min.   :-1.7060  \n 1st Qu.: 1827712   1st Qu.:-0.82886   1st Qu.:-0.57300   1st Qu.:-0.6922  \n Median : 4558234   Median :-0.04312   Median :-0.03303   Median :-0.1604  \n Mean   : 6560454   Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000  \n 3rd Qu.: 7530849   3rd Qu.: 0.76915   3rd Qu.: 0.43282   3rd Qu.: 0.7747  \n Max.   :39512223   Max.   : 1.87973   Max.   : 2.63502   Max.   : 2.1554  \n percent_vaccinated_std\n Min.   :-1.5345       \n 1st Qu.:-0.8061       \n Median :-0.1680       \n Mean   : 0.0000       \n 3rd Qu.: 0.7405       \n Max.   : 2.0449       \n```\n\n\n:::\n\n```{.r .cell-code}\n# Variables I want to calculate sd for\nthe_vars <- c(\"new_deaths_pc_14da\",\"rep_voteshare\",\"med_age\",\"med_income\",\"percent_vaccinated\")\n\n# Calculate standard deviations\ncovid_lab %>%\n  select(all_of(the_vars))%>%\n  summarise_all(sd)\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in covid_lab %>% select(all_of(the_vars)) %>% summarise_all(sd): could not find function \"%>%\"\n```\n\n\n:::\n:::\n\n\nPlease use this HLO to answer the following questions:\n\n-   **How many observations are there:** 50\n\n-   **What is an observation (i.e. what is the unit of analysis):** A U.S. State (on September 23, 2021)\n\n-   **What is the primary outcome variable for today:** The 14-day average of new Covid-19 deaths\n\n-   **What are the four main predictors we'll be using:** We'll be predicting Covid-19 deaths with measures of Republican Vote Share (`rep_voteshare`), Median Age (`med_age`), Median Income (`med_income`), and Percent Vaccintated (`percent_vaccinated`).\n\n-   **Will we be using the the raw values of these predictors or their standardized values?** We'll be using the standardized version of these variables which all have the suffix `_std`\n\n-   **What are the standard deviations of our outcome and predictor variables:**\n\n    -   Covid-19 deaths: 0.40 deaths\n    -   Republican vote share: 10.4 percentage points\n    -   Median age: 2.36 years\n    -   Median income: \\$ 10,288\n    -   Vaccination Rate: 7.98 percentage points\n\n# Estimate and interpet the baseline Red Covid model\n\nFirst let's estimate and interpret the following model:\n\n$$\\text{New Covid Deaths} = \\beta_0 + \\beta_1 \\text{Republican Vote Share}_{std} + \\epsilon$$\n\n**All you have to do is run the code chunks below and then interpret the results**\n\nWhen you visualize this model, you will have to **write comments in the code**\n\nThen, you'll use this code as guide for subsequent sections.\n\n## Fit the model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(new_deaths_pc_14da ~ rep_voteshare_std, covid_lab)\n```\n:::\n\n\n## Summarize the results\n\nNow we apply the `summary()` function to our model `m1`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = new_deaths_pc_14da ~ rep_voteshare_std, data = covid_lab)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.66967 -0.21572 -0.03715  0.11169  1.00580 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        0.57530    0.04846  11.872 6.88e-16 ***\nrep_voteshare_std  0.22571    0.04895   4.611 2.99e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3427 on 48 degrees of freedom\nMultiple R-squared:  0.307,\tAdjusted R-squared:  0.2925 \nF-statistic: 21.26 on 1 and 48 DF,  p-value: 2.99e-05\n```\n\n\n:::\n:::\n\n\nWe see that m1 returns two coefficients, which define a line of best fit predicting Covid-19 deaths with the Republican vote share of the 2020 Presidential election:\n\n-   $\\beta_0$ corresponds to the intercept. This is model's prediction for a state where Trump got 0 percent of the vote. This is typically not something we care about.\n\n-   $\\beta_1$ corresponds to the slope. Because we used a standardized measure of vote share, we would say that a 1-standard deviation (about 10 percentage points) increase in Republican vote share is associated with a 0.23 increase the average number of new Covid-19 deaths. Given that this per-capita measure has a standard deviation of 0.4, this is a fairly sizable association.\n\n-   Finally, note that last column of `summary(m1)` `Pr(>|t|)` both the coefficients for the intercept $(\\beta_0)$ and `rep_voteshare_std` ($(\\beta_1)$) are **statistically significant** (ie have an `*` next to them).\n\n## Display the model as a regression table\n\nNext we'll format the results of `summary(m1)` into a **regression table** using the `htmlreg()` function.\n\nRegression tables are a the standard way of concisely presenting the results of regression models.\n\n-   Each named row corresponds to the coefficients form the model\n\n-   If there is an asterisks next to a coefficient, that coefficient is **statistically significant** with a p value below a certain threshold.\n\n-   The numbers in parentheses below each coefficient correspond to the **standard error** of the coefficient (more on that later)[^2]\n\n-   The bottom of the table contains summary statistics of of our model, which we'll ignore for today.\n\n[^2]: A standard error is another one of those things that in the cart we're putting before horse today. Briefly, it is an estimate of the standard deviation of the sampling distribution of a coefficient and describes how much our coefficient might vary had we had a different sample...\n\nThe code after `htmlreg(m1)` allows you to see what output of the table will look like in the html document while you're working in the Rmd file.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-error}\n\n```\nError in htmlreg(list(m1)) %>% HTML() %>% browsable(): could not find function \"%>%\"\n```\n\n\n:::\n:::\n\n\n## Visualize the model\n\nNow let's visualize the results of our `m1` with a scatter plot.\n\nIn the code below, **please write a comment explaining what each section of code is doing**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. Tell ggplot what data to use\ncovid_lab %>%\n# 2. Set the aesthetic mappings of our figure\n  ggplot(aes(x = rep_voteshare_std,\n             y = new_deaths_pc_14da,\n             label = state_po))+\n# 3. Draw points with x values corresponding to Rep vote share and y values corresponding to Covid deaths. \n  geom_point(\n# 4. Make the points smaller in size\n    size = .5\n    )+\n# 5. Add labels using `label=state_po` aesthetic \n  geom_text_repel(\n# 6. Make the label size smaller    \n    size = 2)+\n# 7. Plot the regression model\n  geom_smooth(method = \"lm\")+\n# 8. Change the axis labels\n  labs(\n    x = \"Republican Vote Share (std)\",\n    y = \"New Covid-19 Deaths\\n(14-day ave)\"\n  )\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in covid_lab %>% ggplot(aes(x = rep_voteshare_std, y = new_deaths_pc_14da, : could not find function \"%>%\"\n```\n\n\n:::\n:::\n\n\n## Interpret the results\n\n**In a sentence our two, summarize the results of your analysis in this section**\n\nOur model in this section provides results consistent with the phenomena of Red Covid. State's with higher Republican vote shares tended to have higher per capita rates of death from Covid-19 on September 23, 2022.\n\n# Estimate a model controlling for age\n\nSuppose a skeptic reading the *New York Times* took issue with Leonhardt's claims, and said what's really behind the claim of Red Covid is that Republican states tend to be older and older people are more at Risk of Dying from Covid-19.\n\nOne way we could address this critique is by estimating a multiple regression model that **controlled** for age.\n\n$$\\text{New Covid Deaths} = \\beta_0 + \\beta_1 \\text{Repbulican Vote Share}_{std} + \\beta_2 \\text{Median Age}_{std} + \\epsilon$$\n\nIf our skeptic is right, what should happen to coefficients:\n\n-   **Republican Vote Share:**\n    -   **Sign:** Unclear\n    -   **Size:** Decrease compared `m1`\n    -   **Significance:** Non-Significant\n-   **Median Age:**\n    -   **Sign:** Positive\n    -   **Size:** Unclear\n    -   **Significance:** Significant\n\nIf our critique is right, and the relationship between Partisanship and Covid is confounded by the fact that Red States tend to be older and older people are more likely to die from Covid, then controlling for Age, the coefficient on Republican Vote share should decrease in size (get closer to 0) and lose significance, while the coefficient on Age should be positive (older states have more Covid-19 deaths) and statistically signficant. I'm not sure I have a good sense about the size or magnitude of this effect.\n\n## Fit the model\n\nNow let's test our skeptics' claims by fitting a model `m2` that controls for Age (`med_age_std`).\n\n-   Remember the first argument in `lm()` is formula of the form `outcome variable ~ predictor1 + predictor2 + ...`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- lm(new_deaths_pc_14da ~ rep_voteshare_std + med_age_std, covid_lab)\n```\n:::\n\n\n## Summarize the model\n\nNow let's print out a statistical summary of `m2`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = new_deaths_pc_14da ~ rep_voteshare_std + med_age_std, \n    data = covid_lab)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.6101 -0.2269 -0.0551  0.1124  0.9425 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        0.57530    0.04825  11.924 8.14e-16 ***\nrep_voteshare_std  0.24497    0.05135   4.771 1.82e-05 ***\nmed_age_std        0.06121    0.05135   1.192    0.239    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3412 on 47 degrees of freedom\nMultiple R-squared:  0.3273,\tAdjusted R-squared:  0.2987 \nF-statistic: 11.43 on 2 and 47 DF,  p-value: 8.988e-05\n```\n\n\n:::\n:::\n\n\n## Display the model as a regression table\n\nNext, let's create a regression table that displays `m1` in the first column and `m2` in the second column.\n\n-   To do this, change `list(m1)` from the code above to `list(m1, m2)`\n\n\n::: {.cell}\n::: {.cell-output .cell-output-error}\n\n```\nError in htmlreg(list(m1, m2)) %>% HTML() %>% browsable(): could not find function \"%>%\"\n```\n\n\n:::\n:::\n\n\n## Interpret the results\n\n**In a few sentences, explain whether the results from `m2` support the skeptics criticisms or not?**\n\n-   They do not. Controlling for differences in the median age of state's population does little to change the relationship between partisanship and Covid-19 that we saw in `m1`. If anything the the relationship is slightly stronger, while the coefficient on age is substantively small and statistically non-significant.\n\nPart of what's at play here, is that relationship between age and Covid-19 outcomes at the state level is pretty weak, perhaps reflecting the early focus on vaccinating the eldery.\n\nSimilarly, the idea that Red States tend to be older doesn't appear to be empirically true, perhaps reflecting differences between the general population and voting population.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit models\nm2_death_age <- lm(new_deaths_pc_14da ~ med_age_std, covid_lab)\nm2_rep_age <- lm(rep_voteshare_std ~ med_age_std, covid_lab)\n\n# Summarize models\nsummary(m2_death_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = new_deaths_pc_14da ~ med_age_std, data = covid_lab)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.4298 -0.3080 -0.1646  0.2981  1.2433 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  0.57530    0.05817   9.891 3.63e-13 ***\nmed_age_std -0.01587    0.05876  -0.270    0.788    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4113 on 48 degrees of freedom\nMultiple R-squared:  0.001517,\tAdjusted R-squared:  -0.01928 \nF-statistic: 0.07293 on 1 and 48 DF,  p-value: 0.7883\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(m2_rep_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = rep_voteshare_std ~ med_age_std, data = covid_lab)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.78067 -0.71029  0.01972  0.60954  2.33183 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)  \n(Intercept)  1.565e-16  1.356e-01   0.000   1.0000  \nmed_age_std -3.146e-01  1.370e-01  -2.297   0.0261 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.959 on 48 degrees of freedom\nMultiple R-squared:  0.099,\tAdjusted R-squared:  0.08023 \nF-statistic: 5.274 on 1 and 48 DF,  p-value: 0.02605\n```\n\n\n:::\n\n```{.r .cell-code}\n# Display as formatted regression table\nhtmlreg(list(m2_rep_age,\n             m2_death_age),\n        custom.model.names = c(\"Deaths\", \"Rep Vote\"),\n        custom.coef.names = c(\"(Intercept)\",\"Median Age (std)\"),\n        custom.header = list(\"DV\"=1:2)  )%>% HTML() %>% browsable()\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in htmlreg(list(m2_rep_age, m2_death_age), custom.model.names = c(\"Deaths\", : could not find function \"%>%\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualize the models\ncovid_lab %>%\n  ggplot(aes(x = med_age_std,\n             y = rep_voteshare_std,\n             label = state_po))+\n  geom_point(size = .5)+\n  geom_text_repel(size = 2)+\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in covid_lab %>% ggplot(aes(x = med_age_std, y = rep_voteshare_std, : could not find function \"%>%\"\n```\n\n\n:::\n\n```{.r .cell-code}\ncovid_lab %>%\n  ggplot(aes(x = med_age_std,\n             y = new_deaths_pc_14da,\n             label = state_po))+\n  geom_point(size = .5)+\n  geom_text_repel(size = 2)+\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in covid_lab %>% ggplot(aes(x = med_age_std, y = new_deaths_pc_14da, : could not find function \"%>%\"\n```\n\n\n:::\n:::\n\n\n# Estimate a model controlling for age and income\n\nUndeterred, our skeptic now argues that it's not just age that matters but also socioeconomic factors like wealth.\n\nLet's test this claim using the following model:\n\n$$\\text{New Covid Deaths} = \\beta_0 + \\beta_1 \\text{Repbulican Vote Share}_{std} + \\beta_2 \\text{Median Age}_{std} + \\beta_3\\text{Median Income}_{std}\\epsilon$$\n\nIf the skeptic is right, then controlling for age and income, the coefficient on Republican vote share should **decrease in size and no longer be statistically significant**\n\n## Fit the Model\n\nPlease fit a model called `m3` implied by the skeptic's revised claims\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- lm(new_deaths_pc_14da ~ rep_voteshare_std + med_age_std + med_income_std, covid_lab)\n```\n:::\n\n\n## Summarize the model\n\nSummarize the model `m3` using `summary()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = new_deaths_pc_14da ~ rep_voteshare_std + med_age_std + \n    med_income_std, data = covid_lab)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.51238 -0.16846 -0.06056  0.15048  0.89939 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        0.57530    0.04478  12.848  < 2e-16 ***\nrep_voteshare_std  0.09686    0.06951   1.393  0.17021    \nmed_age_std        0.00379    0.05153   0.074  0.94169    \nmed_income_std    -0.19341    0.06609  -2.927  0.00531 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3166 on 46 degrees of freedom\nMultiple R-squared:  0.4329,\tAdjusted R-squared:  0.3959 \nF-statistic:  11.7 on 3 and 46 DF,  p-value: 8.018e-06\n```\n\n\n:::\n:::\n\n\n## Display the models in a regression table\n\nAnd then display the results of models `m1`, `m2`, and `m3`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhtmlreg(list(m1,m2,m3)) %>% HTML() %>% browsable()\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in htmlreg(list(m1, m2, m3)) %>% HTML() %>% browsable(): could not find function \"%>%\"\n```\n\n\n:::\n:::\n\n\n## Interpret the skeptic's claims\n\n**In a few sentences, explain whether the results from `m3` support the skeptics criticisms or not?**\n\nControlling for median age and income, the coefficient on Republican sote share decreases in size by more than half and is no longer statistically significant. The coefficient on median income is statistically significant and substantively suggests that states with higher median incomes tended to have fewer Covid-19 deaths on September 23, 2021.\n\n# Estimate a model controlling for age, income, and percent vaccinated\n\nHmm, maybe our skeptic has a point. Let's estimate a model that controls for everything from `m3` as well as the vaccination rate in each state.\n\n$$\\text{New Covid Deaths} = \\beta_0 + \\beta_1 \\text{Rep Vote Share}_{std} + \\beta_2 \\text{Median Age}_{std} + \\beta_3\\text{Median Income}_{std}+\\beta_4\\text{Percent Vaxxed}_{std}\\epsilon$$\n\n## Fit the model\n\nYou know the drill.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm4 <- lm(new_deaths_pc_14da ~ rep_voteshare_std + med_age_std + med_income_std + percent_vaccinated_std, covid_lab)\n```\n:::\n\n\n## Summarize the results\n\nAgain, let's get a quick summary of our results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = new_deaths_pc_14da ~ rep_voteshare_std + med_age_std + \n    med_income_std + percent_vaccinated_std, data = covid_lab)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.52486 -0.16880 -0.03045  0.13917  0.94190 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(>|t|)    \n(Intercept)             0.57530    0.04175  13.781  < 2e-16 ***\nrep_voteshare_std      -0.06533    0.08671  -0.753  0.45515    \nmed_age_std             0.07318    0.05400   1.355  0.18213    \nmed_income_std         -0.11191    0.06807  -1.644  0.10716    \npercent_vaccinated_std -0.27582    0.09798  -2.815  0.00721 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2952 on 45 degrees of freedom\nMultiple R-squared:  0.5178,\tAdjusted R-squared:  0.475 \nF-statistic: 12.08 on 4 and 45 DF,  p-value: 9.425e-07\n```\n\n\n:::\n:::\n\n\n## Display the models in a regression table\n\nAnd add `m4` to list of models in our regression table\n\n\n::: {.cell}\n::: {.cell-output .cell-output-error}\n\n```\nError in htmlreg(list(m1, m2, m3, m4)) %>% HTML() %>% browsable(): could not find function \"%>%\"\n```\n\n\n:::\n:::\n\n\n## Interpet the results\n\n**Briefly interpret the results of `m4`**\n\nControlling for vaccination rates, none of the other variables in `m4` are statistically significant predictors of Covid-19 deaths.\n\n# Model percent vaccinated in a state controlling for age, income, and republican vote share\n\nHmm, how should we make sense of `m4`. Let's fit one last model, that predicts vaccination rates as a function of Republican vote share, median age, and median income in a state.\n\n$$\\text{Percent Vaxxed} = \\beta_0 + \\beta_1 \\text{Repbulican Vote Share}_{std} + \\beta_2 \\text{Median Age}_{std} + \\beta_3\\text{Median Income}_{std}\\epsilon$$ Briefly, please describe whether we should expect a statistically significant positive or negative relationship with vaccination rates or whether we should expect no statistically significant relationship.\n\n-   $\\beta_1$ Republican Vote Share: Negative\n\n-   $\\beta_2$ Median Age: Positive\n\n-   $\\beta_3$ Median Income: Positive\n\n## Fit the model\n\nNow let's fit the model. For ease of interpretation, let's use the unstandardized measure of vaccination rates, `percent_vaccinated` as our outcome variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm5 <- lm(percent_vaccinated ~ rep_voteshare_std + med_age_std + med_income_std, covid_lab)\n```\n:::\n\n\n## Summarize the results\n\nAnd summarize the results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = percent_vaccinated ~ rep_voteshare_std + med_age_std + \n    med_income_std, data = covid_lab)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.3665 -2.6483  0.1951  1.6016  7.0928 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        55.8304     0.5029 111.025  < 2e-16 ***\nrep_voteshare_std  -4.7065     0.7806  -6.029 2.62e-07 ***\nmed_age_std         2.0136     0.5787   3.479  0.00111 ** \nmed_income_std      2.3652     0.7422   3.187  0.00258 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.556 on 46 degrees of freedom\nMultiple R-squared:  0.8147,\tAdjusted R-squared:  0.8027 \nF-statistic: 67.43 on 3 and 46 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n## Display the results in a regression table\n\nDisplay them in a regression table\n\n\n::: {.cell}\n::: {.cell-output .cell-output-error}\n\n```\nError in htmlreg(list(m5)) %>% HTML() %>% browsable(): could not find function \"%>%\"\n```\n\n\n:::\n:::\n\n\n## Interpret the results\n\n**Summarize the results of `m5` and offer some broader discussion of what we've learned today**\n\nIn `m5` all three predictors have strong statistically significant relationships with vaccination rates in the expected direction. States where more people voted for Trump in 2020 tend to have lower rates of vaccination. States with an older population, and a richer population tend to have higher rates of vaccination.\n\nThinking back to the previous models we've estimated, we might argue that the effects these predictors have on Covid-19 death rates is mediated through their relationship with vaccination rates.\n\nMore broadly, what does this analysis mean for arguments about Red Covid. I guess, I'd say it's complicated. Vaccines are clearly effective at reducing Covid-19 deaths. In both aggregate and invidual level data, Republicans appear to be less willing to get vaccinated. But lots of other factors influence vaccination rates and public health more broadly.\n\nRegression is a tool for trying to explore these competing explanations, but without strong theory and clever design, it's unlikely to resolve debates. There's almost always a skeptic waiting to say \"Yes, but have you controlled for ...\" We can try to address there concerns by controlling for more and more variables. But a better strategy is often to say, I don't need to control for X because the logic of my design already accounts for X.\n\nStill it's hard to think what that kind of design would be for something like for debates about Red Covid. Maybe we need different (individual data) or maybe we'd want to reframe the question or draw out further testable implications of the claim. If your group is looking for a final project, there are number of directions you could take this kind of analysis:\n\n-   Looking at different periods overtime\n-   Looking at smaller units of aggregation (counties)\n-   Controlling for alternative factors\n-   Leveraging variation in the availability of vaccines over time and place.\n\n# Take the Class Survey {.unnumbered}\n\nPlease take a few moments to complete the [class survey](https://brown.co1.qualtrics.com/jfe/form/SV_6mUeyI7tqVURHQW){target=\"_blank\"} for this week.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.31/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}