{
  "hash": "4ad6c3a0c86d0c59c71caa860a7681fa",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab 10 - Exploring Questions from the 2024 National Elections Pilot Study\"\nauthor: \"Your Group Members Names Here\"\ndate: \"Last Updated 2024-04-11\"\nformat:\n  html:\n    toc: true\n    toc-location: right\n    toc-float: true\n    toc-depth: 2\n    number-sections: true\nfilters:\n  - openlinksinnewpage\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  message: false\n  cache: true\n---\n\n\n\n# Overview {.unnumbered}\n\nIn this lab, we'll continue exploring data from the National Election Studies 2024 Pilot Study. \n\nFrom last week's lab you should have identified some variables of interest in the data, recoded them as needed, and begun to formulate some research questions. \n\nIn this week's lab, we'll pick up where we left off:\n\n1. Set up your work space (5 minutes)\n\n2. Load the data from last week (5 minutes)\n\n3. Quickly summarize the data (15)\n\n4. Revisit and revise your research question and expectations (15 minutes)\n\n5. Estimate models to explore your question (10 minutes)\n\n6. Interpret the results of your model (30 minutes)\n\n\nOne of these 6 tasks will be randomly selected as the graded question for the lab.\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-8bcf8966c9feb04dad33\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8bcf8966c9feb04dad33\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\"],[\"Group 1\",\"Group 2\",\"Group 3\",\"Group 4\",\"Group 5\",\"Group 6\",\"Group 7\",\"Group 8\"],[\"Maia Eng\",\"Andrew Rovinsky\",\"Serafym Rybachkivskyi\",\"Tiffany Eddy\",\"Christopher Maron\",\"Mia Hamilton\",\"Mariana Melzer\",\"Logan Szittai\"],[\"Guadalupe Herrera\",\"Spencer Lorin\",\"Rachel Kim\",\"Daniel Solomon\",\"Daniel Baker\",\"Emily Colon\",\"Kahrie Langham\",\"Keiley Thompson\"],[\"Stephen Robinson\",\"Lucinda Anderson\",\"Kai Blades\",\"Zoe Smith\",\"Neve Diaz-Carr\",\"Davis Kelly\",\"Shannon Feerick-Hillenbrand\",\"Lydell Dyer\"],[\"Jeremiah Harrington\",\"Serenity Hamilton\",\"Emma Coleman\",\"Lorena Calderon\",\"Olivia Hanley\",\"Talia Levine\",\"Jarret Fernandes\",\"Mahir Arora\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Group<\\/th>\\n      <th>1<\\/th>\\n      <th>2<\\/th>\\n      <th>3<\\/th>\\n      <th>4<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Group\",\"targets\":1},{\"name\":\"1\",\"targets\":2},{\"name\":\"2\",\"targets\":3},{\"name\":\"3\",\"targets\":4},{\"name\":\"4\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n# Goals {.unnumbered}\n\nThis week's lab will give you practice:\n\n- Loading libraries needed to do your analysis (Q1)\n\n- Loading data you've already recoded (Q2)\n\n- Summarizing data (Q3)\n\n- Translating research questions into empirical expectations\n  \n- Estimating linear models (Q5)\n\n- Interpreting the substantive and statistical significance of these models (Q6)\n\n\n# Workflow {.unnumbered}\n\n## Please render this .qmd file {.unnumbered}\n\nAs with every lab, you should:\n\n-   Download the file\n-   Save it in your course folder\n-   **Update the `author:` section of the YAML header to include the names of your group members in attendance.**\n-   Render the document\n-   Open the html file in your browser (Easier to read)\n-   Write your code in the **chunks provided under each section**\n-   Comment out or delete any test code you do not need\n-   **Render the document again after completing a section or chunk** (Error checking)\n-   Upload the final lab to [Canvas](https://canvas.brown.edu/courses/1094972/assignments){target=\"_blank\"}.\n\n\n\n# Set up your workspace\n\n\n## Load Packages\n\nPlease load the libraries you will use in your analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Libraries\n```\n:::\n\n\n## Set your working directory in R Studio\n\nIn R studio **set your working directory** to the **folder where this lab is** saved by clicking > Session > Set Working Directory > To Source File Location\n\n![](https://pols1600.paultesta.org/labs/images/09-nes6.png){width=50%}\n\nAfter doing so uncomment `getwd()` Should print out something like\n\n> \"~/Desktop/pols1600/labs/\"\n\nDepending on where your lab is saved\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# In the Top Panel of RStudio Click\n# Session > Set Working Directory > Source File Location\n\n# Uncomment to Check Where Your File is Saved \n# getwd()\n```\n:::\n\n\n:::{.callout-note}\nIf `getwd()` says something like '~/Downloads/' click: \"File > Save As\" and **save this lab** in your **course folder**. Then **close** the version `09-lab.qmd` that was opened from your Downloads folder and **open** the version of `09-lab.qmd` that now exists in your course folder.\n:::\n\n\n# Load the data from last week.\n\nPlease uncomment and if needed, update, the code below to load the data from last week\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load(\"nes24.rda\")\n```\n:::\n\n\n\n:::{.callout-note}\nYou'll need to **have saved** the data from last week's lab to the **same folder** where this lab has been saved. If you didn't save the lab data from last week, you can load a version of the recoded data here:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load(url(\"https://pols1600.paultesta.org/files/data/nes24.rda\"))\n```\n:::\n\n\n:::\n\n# Summarize the data\n\nUse the [code](https://pols1600.paultesta.org/labs/09-lab-comments#create-a-table-of-summary-statistics) from last weeks lab to produce a table of summary statistics.\n\n**Please update the code to include**\n\n- Your specific outcome and predictor variables\n- a column for the **standard deviation** of each variable between the `Max` and `N Missing` columns\n\n## Caclulate summary statistics for recoded variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# # Vector of numeric variables to summarize\n# the_vars <- c(\n#   \"dv_vote_trump2024\", \n#   \"dv_participation\",\n#   \n#   # ---- Add your outcome here ----\n#   \n#   \"age\",\"education\",\"income\",\n#   \"is_white\",\"is_black\",\"is_hispanic\",\"is_asian\",\"is_other\",\n#   \"partyid\",\"is_dem\",\"is_rep\",\"is_ind\"\n#   \n#   # ----- Add your predictor here ----\n# \n#   )\n# \n# # Vector of nicely formatted labels for variables\n# the_labels <- c(\n#   \"Vote for Trump in '24\",\n#   \"Acts of Participation in `20\",\n#   \n#   # ---- Add a label for your DV here ----\n#   \n#   \"Age\",\"Education\", \"Income\",\n#   \"White\", \"Black\",\"Hispanic\",\"Asian\",\"Other\",\n#   \"Party ID\", \"Democrat\",\"Republican\",\"Independent\"\n#   \n#   # ---- Add a label for your IV here ----\n# \n#   )\n# \n# df_summary <- df %>% \n#   select(all_of(the_vars)) %>%\n#   rename_with(~the_labels) %>% \n#   pivot_longer(\n#     cols = everything(),\n#     names_to = \"Variable\"\n#   ) %>% \n#   mutate(\n#     Variable = factor(Variable, levels = the_labels)\n#   ) %>% \n#   group_by(Variable) %>% \n#   summarise(\n#     Min = min(value,na.rm = T),\n#     p25 = quantile(value, prob = .25,na.rm = T),\n#     Median = quantile(value, prob = .5,na.rm = T),\n#     Mean = mean(value, na.rm = T),\n#     p75 = quantile(value, prob = .75,na.rm = T),\n#     Max = max(value,na.rm = T),\n#     \n#     # ---- Add sd here ----\n#     \n#     `N missing` = sum(is.na(value))\n#   )\n```\n:::\n\n\n## Display the results as a formated table\n\nOnce you've created `df_summary`, you can uncomment the code below. Be sure to update the arguments in the `pack_rows()` function\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# kable(df_summary,\n#       digits = 2) %>% \n#   kable_styling() %>% \n#   pack_rows(\"Outcomes\", start_row = 1, end_row = 2) %>% \n#   pack_rows(\"Demographic Predictors\", 3, 10) %>% \n#   pack_rows(\"Political Predictors\", 11, 14)\n```\n:::\n\n\n## Interpret the results\n\nPlease use these tables to **describe a typical respondent** to the 2024 NES Pilot Study:\n\nThe National Election Study's 2024 Pilot Study contains responses from 1909 individuals. The typical respondent in the data was ...\n\n# Formulate a research question and expectations\n\nPlease take a moment, revisit and revise your research questions developed in last weeks lab that contains the following:\n\n- A clear research question\n- A set of expectations and potential alternative explanations\n- The formula for at least two linear models to test these expectations\n\n## Research question\n\n**ME:** How does support for Trump in the 2024 election vary with age and race?\n\n**YOU:** \n\n## Expectations\n\n**ME:** On average, I expect that older voters will be more supportive of Trump, but suspect that this trend varies by race. I expect it will be particularly true among White voters, but less so among people of color. Since, partisanship is likely to be strong predictor of vote choice, I will explore whether these specific relationships hold, once we control for variations in partisan identification which we know varies both by age and race.\n\n**YOU:**\n\n## Linear Model\n\n**ME:** \n\nI will estimate the following models:\n\n$$\ny = \\beta_0 + \\beta_1 age + \\sum\\beta_k race_k + \\epsilon\n$$\nIf my expectations hold, I expect the coefficient on `age` in this model to be positive, indicating older voters are more likely to vote for Trump. White respondents are the reference category in this model^[Because `white` is first level the factor variable `race`] and so the coefficients on the racial indicators ($\\beta_k race$) correspond to how members of each racial group differ from white respondents in their propensity to vote for Trump. I expect all of these coefficients to be negative.\n\nTo explore whether the relationship between age and vote choice varies by race, I will fit an interaction model:\n\n$$\ny = \\beta_0 + \\beta_1 age + \\sum\\beta_k race_k + \\epsilon + \\sum\\beta_{jk} age \\times race_k  + \\epsilon\n$$\nThis model allows the relationship between age and vote choice to vary by race. For white respondents, the relationship is described by $\\beta_1$. Again I expect it to be positive, suggesting older white voters are more likely to vote for trump. For racial minorities, the marginal effect of age for the racial or ethnic group $k$ is described by $\\beta_1 + \\beta_{jk}$. In general, I expect that the coefficients on $\\beta_{jk}$ to be negative such that older racial minorities are less likely to support Trump than older white respondents. \n\nFinally, I will estimate a model that controls for partisanship. If the relationships between age, and race and vote choice are simply a reflection of differences in partisan identification, then coefficients on these predictors should no longer be statistically significant, while the coefficient on partisanship should positive and statistically significant.\n\n$$\ny = \\beta_0 + \\beta_1 pid + \\beta_2 age + \\sum\\beta_k race_k + \\epsilon + \\sum\\beta_{jk} age \\times race_k \\epsilon\n$$\n\n**You:** \n\nWe will estimate the following models:\n\n$$\ny = \\beta_0 + \\beta_1 ...\n$$\n\n$$\ny = \\beta_0 + \\beta_1 ...\n$$\n\n# Estimate your models\n\nBelow I estimate the three models described above\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# # Fit models\n# m1vc <- lm_robust(dv_vote_trump2024 ~ age + race_5cat, df)\n# m2vc <- lm_robust(dv_vote_trump2024 ~ age*race_5cat, df)\n# m3vc <- lm_robust(dv_vote_trump2024 ~ age*race_5cat + partyid, df)\n```\n:::\n\n\nPlease estimate the models described in the previous section\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# # Fit models\n```\n:::\n\n\n\n\n# Interpret your results\n\nPlease produce \n\n- A regression table presenting of your model\n- At least one figure showing predicted values from one model\n\nInterpret your results using both confidence intervals and hypothesis tests to assess the **statistical significance** of your claims and predicted values to help interpret the **substantive significance** of your results\n\n## Regression Table\n\nHere is some template code I used, demontstrating how to update the labels of the columns and rows in the model\n\n\n\n```{.r .cell-code}\n# htmlreg(list(m1vc, m2vc, m3vc),\n#         custom.model.names = c(\n#           \"Baseline\", \"Interaction\", \"Alternative\"\n#         ),\n#         caption = \"Support for Trump in 2024\",\n#         caption.above = T,\n#         custom.coef.names = c(\n#           \"(Intercept)\",\n#           \"Age\",\n#           \"Black\",\n#           \"Hispanic\",\n#           \"Asian\",\n#           \"Other\",\n#           \"Age:Black\",\n#           \"Age:Hispanic\",\n#           \"Age:Asian\",\n#           \"Age:Other\",\n#           \"Party ID\"\n#         ) ,\n#         include.ci = F,\n#         digits = 3)\n```\n\n\n**Please produce a similar table for your models**\n\n\n## Visualize predicted values \n\nSimilarly here is some code to produce predicted values for `m2vc` and `m3vc`. The basic steps are:\n\n1. Create a prediction data frame varying the values of some predictors from a model, while holding others constant using `expand_grid()`\n\n2. Produce predicted values with confidence intervals from your regression model using the `predict()` function\n\n3. Bind those predictions and CIs to the orginal prediction dataframe using `cbind()`\n\n4. Produce a figure using `ggplot()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# # Predictors for m2\n# pred_dfm2 <- expand_grid(\n#   age = seq(min(df$age, na.rm =T), max(df$age, na.rm = T)),\n#   race_5cat = sort(unique(df$race_5cat))\n# )\n# \n# # Predictions with confidence intervals\n# pred_dfm2 <- cbind(\n#   pred_dfm2,\n#   predict(m2, newdata = pred_dfm2, interval = \"confidence\")$fit\n# )\n# \n# # Plot predictions from m2\n# \n# fig_m2 <- pred_dfm2 %>% \n#   ggplot(aes(age, fit, col = race_5cat))+\n#   geom_ribbon(aes(ymin = lwr, ymax = upr, \n#     fill = race_5cat\n#     ),\n#     alpha = .5)+\n#   geom_line()+\n#   facet_wrap( ~ race_5cat)+\n#   theme_minimal()+\n#   guides(\n#     col = \"none\",\n#     fill = \"none\"\n#   )+\n#   labs(\n#     y = \"Predicted Vote Choice\",\n#     title = \"Support for Trump by Age and Race\"\n#   )\n# \n# # Display figure\n# fig_m2\n# \n# # Predictors for m3\n# pred_dfm3 <- expand_grid(\n#   age = seq(min(df$age, na.rm =T), max(df$age, na.rm = T)),\n#   race_5cat = sort(unique(df$race_5cat)),\n#   partyid = mean(df$partyid, na.rm=T)\n# )\n# \n# # Predictions with confidence intervals\n# pred_dfm3 <- cbind(\n#   pred_dfm3,\n#   predict(m3, newdata = pred_dfm3, interval = \"confidence\")$fit\n# )\n# \n# # Plot predictions from m2\n# \n# fig_m3 <- pred_dfm3 %>% \n#   ggplot(aes(age, fit, col = race_5cat))+\n#   geom_ribbon(aes(ymin = lwr, ymax = upr, \n#     fill = race_5cat\n#     ),\n#     alpha = .5)+\n#   geom_line()+\n#   facet_wrap( ~ race_5cat)+\n#   theme_minimal()+\n#   guides(\n#     col = \"none\",\n#     fill = \"none\"\n#   )+\n#   labs(\n#     y = \"Predicted Vote Choice\",\n#     title = \"Support for Trump by Age and Race Controlling for Partisanship\"\n#   )\n# \n# fig_m3\n```\n:::\n\n\nPlease produce at least one figure showing predicted values from at least one of your models\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a prediction data frame\n\n# Bind predicted values to prediction data frame\n\n# Produce Figure\n\n# Dispaly figure\n```\n:::\n\n\n\n## Interperet results\n\nHere is my interpretation of the models:\n\n**ME:** Our baseline model confirms our initial expectations. Controlling for race, older respondents have higher predicted levels of support for Trump by 0.002 percentage points. Controlling for race, the model predicts that a 60 year old respondent is about 6.3 percentage points more likely to vote for Trump than a 30 year-old respondent. The test statistic for this coefficient is 3.10 corresponding to a p-value < 0.05, suggesting that if there were no relationship between age and vote choice in this model, it would be very unlikely that we observed a test statistic of this magnitude. Similarly the confidence interval for this estimate has suggests that coefficients as small as 0.0008 and as large as 0.0034 are plausible values for the relationship between age and vote choice in these data. Similarly, controlling for age, Black, Hispanic, and Asian respondents report significantly lower levels of support for Trump than white respondents (p < 0.05). \n\nTurning to the interaction model, we see that the magnitude of the coefficient on age (which corresponds to the marginal effect of age for white respondents) increases, while the coefficients on the interactions between age and racial indicators are generally negative, suggesting that the relationship between age and support for Trump is less strong for these racial and ethnic groups. Figure 1 helps clarify these marginal effects, as we see that slope for age is clearly positive for white respondents, clearly negative for Black respondents. The confidence intervals for the predicted values of the other racial and ethnic groups are generally wide, and consisent with positive, negative, or no relationship between age and vote choice.\n\nFinally, looking at the model controlling for partisanship, we see that none of the relationships between age, race, and vote choice, remain statistically significant once we account for the relationships between partisanship and vote choice, and the relationships between partisanship and age and race. In sum, apparent demographic differences in support for Trump appear driven by the differences in partisan identification across racial groups and within age groups.\n\n**YOU:**\n\n\n# Take the Class Survey {.unnumbered}\n\nPlease take a few moments to complete the [class survey](https://brown.co1.qualtrics.com/jfe/form/SV_9ZBz6W3H0yxo4rY){target=\"_blank\"} for this week.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}