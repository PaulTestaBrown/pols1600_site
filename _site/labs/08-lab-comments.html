<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="P.F. Testa">
<meta name="dcterms.date" content="2024-03-21">

<title>POLS 1600 - Comments for Lab 08 - Replicating Grumbach and Hill (2022):</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.32/datatables.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">POLS 1600</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../class/index.html"> 
<span class="menu-text">Class</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignments/index.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#goals" id="toc-goals" class="nav-link" data-scroll-target="#goals">Goals</a></li>
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow">Workflow</a>
  <ul class="collapse">
  <li><a href="#please-render-this-.qmd-file" id="toc-please-render-this-.qmd-file" class="nav-link" data-scroll-target="#please-render-this-.qmd-file">Please render this .qmd file</a></li>
  </ul></li>
  <li><a href="#get-set-up-to-work" id="toc-get-set-up-to-work" class="nav-link" data-scroll-target="#get-set-up-to-work">Get set up to work</a>
  <ul class="collapse">
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">Load packages</a></li>
  </ul></li>
  <li><a href="#set-your-working-directory-and-load-the-data" id="toc-set-your-working-directory-and-load-the-data" class="nav-link" data-scroll-target="#set-your-working-directory-and-load-the-data"><span class="header-section-number">1</span> Set your working directory and load the data</a></li>
  <li><a href="#create-additional-variables" id="toc-create-additional-variables" class="nav-link" data-scroll-target="#create-additional-variables"><span class="header-section-number">2</span> Create additional variables</a></li>
  <li><a href="#describing-variation-in-voting-by-state-year-policy-and-age" id="toc-describing-variation-in-voting-by-state-year-policy-and-age" class="nav-link" data-scroll-target="#describing-variation-in-voting-by-state-year-policy-and-age"><span class="header-section-number">3</span> Describing variation in voting by state, year, policy, and age</a>
  <ul class="collapse">
  <li><a href="#variation-by-state" id="toc-variation-by-state" class="nav-link" data-scroll-target="#variation-by-state"><span class="header-section-number">3.1</span> Variation by state</a></li>
  <li><a href="#variation-over-time" id="toc-variation-over-time" class="nav-link" data-scroll-target="#variation-over-time"><span class="header-section-number">3.2</span> Variation over time</a></li>
  <li><a href="#across-policy-and-age-for-single-state" id="toc-across-policy-and-age-for-single-state" class="nav-link" data-scroll-target="#across-policy-and-age-for-single-state"><span class="header-section-number">3.3</span> Across policy and age for single state</a></li>
  <li><a href="#describe-your-results" id="toc-describe-your-results" class="nav-link" data-scroll-target="#describe-your-results"><span class="header-section-number">3.4</span> Describe your results</a></li>
  </ul></li>
  <li><a href="#understanding-two-way-fixed-effects-regression" id="toc-understanding-two-way-fixed-effects-regression" class="nav-link" data-scroll-target="#understanding-two-way-fixed-effects-regression"><span class="header-section-number">4</span> Understanding Two-Way Fixed Effects Regression</a>
  <ul class="collapse">
  <li><a href="#estimate-the-models" id="toc-estimate-the-models" class="nav-link" data-scroll-target="#estimate-the-models"><span class="header-section-number">4.1</span> Estimate the models</a></li>
  <li><a href="#present-and-interpret-the-results" id="toc-present-and-interpret-the-results" class="nav-link" data-scroll-target="#present-and-interpret-the-results"><span class="header-section-number">4.2</span> Present and interpret the results</a></li>
  </ul></li>
  <li><a href="#replicate-two-models-from-figure-3" id="toc-replicate-two-models-from-figure-3" class="nav-link" data-scroll-target="#replicate-two-models-from-figure-3"><span class="header-section-number">5</span> Replicate two models from Figure 3</a>
  <ul class="collapse">
  <li><a href="#estimate-the-models-1" id="toc-estimate-the-models-1" class="nav-link" data-scroll-target="#estimate-the-models-1"><span class="header-section-number">5.1</span> Estimate the models</a></li>
  <li><a href="#present-the-results" id="toc-present-the-results" class="nav-link" data-scroll-target="#present-the-results"><span class="header-section-number">5.2</span> Present the results</a></li>
  </ul></li>
  <li><a href="#recreate-figure-3" id="toc-recreate-figure-3" class="nav-link" data-scroll-target="#recreate-figure-3"><span class="header-section-number">6</span> Recreate Figure 3</a>
  <ul class="collapse">
  <li><a href="#calculate-marginal-effects-of-interactions" id="toc-calculate-marginal-effects-of-interactions" class="nav-link" data-scroll-target="#calculate-marginal-effects-of-interactions"><span class="header-section-number">6.1</span> Calculate Marginal Effects of Interactions</a></li>
  <li><a href="#recreate-figure-3-1" id="toc-recreate-figure-3-1" class="nav-link" data-scroll-target="#recreate-figure-3-1"><span class="header-section-number">6.2</span> Recreate Figure 3</a></li>
  <li><a href="#compare-your-figure-to-figure-3-from-the-text" id="toc-compare-your-figure-to-figure-3-from-the-text" class="nav-link" data-scroll-target="#compare-your-figure-to-figure-3-from-the-text"><span class="header-section-number">6.3</span> Compare your figure to Figure 3 from the text</a></li>
  </ul></li>
  <li><a href="#take-the-class-survey" id="toc-take-the-class-survey" class="nav-link" data-scroll-target="#take-the-class-survey">Take the Class Survey</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Comments for Lab 08 - Replicating Grumbach and Hill (2022):</h1>
<p class="subtitle lead">Reproducing the results</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>P.F. Testa </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 21, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level1 unnumbered">
<h1 class="unnumbered">Overview</h1>
<p>In this lab, we continue our replication of <a href="https://www.journals.uchicago.edu/doi/full/10.1086/714776">Grumbach and Hill (2021)</a> “Rock the Registration: Same Day Registration Increases Turnout of Young Voters.”</p>
<p>To accomplish this we will:</p>
<ol start="0" type="1">
<li><p>Load packages. (5 minutes)</p></li>
<li><p><strong>Set working directory and load the data</strong> from last class. (5 minutes)</p></li>
<li><p>Do some additional <strong>recoding</strong> (5 minutes)</p></li>
<li><p><strong>Describe</strong> variation in voting by state, year, policy, and age (20 minutes)</p></li>
<li><p><strong>Estimate</strong> four regression models to understand <strong>fixed effects</strong> and <strong>cluster robust standard errors</strong> (20 minutes)</p></li>
<li><p><strong>Replicate</strong> two regression models from Grumbach and Hill (2021) <strong>interacting</strong> <code>sdr</code> with <code>age_group</code> (10 minutes)</p></li>
<li><p><strong>Recreate</strong> a portion of Figure 3 showing the <strong>marginal effect</strong> of <code>sdr</code> by age group. (15 minutes)</p></li>
</ol>
<p>Finally, we’ll take the survey for this week</p>
<p>One of these 6 tasks will be randomly selected as the graded question for the lab.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3212024</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>graded_question <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Question"</span>,graded_question,<span class="st">"is the graded question for this week"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Question 2 is the graded question for this week"</code></pre>
</div>
</div>
<p>You will work in your assigned groups. Only one member of each group needs to submit the html file of lab.</p>
<p>This lab <strong>must</strong> contain the names of the group members in attendance.</p>
<p>If you are attending remotely, you will submit your labs individually.</p>
<p>Here are your assigned groups for the semester.</p>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c5c38bb38cd6d29a6e24" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c5c38bb38cd6d29a6e24">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8"],["Group 1","Group 2","Group 3","Group 4","Group 5","Group 6","Group 7","Group 8"],["Maia Eng","Andrew Rovinsky","Serafym Rybachkivskyi","Tiffany Eddy","Christopher Maron","Mia Hamilton","Mariana Melzer","Logan Szittai"],["Guadalupe Herrera","Spencer Lorin","Rachel Kim","Daniel Solomon","Daniel Baker","Emily Colon","Kahrie Langham","Keiley Thompson"],["Stephen Robinson","Lucinda Anderson","Kai Blades","Zoe Smith","Neve Diaz-Carr","Davis Kelly","Shannon Feerick-Hillenbrand","Lydell Dyer"],["Jeremiah Harrington","Serenity Hamilton","Emma Coleman","Lorena Calderon","Olivia Hanley","Talia Levine","Jarret Fernandes","Mahir Arora"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Group<\/th>\n      <th>1<\/th>\n      <th>2<\/th>\n      <th>3<\/th>\n      <th>4<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Group","targets":1},{"name":"1","targets":2},{"name":"2","targets":3},{"name":"3","targets":4},{"name":"4","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="goals" class="level1 unnumbered">
<h1 class="unnumbered">Goals</h1>
<p>This week’s lab will give you practice:</p>
<ul>
<li><p>Loading data from your own computers (Q1)</p></li>
<li><p>Data wrangling with conditional logic (Q2)</p></li>
<li><p>Describing variation to help illustrate the motivation behind fixed effects regression (Q3)</p></li>
<li><p>Using <code>lm_robust()</code> to easily estimate models with fixed effects and robust clustered standard errors (Q4)</p></li>
<li><p>Estimating and interpreting interaction models (Q5-6) to test conditional claims (like does the effect of Same Day Registration vary across age cohorts)</p></li>
</ul>
</section>
<section id="workflow" class="level1 unnumbered">
<h1 class="unnumbered">Workflow</h1>
<section id="please-render-this-.qmd-file" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="please-render-this-.qmd-file">Please render this .qmd file</h2>
<p>As with every lab, you should:</p>
<ul>
<li>Download the file</li>
<li>Save it in your course folder</li>
<li><strong>Update the <code>author:</code> section of the YAML header to include the names of your group members in attendance.</strong></li>
<li>Render the document</li>
<li>Open the html file in your browser (Easier to read)</li>
<li>Write your code in the <strong>chunks provided under each section</strong></li>
<li>Comment out or delete any test code you do not need</li>
<li><strong>Render the document again after completing a section or chunk</strong> (Error checking)</li>
<li>Upload the final lab to <a href="https://canvas.brown.edu/courses/1094972/assignments" target="_blank">Canvas</a>.</li>
</ul>
</section>
</section>
<section id="get-set-up-to-work" class="level1 unnumbered">
<h1 class="unnumbered">Get set up to work</h1>
<section id="load-packages" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="load-packages">Load packages</h2>
<p>As always, let’s load the packages we’ll need for today</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>the_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## R Markdown</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kableExtra"</span>,<span class="st">"DT"</span>,<span class="st">"texreg"</span>,<span class="st">"htmltools"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Tidyverse</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyverse"</span>, <span class="st">"lubridate"</span>, <span class="st">"forcats"</span>, <span class="st">"haven"</span>, <span class="st">"labelled"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Extensions for ggplot</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ggmap"</span>,<span class="st">"ggrepel"</span>, <span class="st">"ggridges"</span>, <span class="st">"ggthemes"</span>, <span class="st">"ggpubr"</span>, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GGally"</span>, <span class="st">"scales"</span>, <span class="st">"dagitty"</span>, <span class="st">"ggdag"</span>, <span class="st">"ggforce"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"COVID19"</span>,<span class="st">"maps"</span>,<span class="st">"mapdata"</span>,<span class="st">"qss"</span>,<span class="st">"tidycensus"</span>, <span class="st">"dataverse"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"janitor"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Analysis</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DeclareDesign"</span>, <span class="st">"easystats"</span>, <span class="st">"zoo"</span>,<span class="st">"margins"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"modelsummary"</span>, <span class="st">"ggeffects"</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to load packages</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>ipak <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">"Package"</span>])]</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(new.pkg)) </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ipak</span>(the_packages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   kableExtra            DT        texreg     htmltools     tidyverse 
         TRUE          TRUE          TRUE          TRUE          TRUE 
    lubridate       forcats         haven      labelled         ggmap 
         TRUE          TRUE          TRUE          TRUE          TRUE 
      ggrepel      ggridges      ggthemes        ggpubr        GGally 
         TRUE          TRUE          TRUE          TRUE          TRUE 
       scales       dagitty         ggdag       ggforce       COVID19 
         TRUE          TRUE          TRUE          TRUE          TRUE 
         maps       mapdata           qss    tidycensus     dataverse 
         TRUE          TRUE          TRUE          TRUE          TRUE 
      janitor DeclareDesign     easystats           zoo       margins 
         TRUE          TRUE          TRUE          TRUE          TRUE 
 modelsummary     ggeffects 
         TRUE          TRUE </code></pre>
</div>
</div>
</section>
</section>
<section id="set-your-working-directory-and-load-the-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Set your working directory and load the data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set working directory to source file location</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data (assumes a file called `cps_clean.rda` is in the same folder as this lab)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # BACKUP: Uncomment if you're having trouble you can load a version of the data from the web:</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://pols1600.paultesta.org/files/data/cps_clean.rda"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-additional-variables" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Create additional variables</h1>
<p>The following code <strong>relevels</strong> the factor variable <code>age_group</code> so that “65+” is the first level of the factor.</p>
<p>When <code>lm()</code> converts <code>age_group</code> to indicators for each in level of the factor, it’s excludes the first level, which becomes the <code>reference category</code> described by the intercept, <span class="math inline">\(\beta_0\)</span> in the model.</p>
<p><strong>Please create the following additional variables, that will be useful for presenting and visualizing data:</strong></p>
<ul>
<li><code>election_type</code> a categorical variable takes a value of “Presidential” when <code>year</code> is a presidential election, and a value of “Midterm” otherwise</li>
<li><code>SDR</code> a categorical variable that takes a value of “SDR” when <code>sdr == 1</code> and 0 otherwise (you may already have this in your data)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>presidential_elections <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1980</span>, <span class="dv">2016</span>, <span class="at">by =</span> <span class="dv">4</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>cps <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">fct_relevel</span>(age_group, <span class="st">"65+"</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SDR =</span> <span class="fu">ifelse</span>(sdr <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"SDR"</span>,<span class="st">"non-SDR"</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">election_type =</span> <span class="fu">ifelse</span>(year <span class="sc">%in%</span> presidential_elections, <span class="st">"General"</span>,<span class="st">"Midterm"</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> cps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="describing-variation-in-voting-by-state-year-policy-and-age" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Describing variation in voting by state, year, policy, and age</h1>
<section id="variation-by-state" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="variation-by-state"><span class="header-section-number">3.1</span> Variation by state</h2>
<p>Create a figure that shows how average turnout varies across state in the <code>cps</code> data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of average voting rates by state</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cps <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(st) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">turnout =</span> <span class="fu">mean</span>(dv_voted, <span class="at">na.rm=</span>T)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">st =</span> <span class="fu">fct_reorder</span>(st, turnout)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="ot">-&gt;</span> df_state</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use data frame of state averages to produce figure</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>df_state <span class="sc">%&gt;%</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(turnout,st,<span class="at">fill=</span>turnout))<span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-lab-comments_files/figure-html/var_by_state-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="variation-over-time" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="variation-over-time"><span class="header-section-number">3.2</span> Variation over time</h2>
<p>Create a figure that shows how turnout varies across time.</p>
<p>Calculate the <code>year</code>ly averages separately by <code>election_type</code>. Facet your plot by <code>election_type</code> using <code>facet_wrap(~election_type)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate yearly averages in turnout by election type</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>cps <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, election_type ) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">turnout =</span> <span class="fu">mean</span>(dv_voted, <span class="at">na.rm=</span>T)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> df_year</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display variation in turnout by year for Presidential And Midterm Elections</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>df_year <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, turnout, <span class="at">col=</span>election_type)) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>election_type)<span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-lab-comments_files/figure-html/var_by_year-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="across-policy-and-age-for-single-state" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="across-policy-and-age-for-single-state"><span class="header-section-number">3.3</span> Across policy and age for single state</h2>
<p>For a single state (you pick) that implemented SDR registration at some point between 1978 and 2018, plot the average turnout by <code>age_group</code> before and after the SDR</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a tricky one that is designed to test your data-wrangling skills.</p>
<ol type="1">
<li>Figure out which states adopted <code>sdr</code></li>
<li>Create a summary dataframe of average turnout by age for a single state using <code>filter()</code>, <code>group_by()</code> and <code>summarise()</code></li>
<li>Pipe this dataframe to <code>ggplot()</code> setting the appropriate aesthetics using <code>geom_point()</code> and <code>facet_grid()</code></li>
</ol>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For a chosen state, create a dataframe showing how turnout varies by year, age_group, and SDR</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># states that implement SDR</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>sdr_states <span class="ot">&lt;-</span> <span class="fu">unique</span>(cps<span class="sc">$</span>st[cps<span class="sc">$</span>sdr <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>cps <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(st <span class="sc">%in%</span> sdr_states) <span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(st, year, SDR, age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">turnout =</span> <span class="fu">mean</span>(dv_voted,<span class="at">na.rm=</span>T)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> sdr_age_df</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure: Turnout by age group before and after SDR</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>sdr_age_df <span class="sc">%&gt;%</span> </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age_group)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(st <span class="sc">==</span> <span class="st">"NH"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Relevel age_group so 18-24 comes first for this fig</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(age_group))</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, turnout, <span class="at">col =</span> SDR))<span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate conditional means by SDR using lm</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y~1"</span>)<span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> age_group)<span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-lab-comments_files/figure-html/var_by_policy_age-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="describe-your-results" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="describe-your-results"><span class="header-section-number">3.4</span> Describe your results</h2>
<p>In a few sentences, explain to your reader what these figures tell us about the data:</p>
<p>First there is considerable variation in average rates of turnout across states. For example, across the years considered, the average turnout rate in West Virginia (a state which never implemented Same Day Registration) was about 46.8 percent among CPS respondents, while the average turnout rate in Minnesota (a state which had SDR for the entire period) was more than 20 percentage points higher (68.2 percent).</p>
<p>Second, there is also considerable variation in turnout across election years. Turnout in presidential elections is much higher than turnout in midterm elections. From one presidential or midterm election to the next, turnout rates can swing by as much as 10 percentage points. There does not seem to be a clear trend in turnout over time in these data.</p>
<p>As for variation in turnout by age before and after SDR, your interpretations depend on which state you chose. In states like New Hampshire or North Carolina, turnout seems markedly higher among young folks after the states adopted SDR.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> In states like Illinois or Wyoming, there doesn’t appear to be much of a difference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional code to help me describe these figures</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_state <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(turnout <span class="sc">==</span> <span class="fu">min</span>(turnout) <span class="sc">|</span> turnout <span class="sc">==</span> <span class="fu">max</span>(turnout))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  st    turnout
  &lt;fct&gt;   &lt;dbl&gt;
1 MN      0.682
2 WV      0.468</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df_year <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(election_type) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">swing =</span> <span class="fu">abs</span>(turnout <span class="sc">-</span> <span class="fu">lag</span>(turnout))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(turnout),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_swing =</span> <span class="fu">max</span>(swing, <span class="at">na.rm=</span>T)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  election_type     sd max_swing
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
1 General       0.0293    0.0945
2 Midterm       0.0287    0.102 </code></pre>
</div>
</div>
<p>Here’s the turnout by age plot for North Carolina</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sdr_age_df <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age_group)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(st <span class="sc">==</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(age_group))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, turnout, <span class="at">col =</span> SDR))<span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y~1"</span>)<span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> age_group)<span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-lab-comments_files/figure-html/figNC-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here’s the same plot for Illinois</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sdr_age_df <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age_group)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(st <span class="sc">==</span> <span class="st">"IL"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(age_group))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, turnout, <span class="at">col =</span> SDR))<span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y~1"</span>)<span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> age_group)<span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-lab-comments_files/figure-html/figIL-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>And here is a plot of the average turnout rates among 18-24 year olds over time in the 18 states that adopted SDR at some point between 1978-2018</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sdr_age_df <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age_group <span class="sc">==</span> <span class="st">"18-24"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, turnout, <span class="at">col =</span> SDR))<span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y~1"</span>, <span class="at">se =</span> F)<span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>st , <span class="at">ncol =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-lab-comments_files/figure-html/fig18_24-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="understanding-two-way-fixed-effects-regression" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Understanding Two-Way Fixed Effects Regression</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Interesting, so there appears to be considerable variation in turnout across states and over time. Further, depending on which state you looked at you may have found evidence of differences in turnout by age group before and after SDR that either support or challenge Grumbach’s main claims.</p>
<p>In this question, we’ll see how we can use <strong>fixed effects</strong> to try and account for variation across states and years to <strong>isolate</strong> the effect of same day registration on turnout.</p>
<p>We will also see how using <strong>robust standard errors</strong> with and without clustering changes our interpretations of the significance of our results.</p>
</div>
</div>
<p>In this question you will estimate <strong>four</strong> increasingly complex models using <code>lm_robust()</code> and explain how each subsequent model differs from the preceding model.</p>
<ol type="1">
<li><p>A <strong>simple linear model</strong>, <code>m1</code> akin to what <code>lm()</code> produces modelling turnout (<code>dv_voted</code>) as a function of same day registration (<code>sdr</code>)</p></li>
<li><p>A simple linear model, <code>m2</code> with standard errors that are <strong>robust to heteroskedasticity</strong> (i.e.&nbsp;non-constant error variance) by setting the <code>lm_robust()</code> argument: <code>se_type = "stata"</code></p></li>
<li><p>A two-way fixed effects model, <code>m3</code>, with <strong>fixed effects</strong> for <code>st</code>ate and <code>year</code> using <code>lm_robust()</code> argument: <code>fixed_effects = ~ st + year</code> and <strong>robust standard errors</strong> using the same argument as <code>m2</code></p></li>
<li><p>A two-way fixed effects model, <code>m3</code>, with fixed effects for <code>st</code>ate and <code>year</code> using <code>lm_robust()</code> argument: <code>fixed_effects = ~ st + year</code> <strong>AND</strong> robust standard errors <strong>clustered by state</strong> using the argument: <code>clusters = st</code></p></li>
</ol>
<section id="estimate-the-models" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="estimate-the-models"><span class="header-section-number">4.1</span> Estimate the models</h2>
<p>I’ve gotten you started with <code>m1</code> Use that code as a template to estimate <code>m2</code>, <code>m3</code>, and <code>m4</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- m1: Simple OLS regression ----</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(dv_voted <span class="sc">~</span> sdr, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> cps,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">se_type =</span> <span class="st">"classical"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">try_cholesky =</span> T)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- m2: Simple OLS with robust standard errors ----</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(dv_voted <span class="sc">~</span> sdr, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> cps,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">se_type =</span> <span class="st">"stata"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">try_cholesky =</span> T)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- m3: Two-way Fixed Effects for State and Year ----</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(dv_voted <span class="sc">~</span> sdr,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> cps,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">fixed_effects =</span> <span class="sc">~</span> st <span class="sc">+</span> year,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">se_type =</span> <span class="st">"stata"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">try_cholesky =</span> T)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- m4: TWFE for State and Year and cluster robust SEs ----</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(dv_voted <span class="sc">~</span> sdr,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> cps,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">fixed_effects =</span> <span class="sc">~</span> st <span class="sc">+</span> year,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">se_type =</span> <span class="st">"stata"</span>,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">clusters =</span> st,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">try_cholesky =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="present-and-interpret-the-results" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="present-and-interpret-the-results"><span class="header-section-number">4.2</span> Present and interpret the results</h2>
<p>When you’ve completed the previous section, you should be able uncomment and run the following code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">htmlreg</span>(<span class="at">l =</span> <span class="fu">list</span>(m1,m2,m3, m4),</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">5</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">include.ci =</span> F,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span> <span class="fu">HTML</span>() <span class="sc">%&gt;%</span> <span class="fu">browsable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="texreg table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Statistical models</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">&nbsp;</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">Model 1</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">Model 2</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">Model 3</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">Model 4</th>
</tr>
</thead>
<tbody>
<tr class="odd" style="border-top: 1px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">(Intercept)</td>
<td style="padding-left: 5px; padding-right: 5px">0.54787<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.54787<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.00037)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.00038)</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">sdr</td>
<td style="padding-left: 5px; padding-right: 5px">0.06159<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.06159<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.00671<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.00671</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.00110)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.00108)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.00185)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.01405)</td>
</tr>
<tr class="odd" style="border-top: 1px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">R<sup>2</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.00157</td>
<td style="padding-left: 5px; padding-right: 5px">0.00157</td>
<td style="padding-left: 5px; padding-right: 5px">0.02845</td>
<td style="padding-left: 5px; padding-right: 5px">0.02845</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">Adj. R<sup>2</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.00157</td>
<td style="padding-left: 5px; padding-right: 5px">0.00157</td>
<td style="padding-left: 5px; padding-right: 5px">0.02841</td>
<td style="padding-left: 5px; padding-right: 5px">0.02841</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">Num. obs.</td>
<td style="padding-left: 5px; padding-right: 5px">1988501</td>
<td style="padding-left: 5px; padding-right: 5px">1988501</td>
<td style="padding-left: 5px; padding-right: 5px">1988501</td>
<td style="padding-left: 5px; padding-right: 5px">1988501</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">RMSE</td>
<td style="padding-left: 5px; padding-right: 5px">0.49658</td>
<td style="padding-left: 5px; padding-right: 5px">0.49658</td>
<td style="padding-left: 5px; padding-right: 5px">0.48986</td>
<td style="padding-left: 5px; padding-right: 5px">0.48986</td>
</tr>
<tr class="odd" style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">N Clusters</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">49</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td colspan="5" style="font-size: 0.8em"><sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05</td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
<p><strong>Please write a few sentences</strong> explaining how the coefficient on <code>sdr</code> and it’s standard error changes across the four models. I’ll get you started:</p>
<p>The table presents the results of four regression models. The outcome in each model is a binary indicator of whether respondents to the CPS voted in a given election. The key predictor of interest in each model is the coefficient for <code>sdr</code> which corresponds the model’s predicted difference in turnout in states that had same day registration compared to states that did not. Model 1 presents the results from a simple linear regression assuming homoskedastic errors (i.e.&nbsp;constant error variance). The coefficient on <code>sdr</code> of 0.062 implies that this model predicts turnout will be higher by 6.2 percentage points in states with Same Day Registration. The standard error of 0.00110 is small relative to the coefficient, which as we will see in two weeks implies a <em>statistically significant</em> relationship.</p>
<p>Model 2 presents the same specification, but uses robust standard errors that allow for non-constant (heteroskedastic) error variance. The coefficient on <code>sdr</code> is exactly the same as Model 1, and the standard error is similar to the ten-thousandth decimal place. In short, simply including robust standard errors does little to change our substantive interpretation.</p>
<p>Model 3 includes fixed effects of state and year. Specifically, <code>lm_robust()</code> uses the <a href="https://en.wikipedia.org/wiki/Fixed_effects_model#Fixed_effects_estimator">within-in</a> transformation via the <a href="https://www.ams.org/journals/jams/2002-15-03/S0894-0347-02-00398-3/S0894-0347-02-00398-3.pdf">method of alternating projections</a>, subtracting off the state and year level means of the predictors and outcomes before estimating the regression. This transformation is equivalent to including indicator variables to represent the various levels of each fixed effect (e.g.&nbsp;including year and st as factor variables in the model). That latter, sometimes called the dummy variable approach, is more computationally intensive (if there are lots of levels to the fixed effect, the matrices involved in the calculation get very large), but as the code below demonstrates, they all yield the same estimates and standard errors (although there are some additional degrees of freedom adjustments that <code>lm_robust()</code> performs, which we are not when we calculate the within transformations by hand)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kludge-y method of alternating projections....</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cps <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only use observations from m3</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dv_voted), <span class="sc">!</span><span class="fu">is.na</span>(sdr)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(st) <span class="sc">%&gt;%</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Within transformation by states</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">dv_voted_within =</span> dv_voted <span class="sc">-</span> <span class="fu">mean</span>(dv_voted, <span class="at">na.rm=</span>T),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdr_within =</span> sdr <span class="sc">-</span> <span class="fu">mean</span>(sdr, <span class="at">na.rm=</span>T)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Within transformation by year</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">dv_voted_within =</span> dv_voted_within <span class="sc">-</span> <span class="fu">mean</span>(dv_voted_within, <span class="at">na.rm=</span>T),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdr_within =</span> sdr_within <span class="sc">-</span> <span class="fu">mean</span>(sdr_within,<span class="at">na.rm=</span>T)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Within transformation by year</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(st) <span class="sc">%&gt;%</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">dv_voted_within =</span> dv_voted_within <span class="sc">-</span> <span class="fu">mean</span>(dv_voted_within, <span class="at">na.rm=</span>T),</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdr_within =</span> sdr_within <span class="sc">-</span> <span class="fu">mean</span>(sdr_within,<span class="at">na.rm=</span>T)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">dv_voted_within =</span> dv_voted_within <span class="sc">-</span> <span class="fu">mean</span>(dv_voted_within, <span class="at">na.rm=</span>T),</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdr_within =</span> sdr_within <span class="sc">-</span> <span class="fu">mean</span>(sdr_within,<span class="at">na.rm=</span>T)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(st) <span class="sc">%&gt;%</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">dv_voted_within =</span> dv_voted_within <span class="sc">-</span> <span class="fu">mean</span>(dv_voted_within, <span class="at">na.rm=</span>T),</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdr_within =</span> sdr_within <span class="sc">-</span> <span class="fu">mean</span>(sdr_within,<span class="at">na.rm=</span>T)</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">dv_voted_within =</span> dv_voted_within <span class="sc">-</span> <span class="fu">mean</span>(dv_voted_within, <span class="at">na.rm=</span>T),</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdr_within =</span> sdr_within <span class="sc">-</span> <span class="fu">mean</span>(sdr_within,<span class="at">na.rm=</span>T)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()<span class="ot">-&gt;</span> cps</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>start_time_m3_within  <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>m3_within <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(dv_voted_within <span class="sc">~</span> sdr_within, </span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>                       cps,</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">se_type =</span> <span class="st">"stata"</span>,</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">try_cholesky =</span> T)</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>end_time_m3_within  <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>time_m3_within <span class="ot">&lt;-</span> <span class="fu">round</span>(end_time_m3_within <span class="sc">-</span> start_time_m3_within,<span class="dv">5</span>)</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>start_time_m3_indicator  <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>m3_indicator <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(dv_voted <span class="sc">~</span> sdr <span class="sc">+</span> <span class="fu">factor</span>(year) <span class="sc">+</span> <span class="fu">factor</span>(st),</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>                          cps,</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>                          <span class="at">se_type =</span> <span class="st">"stata"</span>,</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>                          <span class="at">try_cholesky =</span> T)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>end_time_m3_indicator  <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>time_m3_indicator <span class="ot">&lt;-</span> <span class="fu">round</span>(end_time_m3_indicator <span class="sc">-</span> start_time_m3_indicator,<span class="dv">5</span>)</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>time_m3_within</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 2.45665 secs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>time_m3_indicator</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 9.88044 secs</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">htmlreg</span>(<span class="fu">list</span>(m3, m3_within, m3_indicator),</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">omit.coef =</span> <span class="st">"factor|Intercept"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">5</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">include.ci =</span> F,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"lm_robust (within transformation)"</span>,<span class="st">"Within transformation by hand"</span>,<span class="st">"Indicator FE"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span> <span class="fu">HTML</span>() <span class="sc">%&gt;%</span> <span class="fu">browsable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="texreg table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Statistical models</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">&nbsp;</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">lm_robust (within transformation)</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">Within transformation by hand</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">Indicator FE</th>
</tr>
</thead>
<tbody>
<tr class="odd" style="border-top: 1px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">sdr</td>
<td style="padding-left: 5px; padding-right: 5px">0.00671<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.00671<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.00185)</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.00185)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">sdr_within</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.00671<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.00185)</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
</tr>
<tr class="odd" style="border-top: 1px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">R<sup>2</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.02845</td>
<td style="padding-left: 5px; padding-right: 5px">0.00001</td>
<td style="padding-left: 5px; padding-right: 5px">0.02845</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">Adj. R<sup>2</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.02841</td>
<td style="padding-left: 5px; padding-right: 5px">0.00001</td>
<td style="padding-left: 5px; padding-right: 5px">0.02841</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">Num. obs.</td>
<td style="padding-left: 5px; padding-right: 5px">1988501</td>
<td style="padding-left: 5px; padding-right: 5px">1988501</td>
<td style="padding-left: 5px; padding-right: 5px">1988501</td>
</tr>
<tr class="even" style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">RMSE</td>
<td style="padding-left: 5px; padding-right: 5px">0.48986</td>
<td style="padding-left: 5px; padding-right: 5px">0.48985</td>
<td style="padding-left: 5px; padding-right: 5px">0.48986</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td colspan="4" style="font-size: 0.8em"><sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05</td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
<p>Finally, model 4 presents the results of a TWFE regression with fixed effects for state and year with robust standard errors clustered by state. The coefficient on <code>sdr</code> remains the same as in Model 3, predicting about 0.6 percentage points higher turnout in states with same day registration. We see, however, that once we relax the assumption that our errors are independent, and allow for correlations between observations from the same state, our uncertainty about this estimate (quantified by its standard error) increases 10-fold, and we are non longer confident that there is a statistically significant relationship between same day registration and voting in these data.</p>
<p>In sum, once we account for fixed differences across states and between time periods, and allow correlated errors between observations from the same state, variation in the presence of same day registration laws seems to explain relatively little variation in voting</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>So which model should we prefer? I would say the default approach of most social scientists is to prefer the <strong>most conservative</strong> estimate, which in this case corresponds to the results from model 4. We’d rather under claim than over claim. Since <strong>rarely if ever, do we <em>know</em> the right model</strong> , it’s generally common practice to report the results of <strong>multiple models</strong> with different specifications (as Grumbach and Hill do) as a way of <strong>demonstrating the robustness</strong> of ones’ results.</p>
</div>
</div>
</section>
</section>
<section id="replicate-two-models-from-figure-3" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Replicate two models from Figure 3</h1>
<p>Interesting. Once we account for fixed differences across states and between time periods and allow correlated errors between observations from the same state, variation in the presence of same day registration laws seems to explain relatively little variation in voting.</p>
<p>Grumbach and Hill, however, are interested in a different question, namely, <strong>whether the effects of same day registration vary by age.</strong></p>
<p>Grumbach and Hill test these claims using a regression model that interacts the <code>sdr</code> variable with indicators for the <code>age_group</code> of respondents.</p>
<p>The <strong>combination</strong> of the coefficient on <code>sdr</code> and the coefficient on the interaction of <code>sdr</code> with a specific age group indicator, tells us the predicted effect of <code>sdr</code> for respondents of that age group. In other words, it lets us assess whether same day registration is associated with more turnout among younger voters compared to older voters.</p>
<p>Formally, we we can describe these models using the following notation:</p>
<p><span class="math display">\[
y_{ist} = \beta_0 + \overbrace{\alpha_s}^{\text{FE State}} + \underbrace{\gamma_t}_{\text{FE Year}} + \overbrace{\beta_1sdr_{st}}^{\text{ME of SDR for 65+}} + \underbrace{\sum_{k = 18-14}^{k = 55-64}\beta_{k} sdr_{st}\times age_{ist}}_{\Delta \text{ in ME of SDR for Age }}  +\overbrace{X\beta}^{\text{Controls}}+\epsilon_{ist}
\]</span> And the quantities of interest for Grumbach and Hill’s claim are:</p>
<p><span class="math display">\[
\text{Marginal Effect of SDR for 65+} = \beta_1
\]</span> The marginal effects of the other age groups are defined by <span class="math inline">\(\beta_1\)</span>, the marginal effect of SDR for 65+, <strong>PLUS</strong> the coefficient on the interaction term between SDR and each age group indicator. So for 18-24 year olds the quantity of interest is the sum of:</p>
<p><span class="math display">\[
\text{Marginal Effect of SDR for 18-24} = \beta_1 + \beta_{sdr \times 18-24}
\]</span></p>
<p>For 25-34 year olds</p>
<p><span class="math display">\[
\text{Marginal Effect of SDR for 25-34} = \beta_1 + \beta_{sdr \times 25-34}
\]</span></p>
<p>And so on.</p>
<p>Please fit <strong>two models</strong> that <strong>interact</strong> the variable <code>sdr</code> with the variable <code>age_group</code>. Include fixed effects for <code>st</code>ate and <code>year</code>, and cluster your standard errors by <code>st</code>ate.</p>
<p>Call one model <code>m1gh</code> and only include the interaction between same day voting and age cohorts (<code>sdr*age_group</code>).</p>
<p>Call the second model <code>m2gh</code>. In addition to the interaction, include controls for:</p>
<ul>
<li><code>race</code> (as a <code>factor()</code> variable)</li>
<li><code>is_female</code></li>
<li><code>income</code></li>
<li><code>education</code></li>
</ul>
<section id="estimate-the-models-1" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="estimate-the-models-1"><span class="header-section-number">5.1</span> Estimate the models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>m1gh <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(dv_voted <span class="sc">~</span> sdr<span class="sc">*</span>age_group, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> cps,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fixed_effects =</span> <span class="sc">~</span> st <span class="sc">+</span> year,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">se_type =</span> <span class="st">"stata"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">clusters =</span> st,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">try_cholesky =</span> T</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>m2gh <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(dv_voted <span class="sc">~</span> sdr<span class="sc">*</span>age_group <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">factor</span>(race) <span class="sc">+</span> is_female <span class="sc">+</span> income <span class="sc">+</span> education, </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> cps,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fixed_effects =</span> <span class="sc">~</span> st <span class="sc">+</span> year,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">se_type =</span> <span class="st">"stata"</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">clusters =</span> st,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">try_cholesky =</span> T</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="present-the-results" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="present-the-results"><span class="header-section-number">5.2</span> Present the results</h2>
<p>Please present the results in a regression table.</p>
<p>Once you’ve estimated the models, you can just uncomment the code below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">htmlreg</span>(<span class="fu">list</span>(m1gh, m2gh), </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">include.ci =</span> F) <span class="sc">%&gt;%</span> <span class="fu">HTML</span>() <span class="sc">%&gt;%</span> <span class="fu">browsable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="texreg table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Statistical models</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">&nbsp;</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">Model 1</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">Model 2</th>
</tr>
</thead>
<tbody>
<tr class="odd" style="border-top: 1px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">sdr</td>
<td style="padding-left: 5px; padding-right: 5px">0.0120</td>
<td style="padding-left: 5px; padding-right: 5px">0.0004</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0162)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0128)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">age_group18-24</td>
<td style="padding-left: 5px; padding-right: 5px">-0.3518<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">-0.4125<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0061)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0051)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">age_group25-34</td>
<td style="padding-left: 5px; padding-right: 5px">-0.2149<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">-0.3198<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0060)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0040)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">age_group35-44</td>
<td style="padding-left: 5px; padding-right: 5px">-0.1026<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">-0.2179<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0063)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0038)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">age_group45-54</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0431<sup>***</sup></td>
<td style="padding-left: 5px; padding-right: 5px">-0.1450<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0059)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0038)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">age_group55-64</td>
<td style="padding-left: 5px; padding-right: 5px">0.0064</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0642<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0047)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0036)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">sdr:age_group18-24</td>
<td style="padding-left: 5px; padding-right: 5px">0.0142</td>
<td style="padding-left: 5px; padding-right: 5px">0.0472<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0108)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0081)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">sdr:age_group25-34</td>
<td style="padding-left: 5px; padding-right: 5px">0.0003</td>
<td style="padding-left: 5px; padding-right: 5px">0.0219<sup>**</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0137)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0076)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">sdr:age_group35-44</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0142</td>
<td style="padding-left: 5px; padding-right: 5px">0.0074</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0162)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0087)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">sdr:age_group45-54</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0147</td>
<td style="padding-left: 5px; padding-right: 5px">0.0001</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0120)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0068)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">sdr:age_group55-64</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0149</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0108</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0096)</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0062)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)200</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.0518<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0081)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)300</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0548<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0118)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)650</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.1619<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0305)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)651</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.1784<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0090)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)652</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.1277<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0188)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)700</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0916<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0236)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)801</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.0130</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0110)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)802</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0233<sup>*</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0097)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)803</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0406</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0277)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)804</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0566</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0403)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)805</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.0548</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0291)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)806</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0432</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0520)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)807</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0486</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0574)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)808</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0593</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0473)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)809</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.1125<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0271)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)810</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.0169</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0340)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)811</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0932</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.1396)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)812</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0474</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0891)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)813</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0445<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0076)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)814</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0316</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.1223)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)815</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.1124</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0601)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)816</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.2548</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.1910)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)817</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.1245</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.1979)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)818</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.8195<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0074)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)819</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.0831</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.1869)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)820</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.0325</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0592)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">factor(race)830</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">-0.1871<sup>**</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0667)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">is_female</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.0240<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0017)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">income</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.0093<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0002)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">education</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">0.0895<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.0016)</td>
</tr>
<tr class="odd" style="border-top: 1px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">R<sup>2</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.0864</td>
<td style="padding-left: 5px; padding-right: 5px">0.1707</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">Adj. R<sup>2</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.0864</td>
<td style="padding-left: 5px; padding-right: 5px">0.1706</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">Num. obs.</td>
<td style="padding-left: 5px; padding-right: 5px">1980510</td>
<td style="padding-left: 5px; padding-right: 5px">1616508</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">RMSE</td>
<td style="padding-left: 5px; padding-right: 5px">0.4748</td>
<td style="padding-left: 5px; padding-right: 5px">0.4515</td>
</tr>
<tr class="odd" style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">N Clusters</td>
<td style="padding-left: 5px; padding-right: 5px">49</td>
<td style="padding-left: 5px; padding-right: 5px">49</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td colspan="3" style="font-size: 0.8em"><sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05</td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
</section>
</section>
<section id="recreate-figure-3" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Recreate Figure 3</h1>
<p>Wuff. That’s a lot of coefficients to sort through.</p>
<p>Moreover, the question Grumbach and Hill are interested – how the marginal effect of same day registration varies by age – isn’t directly answered by any one coefficient in the the table.</p>
<p>That’s because the marginal effect of SDR (and it’s standard error) varies conditionally on the value of age group we’re looking at.</p>
<p>The comments to this lab contain a more formal discussion of the math behind this results. For right now, just know that to recreate Figure 3, we’ll need to add the coefficients on the interactions of <code>sdr</code> with <code>age_group</code> to the coefficient on <code>sdr</code> to get the marginal effects for each age group.</p>
<hr>
<p>More formally, we can think of the marginal effect of any variable in a multiple regression as the partial derivative of the outcome with respect to that variable. Depending on how much calculus we took, this is either relatively obvious, or completely confusing.</p>
<p>So below, when taking the partial derivative of <span class="math inline">\(y\)</span> with respect to <span class="math inline">\(x\)</span> <span class="math inline">\((\frac{\partial y}{\partial x})\)</span>, anything not involving an <span class="math inline">\(x\)</span> is treated as a constant and the partial derivative of a constant is 0. By the <a href="https://en.wikipedia.org/wiki/Power_rule">power rule</a>, the derivative of <span class="math inline">\(\beta_1 x\)</span> is 1, and so the marginal effect of x on y is <span class="math inline">\(\beta_1\)</span></p>
<p><span class="math display">\[
\begin{aligned}
y &amp;= \beta_0 + \beta_1 x +\beta_2z \\
\frac{\partial y}{\partial x} &amp;= 0 + \beta_1*(1) + 0\\
\frac{\partial y}{\partial x} &amp;= \beta_1
\end{aligned}
\]</span></p>
<p>Now consider a multiple regression with an interaction between two variables <span class="math inline">\(x\)</span> and <span class="math inline">\(z\)</span></p>
<p><span class="math display">\[
y = \beta_0 +\beta_1x +\beta_2 z + \beta_3 x*z
\]</span></p>
<p>Taking the partial derivative of y with respect to x <span class="math inline">\((\frac{\partial y}{\partial x})\)</span>, there are now two terms with <span class="math inline">\(x\)</span> in them:</p>
<p><span class="math display">\[
\begin{aligned}
y &amp;= \beta_0 +\beta_1x +\beta_2 z + \beta_3 x*z \\
\frac{\partial y}{\partial x} &amp;= 0 + \beta_1*(1) +0 + \beta_3*(1)*z\\
\frac{\partial y}{\partial x} &amp;= \beta_1 +\beta_3z
\end{aligned}
\]</span></p>
<p>And the marginal effect of <span class="math inline">\(x\)</span> now depends on value of <span class="math inline">\(z\)</span> at which we evaluate the model. Moreover, it can be shown for example in <a href="https://www.jstor.org/stable/25791835">Brambor Clark, and Golder 2006</a>, that the standard error of this marginal effect is a function of the variance and covariance of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_3\)</span> and the value of the conditioning term <span class="math inline">\(z\)</span></p>
<p><span class="math display">\[
\text{Var}(\frac{\partial y}{\partial x}) = \text{Var}(\beta_1) + z^2\text{Var}(\beta_3) + 2\times z \text{Cov}(\beta_1,\beta_3)
\]</span></p>
<section id="calculate-marginal-effects-of-interactions" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="calculate-marginal-effects-of-interactions"><span class="header-section-number">6.1</span> Calculate Marginal Effects of Interactions</h2>
<p>In the code below, I’ve written a <strong>custom function</strong> called <code>me_fn()</code> to calculate the <strong>marginal effects</strong> of Same Day Registration, a specific age cohort<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>The function returns a <span class="math inline">\(1\times 5\)</span> data frame with following columns</p>
<ul>
<li><code>Age</code> the Age for which we are evaluating the marginal effect of <code>sdr</code></li>
<li><code>Effect</code> the marginal effect in percentage points of predicted turnout of <code>sdr</code> conditional on <code>age_group</code> equaling the age cohort in <code>Age</code></li>
<li><code>SE</code> the standard error of this marginal effect</li>
<li><code>ll</code> the <strong>lower limit</strong> of a 95 percent <strong>confidence interval</strong> for our estimate</li>
<li><code>ul</code> the <strong>upper limit</strong> of a 95 percent <strong>confidence interval</strong> for our estimate</li>
</ul>
<p>We will talk in more detail about what a <strong>confidence interval</strong> is in two weeks. For now, you can think of this interval as a <strong>range of equally plausible values</strong> for the marginal effect of SDR at a given age cohort.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The heuristic for interpreting a confidence interval as a measure of statistical significance, is to ask:</p>
<blockquote class="blockquote">
<p>Is <strong>zero within</strong> the upper and lower <strong>limits of the confidence interval</strong>. If so, then the true estimate could be negative, or it could be positive, in which case, we conclude the estimate is <strong>not statistically significant</strong>.</p>
</blockquote>
</div>
</div>
<p>Please run the code below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Function to calculate marginal effect and SE of interactions ----</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>me_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, cohort, <span class="at">ci=</span><span class="fl">0.95</span>){</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confidence Level for CI</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>ci</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Age (Always one for indicator of specific cohort)</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  age <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variance Covariance Matrix from Model</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  cov <span class="ot">&lt;-</span> <span class="fu">vcov</span>(mod)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coefficient for SDR (Marginal Effect for reference category: 65+)</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod)[<span class="st">"sdr"</span>]</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If age is one of the interactions</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cohort <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"18-24"</span>,<span class="st">"25-34"</span>,<span class="st">"35-44"</span>,<span class="st">"45-54"</span>,<span class="st">"55-64"</span>)){</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get the name of the specific interaction</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    the_int <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"sdr:age_group"</span>,cohort,<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the coefficient on the interaction</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    b2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod)[the_int]</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate marginal effect for age cohort</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    me <span class="ot">&lt;-</span> b1 <span class="sc">+</span> b2<span class="sc">*</span>age</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    me_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(cov[<span class="st">"sdr"</span>,<span class="st">"sdr"</span>] <span class="sc">+</span> age<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>cov[the_int,the_int] <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>age<span class="sc">*</span>cov[<span class="st">"sdr"</span>,the_int])</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    ll <span class="ot">&lt;-</span> me <span class="sc">-</span> z<span class="sc">*</span>me_se</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    ul <span class="ot">&lt;-</span> me <span class="sc">+</span> z<span class="sc">*</span>me_se</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>cohort <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"18-24"</span>,<span class="st">"25-34"</span>,<span class="st">"35-44"</span>,<span class="st">"45-54"</span>,<span class="st">"55-64"</span>)){</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    me <span class="ot">&lt;-</span> b1 </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    me_se <span class="ot">&lt;-</span> mod<span class="sc">$</span>std.error[<span class="st">"sdr"</span>]</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>    ll <span class="ot">&lt;-</span> mod<span class="sc">$</span>conf.low[<span class="st">"sdr"</span>]</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    ul <span class="ot">&lt;-</span> mod<span class="sc">$</span>conf.high[<span class="st">"sdr"</span>]</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale results to be percentage points</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> cohort,</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effect =</span> me<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> me_se<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll =</span> ll<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">ul =</span> ul<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then uncomment the code below to create the data frame to produce a version of the coefficient plots from Grumbach and Hill’s Figure 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## List of age cohorts</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>the_age_groups <span class="ot">&lt;-</span> <span class="fu">levels</span>(cps<span class="sc">$</span>age_group)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 1: No controls</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate Marginal effect for each age cohort</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>the_age_groups <span class="sc">%&gt;%</span> </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">me_fn</span>(m1gh, <span class="at">cohort=</span>.)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels for plotting</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> <span class="fu">factor</span>(Age),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="st">"No controls"</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> fig3_no_controls</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 3: Controls for Education, Income, Race,and Sex </span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate Marginal effect for each age cohort</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>the_age_groups <span class="sc">%&gt;%</span> </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">me_fn</span>(m2gh, <span class="at">cohort=</span>.)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels for plotting</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> <span class="fu">factor</span>(Age),</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="st">"With controls"</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> fig3_controls</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine estimates into data frame for plotting</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>fig3_df <span class="ot">&lt;-</span> fig3_no_controls <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(fig3_controls)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Display results</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>fig3_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
   Age    Effect    SE     ll    ul Model        
   &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        
 1 65+    1.20    1.62 -2.06   4.47 No controls  
 2 18-24  2.63    1.60 -0.500  5.75 No controls  
 3 25-34  1.23    1.56 -1.83   4.29 No controls  
 4 35-44 -0.218   1.59 -3.33   2.89 No controls  
 5 45-54 -0.262   1.36 -2.93   2.40 No controls  
 6 55-64 -0.287   1.28 -2.80   2.22 No controls  
 7 65+    0.0382  1.28 -2.53   2.61 With controls
 8 18-24  4.76    1.61  1.60   7.91 With controls
 9 25-34  2.23    1.40 -0.510  4.97 With controls
10 35-44  0.778   1.39 -1.95   3.51 With controls
11 45-54  0.0440  1.28 -2.47   2.56 With controls
12 55-64 -1.04    1.19 -3.37   1.28 With controls</code></pre>
</div>
</div>
<hr>
<p>If you’re trying to understand the code above, it’s a equivalent to writing something like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">me_fn</span>(m1gh, <span class="at">cohort=</span><span class="st">"18-24"</span>),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">me_fn</span>(m1gh, <span class="at">cohort=</span><span class="st">"25-34"</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">me_fn</span>(m1gh, <span class="at">cohort=</span><span class="st">"35-44"</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">me_fn</span>(m1gh, <span class="at">cohort=</span><span class="st">"45-54"</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">me_fn</span>(m1gh, <span class="at">cohort=</span><span class="st">"55-64"</span>),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">me_fn</span>(m1gh, <span class="at">cohort=</span><span class="st">"65+"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> <span class="fu">factor</span>(Age),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="st">"No controls"</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Age   Effect    SE     ll    ul Model      
  &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      
1 18-24  2.63   1.60 -0.500  5.75 No controls
2 25-34  1.23   1.56 -1.83   4.29 No controls
3 35-44 -0.218  1.59 -3.33   2.89 No controls
4 45-54 -0.262  1.36 -2.93   2.40 No controls
5 55-64 -0.287  1.28 -2.80   2.22 No controls
6 65+    1.20   1.62 -2.06   4.47 No controls</code></pre>
</div>
</div>
<p>Using <code>map_df()</code> from the <code>purrr</code> package, simply lets us pipe the values of <code>age_group</code>, to the <code>cohort</code> argument of the <code>me_fn()</code> we defined above. <code>map_df()</code> then evaluates <code>me_fn()</code> for each value of the <code>the_age_groups</code> and returns a data frame with 6 rows corresponding to the marginal effects, standard errors, and confidence intervals for each age group.</p>
</section>
<section id="recreate-figure-3-1" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="recreate-figure-3-1"><span class="header-section-number">6.2</span> Recreate Figure 3</h2>
<p>Now we can recreate the first and second panels in the first column of Grumbach and Hill’s Figure 3.</p>
<p>In the code chunk below, pipe <code>fig3_df</code> into ggplot() and:</p>
<ul>
<li>Set the <code>x</code> aesthetic to <code>Age</code></li>
<li>Set the <code>y</code> aesthetic to <code>Effect</code></li>
<li>Add <code>geom_point()</code></li>
<li>Add <code>geom_linerange(aes(ymin = ll, ymax =ul))</code></li>
<li>Add <code>geom_hline(yintercept = 0)</code></li>
<li>Add a <code>facet_wrap(~Model)</code></li>
<li>Set the <code>theme</code> if you like</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fig3_df <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, Effect))<span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ll, <span class="at">ymax =</span>ul))<span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Model)<span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-lab-comments_files/figure-html/fig3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="compare-your-figure-to-figure-3-from-the-text" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="compare-your-figure-to-figure-3-from-the-text"><span class="header-section-number">6.3</span> Compare your figure to Figure 3 from the text</h2>
<p>Finally, <strong>write a few sentences</strong> comparing your results to those presented in Figure 3 of Grumbach and Hill.</p>
<p>Here’s a snapshot of the relevant panels of Figure 3 for reference:</p>
<p><img src="https://pols1600.paultesta.org/labs/images/08_fig3.png" class="img-fluid"></p>
<p>Please comment on the following:</p>
<ul>
<li><p>How does the size (magnitude) of the marginal effects for 18-24 year olds compare to those reported in Figure 3?</p></li>
<li><p>How would you interpret this marginal effect substantively?</p></li>
<li><p>Are any of the marginal effects in the model with no controls statistically significant?</p></li>
</ul>
<p>And if you’re interested, check out the comments for some further discussion about the differences between our replication and the published results.</p>
<hr>
<p>So, I would say that the general constellation of results is similar to those in reported in the first two rows of the first column of Figure 3, but with some noticeable differences.</p>
<p>As with Grumbach and Hill’s Figure 3, the size of the marginal effect of SDR is generally largest for respondents in the 18-24-year-old age cohort. The model with no controls predicts that turnout among young folks will be about 2.6 percentage points higher in states with SDR. Including demographic and socio-economic controls, that estimate rises to about 4.6 percentage points.</p>
<p>However, none of the marginal effects appear statistically significant in the model with no controls (all the CIs include 0). In the model with controls, the marginal effect for 18-24 year olds remains statistically significant, while the confidence interval on the marginal effect for 25-34 now includes 0 (i.e.&nbsp;is no longer statistically significant, or maybe is only <em>marginally significant</em>). Further, the specific point estimates differ in our replication from the results reported in the <a href="https://www.journals.uchicago.edu/doi/suppl/10.1086/714776">appendix of Grumbach and Hill</a></p>
<p>So what’s going on?</p>
<p><strong>Differences in recoding</strong> If you dive into the replication code for the paper, you’ll note that their are some differences in how we recoded variables. In particular, our <code>age_group</code> variable classifies people in the 18-24 cohort, if their reported age is 18 to 24 when they took the survey. In the original paper, 18-24 year olds are coded with the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cps$age_group[cps$age&lt;=24] &lt;- "18-24"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So young folks below the age of 18 are included in this measure, which wouldn’t alter the estimates if they didn’t report voting, but it turns out that 7,991 folks in the CPS reported voting even though their recorded age is under 18.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cps<span class="sc">$</span>dv_voted, cps<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">18</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
      FALSE    TRUE
  0  876904    7991
  1 1103606       0</code></pre>
</div>
</div>
<p>These respondents are included in G&amp;H’s analysis, but excluded from ours.</p>
<p>There are also some differences in the way we recoded covariates, like <code>income</code> and <code>education</code> that might also contribute to some of the differences we see in the model with controls.</p>
<p><strong>Differences in standard errors</strong> The second main difference between the paper and our replication, is how we calculate the standard error for the marginal effect of Same Day Registration for a given age group.</p>
<p>In G&amp;H, based on the 100 or so lines of code from line 662 it looks like they’re constructing confidence intervals around the estimates of the marginal effects, using the SEs for the interaction terms. But as discussed above, the correct standard errors need to be calculated from the variances and covariances of both the coefficients on <code>sdr</code> and <code>sdr</code>’s interaction with a specific <code>age_group</code> indicator. Doing so generally gives us wider confidence intervals, which likely explains the difference in the model with controls for 25-34 year-olds.</p>
<p><strong>What does it all mean?</strong></p>
<p>I guess I would say something like the following: Errors in code happen which is why it is doing empirical research in a reproducible way – sharing your data and code – is so vital.</p>
<p>In the present case, the errors seem to me to be <em>relatively minor</em> (some quibbles about how variables were recoded, a different approach to calculating standard errors) – such that the core finding, SDR has a bigger impact on young folks than old folks– remains relatively unchanged. Of course, we’ve only replicated two of 9 models in figure 3, but I suspect we’d find similar results. Further, Figure 3, is only one piece of evidence in their larger argument.</p>
<p>So even though we’ve uncovered some irregularities in how data were coded and standard errors calculated, I would caution against jumping to the conclusion that we’ve disproved or invalidated the paper. We haven’t.</p>
<p>But hopefully we’ve gotten a sense of how important it is to work in a clear manner. To check and double check our results. To know our data (e.g.&nbsp;do folks who legally can’t vote, report voting in the data?) To make sure our code is clean, easy to follow, and does what we think it does.</p>
<p>Finally, I hope that in looking at the data by state and year and age group, we’ve gained a better sense of what <strong>fixed effects regression</strong> is trying to accomplish. Broadly, we’re taking into account variation across states and time periods, and then seeing if the thing we’re interested – Same Day Registration – still explains variation voting. These models are motivated by the same logic of the difference-in-differences designs we talked about in class. The interpretation of these regressions becomes <a href="https://www.sciencedirect.com/science/article/pii/S0304407621001445">more complicated</a> (and their similarity to the the canonical DiD more tenuous), when “treatment” is implemented at different time periods, as well as when states can go from being not treated, to treated, back to not-treated, like Ohio, not to mention the fact that these models also introduce interactions between SDR and age groups to test for heterogeneous effects.</p>
</section>
</section>
<section id="take-the-class-survey" class="level1 unnumbered">
<h1 class="unnumbered">Take the Class Survey</h1>
<p>Please take a few moments to complete the <a href="https://brown.co1.qualtrics.com/jfe/form/SV_9AoYCyElyryi1pk" target="_blank">class survey</a> for this week.){target=“_blank”} for this week.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>But note the bump in turnout in NC appears pretty similar across age groups<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This is not a robust function, but one designed to work specifically for these data and models<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>