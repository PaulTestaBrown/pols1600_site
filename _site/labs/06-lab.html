<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.545">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Your Group Members Names Here">
<meta name="dcterms.date" content="2024-01-24">

<title>POLS 1600 - Lab 06 - Examining Alternative Explanations for Red Covid</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.31/datatables.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">POLS 1600</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../class/index.html"> 
<span class="menu-text">Class</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignments.qmd"> 
<span class="menu-text">Assignments</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#goals" id="toc-goals" class="nav-link" data-scroll-target="#goals">Goals</a></li>
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow">Workflow</a></li>
  <li><a href="#please-knit-this-.rmd-file" id="toc-please-knit-this-.rmd-file" class="nav-link" data-scroll-target="#please-knit-this-.rmd-file">Please knit this .Rmd file</a></li>
  <li><a href="#get-setup-to-work" id="toc-get-setup-to-work" class="nav-link" data-scroll-target="#get-setup-to-work"><span class="header-section-number">1</span> Get setup to work</a>
  <ul class="collapse">
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages"><span class="header-section-number">1.1</span> Load Packages</a></li>
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data"><span class="header-section-number">1.2</span> Load the data</a></li>
  <li><a href="#describe-the-data" id="toc-describe-the-data" class="nav-link" data-scroll-target="#describe-the-data"><span class="header-section-number">1.3</span> Describe the data</a></li>
  </ul></li>
  <li><a href="#estimate-and-interpet-the-baseline-red-covid-model" id="toc-estimate-and-interpet-the-baseline-red-covid-model" class="nav-link" data-scroll-target="#estimate-and-interpet-the-baseline-red-covid-model"><span class="header-section-number">2</span> Estimate and interpet the baseline Red Covid model</a>
  <ul class="collapse">
  <li><a href="#fit-the-model" id="toc-fit-the-model" class="nav-link" data-scroll-target="#fit-the-model"><span class="header-section-number">2.1</span> Fit the model</a></li>
  <li><a href="#summarize-the-results" id="toc-summarize-the-results" class="nav-link" data-scroll-target="#summarize-the-results"><span class="header-section-number">2.2</span> Summarize the results</a></li>
  <li><a href="#display-the-model-as-a-regression-table" id="toc-display-the-model-as-a-regression-table" class="nav-link" data-scroll-target="#display-the-model-as-a-regression-table"><span class="header-section-number">2.3</span> Display the model as a regression table</a></li>
  <li><a href="#visualize-the-model" id="toc-visualize-the-model" class="nav-link" data-scroll-target="#visualize-the-model"><span class="header-section-number">2.4</span> Visualize the model</a></li>
  <li><a href="#interpret-the-results" id="toc-interpret-the-results" class="nav-link" data-scroll-target="#interpret-the-results"><span class="header-section-number">2.5</span> Interpret the results</a></li>
  </ul></li>
  <li><a href="#estimate-a-model-controlling-for-age" id="toc-estimate-a-model-controlling-for-age" class="nav-link" data-scroll-target="#estimate-a-model-controlling-for-age"><span class="header-section-number">3</span> Estimate a model controlling for age</a>
  <ul class="collapse">
  <li><a href="#fit-the-model-1" id="toc-fit-the-model-1" class="nav-link" data-scroll-target="#fit-the-model-1"><span class="header-section-number">3.1</span> Fit the model</a></li>
  <li><a href="#summarize-the-model" id="toc-summarize-the-model" class="nav-link" data-scroll-target="#summarize-the-model"><span class="header-section-number">3.2</span> Summarize the model</a></li>
  <li><a href="#display-the-model-as-a-regression-table-1" id="toc-display-the-model-as-a-regression-table-1" class="nav-link" data-scroll-target="#display-the-model-as-a-regression-table-1"><span class="header-section-number">3.3</span> Display the model as a regression table</a></li>
  <li><a href="#interpret-the-results-1" id="toc-interpret-the-results-1" class="nav-link" data-scroll-target="#interpret-the-results-1"><span class="header-section-number">3.4</span> Interpret the results</a></li>
  </ul></li>
  <li><a href="#estimate-a-model-controlling-for-age-and-income" id="toc-estimate-a-model-controlling-for-age-and-income" class="nav-link" data-scroll-target="#estimate-a-model-controlling-for-age-and-income"><span class="header-section-number">4</span> Estimate a model controlling for age and income</a>
  <ul class="collapse">
  <li><a href="#fit-the-model-2" id="toc-fit-the-model-2" class="nav-link" data-scroll-target="#fit-the-model-2"><span class="header-section-number">4.1</span> Fit the Model</a></li>
  <li><a href="#summarize-the-model-1" id="toc-summarize-the-model-1" class="nav-link" data-scroll-target="#summarize-the-model-1"><span class="header-section-number">4.2</span> Summarize the model</a></li>
  <li><a href="#display-the-models-in-a-regression-table" id="toc-display-the-models-in-a-regression-table" class="nav-link" data-scroll-target="#display-the-models-in-a-regression-table"><span class="header-section-number">4.3</span> Display the models in a regression table</a></li>
  <li><a href="#interpret-the-skeptics-claims" id="toc-interpret-the-skeptics-claims" class="nav-link" data-scroll-target="#interpret-the-skeptics-claims"><span class="header-section-number">4.4</span> Interpret the skeptic’s claims</a></li>
  </ul></li>
  <li><a href="#estimate-a-model-controlling-for-age-income-and-percent-vaccinated" id="toc-estimate-a-model-controlling-for-age-income-and-percent-vaccinated" class="nav-link" data-scroll-target="#estimate-a-model-controlling-for-age-income-and-percent-vaccinated"><span class="header-section-number">5</span> Estimate a model controlling for age, income, and percent vaccinated</a>
  <ul class="collapse">
  <li><a href="#fit-the-model-3" id="toc-fit-the-model-3" class="nav-link" data-scroll-target="#fit-the-model-3"><span class="header-section-number">5.1</span> Fit the model</a></li>
  <li><a href="#summarize-the-results-1" id="toc-summarize-the-results-1" class="nav-link" data-scroll-target="#summarize-the-results-1"><span class="header-section-number">5.2</span> Summarize the results</a></li>
  <li><a href="#display-the-models-in-a-regression-table-1" id="toc-display-the-models-in-a-regression-table-1" class="nav-link" data-scroll-target="#display-the-models-in-a-regression-table-1"><span class="header-section-number">5.3</span> Display the models in a regression table</a></li>
  <li><a href="#interpet-the-results" id="toc-interpet-the-results" class="nav-link" data-scroll-target="#interpet-the-results"><span class="header-section-number">5.4</span> Interpet the results</a></li>
  </ul></li>
  <li><a href="#model-percent-vaccinated-in-a-state-controlling-for-age-income-and-republican-vote-share" id="toc-model-percent-vaccinated-in-a-state-controlling-for-age-income-and-republican-vote-share" class="nav-link" data-scroll-target="#model-percent-vaccinated-in-a-state-controlling-for-age-income-and-republican-vote-share"><span class="header-section-number">6</span> Model percent vaccinated in a state controlling for age, income, and republican vote share</a>
  <ul class="collapse">
  <li><a href="#fit-the-model-4" id="toc-fit-the-model-4" class="nav-link" data-scroll-target="#fit-the-model-4"><span class="header-section-number">6.1</span> Fit the model</a></li>
  <li><a href="#summarize-the-results-2" id="toc-summarize-the-results-2" class="nav-link" data-scroll-target="#summarize-the-results-2"><span class="header-section-number">6.2</span> Summarize the results</a></li>
  <li><a href="#display-the-results-in-a-regression-table" id="toc-display-the-results-in-a-regression-table" class="nav-link" data-scroll-target="#display-the-results-in-a-regression-table"><span class="header-section-number">6.3</span> Display the results in a regression table</a></li>
  <li><a href="#interpret-the-results-2" id="toc-interpret-the-results-2" class="nav-link" data-scroll-target="#interpret-the-results-2"><span class="header-section-number">6.4</span> Interpret the results</a></li>
  </ul></li>
  <li><a href="#take-the-class-survey" id="toc-take-the-class-survey" class="nav-link" data-scroll-target="#take-the-class-survey">Take the Class Survey</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 06 - Examining Alternative Explanations for Red Covid</h1>
<p class="subtitle lead">How to have an argument with regression</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Your Group Members Names Here </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 24, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<section id="overview" class="level1 unnumbered">
<h1 class="unnumbered">Overview</h1>
<p>Today we will explore the critiques and alternative explanations for the phenomena of “Red Covid” discussed by the <em>NYT</em>’s David Leonhardt in articles last fall <a href="https://www.nytimes.com/2021/09/27/briefing/covid-red-states-vaccinations.html">here</a> and more recently <a href="https://www.nytimes.com/2021/09/27/briefing/covid-red-states-vaccinations.html">here</a>.</p>
<p>Recall the core thesis of Red Covid is something like the following:</p>
<blockquote class="blockquote">
<p>Since Covid-19 vaccines became widely available to the general public in the spring of 2021, Republicans have been less likely to get the vaccine. Lower rates of vaccination among Republicans have in turn led to higher rates of death from Covid-19 in Red States compared to Blue States.</p>
</blockquote>
<p>A skeptic of this claim might argue that relationship between electoral and epidemelogical outcomes is <em>spurious</em>, saying somthing like:</p>
<blockquote class="blockquote">
<p>There are lots of ways that Red States differ from Blue States — demographics, economics, geography, culture, and so on – and it is these differences that explain the phenomena of Red Covid. If we were to control for these <em>omitted variables</em> the relationship between a state’s partisan leanings and Covid-19 would go away.</p>
</blockquote>
<p>In this lab, we will see how we can explore these claims using <strong>multiple regression</strong> to <strong>control</strong> for competing explanations.</p>
<p>To accomplish this we will:</p>
<ol type="1">
<li>Get set up to work (10 minutes)</li>
</ol>
<p>Then we will estimate and interpret a series of regression models:</p>
<ol start="2" type="1">
<li><p>A baseline Red Covid model using simple bivariate regression using the <code>Republican vote share</code> of states to predict the 14-day average of per capita <code>Covid-19 deaths</code> on September 23, 2021 (10 Minutes)</p></li>
<li><p>A multiple regression model controlling for <code>Republican vote share</code> the <code>median age</code> (15 minutes)</p></li>
<li><p>A model controlling for <code>Republican vote share</code>, the <code>median age</code> <strong>and</strong> <code>median income</code> (15 minutes)</p></li>
<li><p>A model controlling for <code>Republican vote share</code>, the <code>median age</code> <code>median income</code> <strong>and</strong> <code>vaccination rates</code> (15 minutes)</p></li>
<li><p>A model using <code>Republican vote share</code>, the <code>median age</code> <code>median income</code> to predict <code>vaccination rates</code> (15 minutes)</p></li>
</ol>
<p>Finally, we’ll take the weekly survey which will serve as a mid semester check in.</p>
<p>One of these 6 tasks (excluding the weekly survey) will be randomly selected as the graded question for the lab.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3092022</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>graded_question <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Question"</span>,graded_question,<span class="st">"is the graded question for this week"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Question 6 is the graded question for this week"</code></pre>
</div>
</div>
<p>You will work in your assigned groups. Only one member of each group needs to submit the html file of lab.</p>
<p>This lab <strong>must</strong> contain the names of the group members in attendance.</p>
<p>If you are attending remotely, you will submit your labs individually.</p>
<p>Here are your assigned groups for the semester.</p>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ce9f310930966a2c97d4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ce9f310930966a2c97d4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],["Anna Lister","Kate Kuli","Andreas Young","Claudia Spelman",""],["Elizabeth Steeves","Fabian Lopez","Lorenzo Mahoney","Ariana Palomo",""],["Will Lake","Taha Siddiqui","Amanda Page","Noah Soutier",""],["Georgia Kennedy-Bailey","Samuel Levine","Elie Lubin","Bianca Rosen",""],["Theo Simmons","Fengyu Seah","Hunter Keneley","Schuyler Dubitsky",""],["Logan Torres","Jonathan Zhang","Osiris Russell-Delano","Aicha Sama",""],["Natalia Ibarra","Khaled Abdo","Starrchild Jackson","Selene Luna","Yoo Min Lee"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Group 1<\/th>\n      <th>Group 2<\/th>\n      <th>Group 3<\/th>\n      <th>Group 4<\/th>\n      <th>Group 5<\/th>\n      <th>Group 6<\/th>\n      <th>Group 7<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Group 1","targets":1},{"name":"Group 2","targets":2},{"name":"Group 3","targets":3},{"name":"Group 4","targets":4},{"name":"Group 5","targets":5},{"name":"Group 6","targets":6},{"name":"Group 7","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="goals" class="level1 unnumbered">
<h1 class="unnumbered">Goals</h1>
<p>The primary goal of this lab is to give you lots of practice estimating and interpreting multiple regression models.</p>
<p>Questions 2-6 will all ask you to do some combination of the following:</p>
<ol type="1">
<li><strong>Fit</strong> a linear model or models using <code>lm()</code></li>
<li><strong>Summarize</strong> the results of this model using <code>summary()</code></li>
<li><strong>Present</strong> the results of this model or models in a regression table</li>
<li><strong>Interpret</strong> your models substantively for other human beings</li>
</ol>
<p>Question 2 will also give you practice visualizing bivariate relationships</p>
<p>In general, when we interpret the regression coefficients from a linear model we want to know their:</p>
<ul>
<li><strong>Sign</strong> is the coefficient positive or negative? As the predictor increases does the outcome tend to increase (positive) or decrease (negative)</li>
<li><strong>Size</strong> is the change in the predicted value of the outcome <strong>substantively</strong> meaningful?
<ul>
<li>To facilitate comparisons between predictors, we will use <a href="https://pols1600.paultesta.org/slides/06-slides.html#29" target="_blank">standardized measures</a> of Republican Vote Share, Median Age, and Median Income, and Percent Vaccinated</li>
</ul></li>
<li><strong>Significance</strong> today we’ll put the cart before the horse, and say, coefficient that has one or more asterisks <code>*</code> next to it is <em>statistically significant</em>
<ul>
<li>Over the next several weeks, we’ll talk in great detail the logic and theory behind statistical inference</li>
<li>For today, we’ll do a bit of “star-gazing” using these asterisks<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> as heuristics to help us evaluate the claims of Leonhardt and his skeptics.</li>
</ul></li>
</ul>
</section>
<section id="workflow" class="level1 unnumbered">
<h1 class="unnumbered">Workflow</h1>
</section>
<section id="please-knit-this-.rmd-file" class="level1 unnumbered">
<h1 class="unnumbered">Please knit this .Rmd file</h1>
<p>As with every lab, you should:</p>
<ul>
<li>Download the file</li>
<li>Save it in your course folder</li>
<li><strong>Update the <code>author:</code> section of the YAML header to include the names of your group members in attendance.</strong></li>
<li>Knit the document</li>
<li>Open the html file in your browser (Easier to read)</li>
<li>Write yourcode in the chunks provided</li>
<li>Comment out or delete any test code you do not need</li>
<li><strong>Knit the document again after completing a section or chunk</strong> (Error checking)</li>
<li>Upload the final lab to <a href="https://canvas.brown.edu/courses/1091286/modules/items/10882045" target="_blank">Canvas</a>.</li>
</ul>
</section>
<section id="get-setup-to-work" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Get setup to work</h1>
<section id="load-packages" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="load-packages"><span class="header-section-number">1.1</span> Load Packages</h2>
<p>First lets load the libraries we’ll need for today.</p>
<p>There’s one new package, <code>htmltools</code> which we’ll use to display regression tables while we work.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>the_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## R Markdown</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kableExtra"</span>,<span class="st">"DT"</span>,<span class="st">"texreg"</span>,<span class="st">"htmltools"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Tidyverse</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyverse"</span>, <span class="st">"lubridate"</span>, <span class="st">"forcats"</span>, <span class="st">"haven"</span>, <span class="st">"labelled"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Extensions for ggplot</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ggmap"</span>,<span class="st">"ggrepel"</span>, <span class="st">"ggridges"</span>, <span class="st">"ggthemes"</span>, <span class="st">"ggpubr"</span>, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GGally"</span>, <span class="st">"scales"</span>, <span class="st">"dagitty"</span>, <span class="st">"ggdag"</span>, <span class="st">"ggforce"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"COVID19"</span>,<span class="st">"maps"</span>,<span class="st">"mapdata"</span>,<span class="st">"qss"</span>,<span class="st">"tidycensus"</span>, <span class="st">"dataverse"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Analysis</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DeclareDesign"</span>, <span class="st">"easystats"</span>, <span class="st">"zoo"</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to load packages</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>ipak <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">"Package"</span>])]</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(new.pkg)) </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ipak</span>(the_packages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   kableExtra            DT        texreg     htmltools     tidyverse 
         TRUE          TRUE          TRUE          TRUE          TRUE 
    lubridate       forcats         haven      labelled         ggmap 
         TRUE          TRUE          TRUE          TRUE          TRUE 
      ggrepel      ggridges      ggthemes        ggpubr        GGally 
         TRUE          TRUE          TRUE          TRUE          TRUE 
       scales       dagitty         ggdag       ggforce       COVID19 
         TRUE          TRUE          TRUE          TRUE          TRUE 
         maps       mapdata           qss    tidycensus     dataverse 
         TRUE          TRUE          TRUE          TRUE          TRUE 
DeclareDesign     easystats           zoo 
         TRUE          TRUE          TRUE </code></pre>
</div>
</div>
</section>
<section id="load-the-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="load-the-data"><span class="header-section-number">1.2</span> Load the data</h2>
<p>Next we’ll load the data that we created in class on Tuesday which provides a snapshot of the state of Covid-19 on September 23, 2021 in the U.S.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://pols1600.paultesta.org/files/data/06_lab.rda"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After running this code, the data frame <code>covid_lab</code> should appear in your environment pane in R Studio</p>
</section>
<section id="describe-the-data" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="describe-the-data"><span class="header-section-number">1.3</span> Describe the data</h2>
<p>In the code chunk below, please write some code get an high level overview of the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># High level overview</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of observations and variables</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Names of variables</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse of data</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of data</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standard deviations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Please use this HLO to answer the following questions:</p>
<ul>
<li><p><strong>How many observations are there:</strong></p></li>
<li><p><strong>What is an observation (i.e.&nbsp;what is the unit of analysis):</strong></p></li>
<li><p><strong>What is the primary outcome variable for today:</strong></p></li>
<li><p><strong>What are the four main predictors we’ll be using:</strong></p></li>
<li><p><strong>Will we be using the the raw values of these predictors or their standardized values?</strong></p></li>
<li><p><strong>What is the standard deviation of our outcome and predictor variables:</strong></p>
<ul>
<li>Covid-19 deaths:</li>
<li>Republican vote share:</li>
<li>Median age:</li>
<li>Median income:</li>
<li>Vaccination Rate:</li>
</ul></li>
</ul>
</section>
</section>
<section id="estimate-and-interpet-the-baseline-red-covid-model" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Estimate and interpet the baseline Red Covid model</h1>
<p>First let’s estimate and interpret the following model:</p>
<p><span class="math display">\[\text{New Covid Deaths} = \beta_0 + \beta_1 \text{Republican Vote Share}_{std} + \epsilon\]</span></p>
<p><strong>All you have to do is run the code chunks below and then interpret the results</strong></p>
<p>When you visualize this model, you will have to <strong>write comments in the code</strong></p>
<p>Then, you’ll use this code as guide for subsequent sections.</p>
<section id="fit-the-model" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="fit-the-model"><span class="header-section-number">2.1</span> Fit the model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(new_deaths_pc_14da <span class="sc">~</span> rep_voteshare_std, covid_lab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarize-the-results" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="summarize-the-results"><span class="header-section-number">2.2</span> Summarize the results</h2>
<p>Now we apply the <code>summary()</code> function to our model <code>m1</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = new_deaths_pc_14da ~ rep_voteshare_std, data = covid_lab)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.66967 -0.21572 -0.03715  0.11169  1.00580 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        0.57530    0.04846  11.872 6.88e-16 ***
rep_voteshare_std  0.22571    0.04895   4.611 2.99e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3427 on 48 degrees of freedom
Multiple R-squared:  0.307, Adjusted R-squared:  0.2925 
F-statistic: 21.26 on 1 and 48 DF,  p-value: 2.99e-05</code></pre>
</div>
</div>
<p>We see that m1 returns two coefficients, which define a line of best fit predicting Covid-19 deaths with the Republican vote share of the 2020 Presidential election:</p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> corresponds to the intercept. This is model’s prediction for a state where Trump got 0 percent of the vote. This is typically not something we care about.</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> corresponds to the slope. Because we used a standardized measure of vote share, we would say that a 1-standard deviation (about 10 percentage points) increase in Republican vote share is associated with a 0.23 increase the average number of new Covid-19 deaths. Given that this per-capita measure has a standard deviation of 0.4, this is a fairly sizable association.</p></li>
<li><p>Finally, note that last column of <code>summary(m1)</code> <code>Pr(&gt;|t|)</code> both the coefficients for the intercept <span class="math inline">\((\beta_0)\)</span> and <code>rep_voteshare_std</code> (<span class="math inline">\((\beta_1)\)</span>) are <strong>statistically significant</strong> (ie have an <code>*</code> next to them).</p></li>
</ul>
</section>
<section id="display-the-model-as-a-regression-table" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="display-the-model-as-a-regression-table"><span class="header-section-number">2.3</span> Display the model as a regression table</h2>
<p>Next we’ll format the results of <code>summary(m1)</code> into a <strong>regression table</strong> using the <code>htmlreg()</code> function.</p>
<p>Regression tables are a the standard way of concisely presenting the results of regression models.</p>
<ul>
<li><p>Each named row corresponds to the coefficients form the model</p></li>
<li><p>If there is an asterisks next to a coefficient, that coefficient is <strong>statistically significant</strong> with a p value below a certain threshold.</p></li>
<li><p>The numbers in parentheses below each coefficient correspond to the <strong>standard error</strong> of the coefficient (more on that later)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p></li>
<li><p>The bottom of the table contains summary statistics of of our model, which we’ll ignore for today.</p></li>
</ul>
<p>The code after <code>htmlreg(m1)</code> allows you to see what output of the table will look like in the html document while you’re working in the Rmd file.</p>
<div class="cell">
<div class="cell-output-display">
<table class="texreg table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Statistical models</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">&nbsp;</th>
<th data-quarto-table-cell-role="th" style="padding-left: 5px; padding-right: 5px">Model 1</th>
</tr>
</thead>
<tbody>
<tr class="odd" style="border-top: 1px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">(Intercept)</td>
<td style="padding-left: 5px; padding-right: 5px">0.58<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.05)</td>
</tr>
<tr class="odd">
<td style="padding-left: 5px; padding-right: 5px">rep_voteshare_std</td>
<td style="padding-left: 5px; padding-right: 5px">0.23<sup>***</sup></td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">&nbsp;</td>
<td style="padding-left: 5px; padding-right: 5px">(0.05)</td>
</tr>
<tr class="odd" style="border-top: 1px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">R<sup>2</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.31</td>
</tr>
<tr class="even">
<td style="padding-left: 5px; padding-right: 5px">Adj. R<sup>2</sup></td>
<td style="padding-left: 5px; padding-right: 5px">0.29</td>
</tr>
<tr class="odd" style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px; padding-right: 5px">Num. obs.</td>
<td style="padding-left: 5px; padding-right: 5px">50</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td colspan="2" style="font-size: 0.8em"><sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05</td>
</tr>
</tfoot>

</table>


</div>
</div>
</section>
<section id="visualize-the-model" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="visualize-the-model"><span class="header-section-number">2.4</span> Visualize the model</h2>
<p>Now let’s visualize the results of our <code>m1</code> with a scatter plot.</p>
<p>In the code below, <strong>please write a comment explaining what each section of code is doing</strong></p>
<ul>
<li>Replace the <code>#1. Comment for.</code> with a brief comment explaining what the code below the comment does.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Comment for the line of code below</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>covid_lab <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Comment for ggplot()</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rep_voteshare_std,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> new_deaths_pc_14da,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> state_po))<span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Comment for geom_point() </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Comment for size =</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> .<span class="dv">5</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Comment for geom_text_repel()</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Comment for size =   </span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Comment for geom_smooth</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)<span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Comment for labs</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Republican Vote Share (std)"</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"New Covid-19 Deaths</span><span class="sc">\n</span><span class="st">(14-day ave)"</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: label
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-lab_files/figure-html/m1fig-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpret-the-results" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="interpret-the-results"><span class="header-section-number">2.5</span> Interpret the results</h2>
<p><strong>In a sentence our two, summarize the results of your analysis in this section</strong></p>
<p>You words here!</p>
</section>
</section>
<section id="estimate-a-model-controlling-for-age" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Estimate a model controlling for age</h1>
<p>Suppose a skeptic reading the <em>New York Times</em> took issue with Leonhardt’s claims, and said what’s really behind the claim of Red Covid is that Republican states tend to be older and older people are more at Risk of Dying from Covid-19.</p>
<p>One way we could address this critique is by estimating a multiple regression model that <strong>controlled</strong> for age.</p>
<p><span class="math display">\[\text{New Covid Deaths} = \beta_0 + \beta_1 \text{Repbulican Vote Share}_{std} + \beta_2 \text{Median Age}_{std} + \epsilon\]</span></p>
<p>If our skeptic is right, what should happen to coefficients:</p>
<ul>
<li><strong>Republican Vote Share:</strong>
<ul>
<li><strong>Sign:</strong> (Negative / Positive / Unclear)</li>
<li><strong>Size:</strong> (Increase compared <code>m1</code>/ Decrease compared <code>m1</code> / Unclear)</li>
<li><strong>Significance:</strong> (Significant / Non-Signficant)</li>
</ul></li>
<li><strong>Median Age:</strong>
<ul>
<li><strong>Sign:</strong> (Negative/Positive/Unclear)</li>
<li><strong>Size:</strong> (Large/Small/Unclear)</li>
<li><strong>Significance:</strong> (Significant / Non-Significant)</li>
</ul></li>
</ul>
<p>If our critique is right, and the relationship between Partisanship and Covid is confounded by the fact that Red States tend to be older and older people are more likely to die from Covid, then controlling for Age, the coefficient on Republican Vote share should decrease in size (get closer to 0) and lose significance, while the coefficient on Age should be positive (older states have more Covid-19 deaths) and statistically signficant. I’m not sure I have a good sense about the size or magnitude of this effect.</p>
<section id="fit-the-model-1" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="fit-the-model-1"><span class="header-section-number">3.1</span> Fit the model</h2>
<p>Now let’s test our skeptics’ claims by fitting a model <code>m2</code> that controls for Age (<code>med_age_std</code>).</p>
<ul>
<li>Remember the first argument in <code>lm()</code> is formula of the form <code>outcome variable ~ predictor1 + predictor2 + ...</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarize-the-model" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="summarize-the-model"><span class="header-section-number">3.2</span> Summarize the model</h2>
<p>Now let’s print out a statistical summary of <code>m2</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of m2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="display-the-model-as-a-regression-table-1" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="display-the-model-as-a-regression-table-1"><span class="header-section-number">3.3</span> Display the model as a regression table</h2>
<p>Next, let’s create a regression table that displays <code>m1</code> in the first column and <code>m2</code> in the second column.</p>
<ul>
<li>To do this, change <code>list(m1)</code> from the code above to <code>list(m1, m2)</code></li>
</ul>
</section>
<section id="interpret-the-results-1" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="interpret-the-results-1"><span class="header-section-number">3.4</span> Interpret the results</h2>
<p><strong>In a few sentences, explain whether the results from <code>m2</code> support the skeptics criticisms or not?</strong></p>
</section>
</section>
<section id="estimate-a-model-controlling-for-age-and-income" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Estimate a model controlling for age and income</h1>
<p>Undeterred, our skeptic now argues that it’s not just age that matters but also socioeconomic factors like wealth.</p>
<p>Let’s test this claim using the following model:</p>
<p><span class="math display">\[\text{New Covid Deaths} = \beta_0 + \beta_1 \text{Repbulican Vote Share}_{std} + \beta_2 \text{Median Age}_{std} + \beta_3\text{Median Income}_{std}\epsilon\]</span> If the skeptic is right, then controlling for age and income, the coefficient on Republican vote share should <strong>FILL IN WHAT SHOULD HAPPEN TO THIS COEFFICIENT</strong></p>
<section id="fit-the-model-2" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="fit-the-model-2"><span class="header-section-number">4.1</span> Fit the Model</h2>
<p>Please fit a model called <code>m3</code> implied by the skeptic’s revised claims</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarize-the-model-1" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="summarize-the-model-1"><span class="header-section-number">4.2</span> Summarize the model</h2>
<p>Summarize the model <code>m3</code> using <code>summary()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary m3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="display-the-models-in-a-regression-table" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="display-the-models-in-a-regression-table"><span class="header-section-number">4.3</span> Display the models in a regression table</h2>
<p>And then display the results of models <code>m1</code>, <code>m2</code>, and <code>m3</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regression table of m1, m2, m3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpret-the-skeptics-claims" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="interpret-the-skeptics-claims"><span class="header-section-number">4.4</span> Interpret the skeptic’s claims</h2>
<p><strong>In a few sentences, explain whether the results from <code>m3</code> support the skeptics criticisms or not?</strong></p>
<p>Controlling for median age and income, the coefficient on Republican sote share decreases in size by more than half and is no longer statistically significant. The coefficient on median income is statistically significant and substantively suggests that states with higher median incomes tended to have fewer Covid-19 deaths on September 23, 2021.</p>
</section>
</section>
<section id="estimate-a-model-controlling-for-age-income-and-percent-vaccinated" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Estimate a model controlling for age, income, and percent vaccinated</h1>
<p>Hmm, maybe our skeptic has a point. Let’s estimate a model that controls for everything from <code>m3</code> as well as the vaccination rate in each state.</p>
<p><span class="math display">\[\text{New Covid Deaths} = \beta_0 + \beta_1 \text{Rep Vote Share}_{std} + \beta_2 \text{Median Age}_{std} + \beta_3\text{Median Income}_{std}+\beta_4\text{Percent Vaxxed}_{std}\epsilon\]</span></p>
<section id="fit-the-model-3" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="fit-the-model-3"><span class="header-section-number">5.1</span> Fit the model</h2>
<p>You know the drill.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarize-the-results-1" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="summarize-the-results-1"><span class="header-section-number">5.2</span> Summarize the results</h2>
<p>Again, let’s get a quick summary of our results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of m4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="display-the-models-in-a-regression-table-1" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="display-the-models-in-a-regression-table-1"><span class="header-section-number">5.3</span> Display the models in a regression table</h2>
<p>And add <code>m4</code> to list of models in our regression table</p>
</section>
<section id="interpet-the-results" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="interpet-the-results"><span class="header-section-number">5.4</span> Interpet the results</h2>
<p><strong>Briefly interpret the results of <code>m4</code></strong></p>
</section>
</section>
<section id="model-percent-vaccinated-in-a-state-controlling-for-age-income-and-republican-vote-share" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Model percent vaccinated in a state controlling for age, income, and republican vote share</h1>
<p>Hmm, how should we make sense of <code>m4</code>. Let’s fit one last model, that predicts vaccination rates as a function of Republican vote share, median age, and median income in a state.</p>
<p><span class="math display">\[\text{Percent Vaxxed} = \beta_0 + \beta_1 \text{Repbulican Vote Share}_{std} + \beta_2 \text{Median Age}_{std} + \beta_3\text{Median Income}_{std}\epsilon\]</span> Briefly, please describe whether we should expect a statistically significant positive or negative relationship with vaccination rates or whether we should expect no statistically significant relationship.</p>
<ul>
<li><p><span class="math inline">\(\beta_1\)</span> Republican Vote Share: (Negative / Positive / No Relationship)</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> Median Age: (Negative / Positive / No Relationship)</p></li>
<li><p><span class="math inline">\(\beta_3\)</span> Median Income: (Negative / Positive / No Relationship)</p></li>
</ul>
<section id="fit-the-model-4" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="fit-the-model-4"><span class="header-section-number">6.1</span> Fit the model</h2>
<p>Now let’s fit the model. For ease of interpretation, let’s use the unstandardized measure of vaccination rates, <code>percent_vaccinated</code> as our outcome variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarize-the-results-2" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="summarize-the-results-2"><span class="header-section-number">6.2</span> Summarize the results</h2>
<p>And summarize the results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of m5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="display-the-results-in-a-regression-table" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="display-the-results-in-a-regression-table"><span class="header-section-number">6.3</span> Display the results in a regression table</h2>
<p>Display them in a regression table</p>
</section>
<section id="interpret-the-results-2" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="interpret-the-results-2"><span class="header-section-number">6.4</span> Interpret the results</h2>
<p><strong>Summarize the results of <code>m5</code> and offer some broader discussion of what we’ve learned today</strong></p>
</section>
</section>
<section id="take-the-class-survey" class="level1 unnumbered">
<h1 class="unnumbered">Take the Class Survey</h1>
<p>Please take a few moments to complete the <a href="https://brown.co1.qualtrics.com/jfe/form/SV_6mUeyI7tqVURHQW" target="_blank">class survey</a> for this week.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>In short, these <code>*</code> correspond to <span class="math inline">\(p-values\)</span> below different thresholds. One <code>*</code> typically means <span class="math inline">\(p &lt; 0.05\)</span>. A p-value is a conditional probability that arises from a hypothesis test summarizing the likelihood of observing a particular test statistic (here a regression coefficient, or more specifically, a t-statistic which is the regression coefficient divided by its standard error) given a paritcular hypothesis (typically, but not allows a <em>null hypothesis</em> that the true coefficient is 0). In sum, a p-value assess the likelihood of seeing what we did, if in fact, there was no relationship. If that likelihood is small (p&lt;0.05), we reject the claim of no relationship. We remain uncertain about the true value of the coefficient, but we are pretty confident it’s not 0.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>A standard error is another one of those things that in the cart we’re putting before horse today. Briefly, it is an estimate of the standard deviation of the sampling distribution of a coefficient and describes how much our coefficient might vary had we had a different sample…<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>